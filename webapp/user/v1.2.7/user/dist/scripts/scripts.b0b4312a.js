angular.module("app",["ionic","security","resources","destination","tools","tmmui","index","recommend","fresh","order","my","shop","item","login","wallet","payment","mypraise","myorder","payType","myjoinact","calendar","device"]).run(["$ionicPlatform","$rootScope","$state","$log","$ionicPopup","$ionicLoading","device","ENV","Resource",function(a,b,c,d,e,f,g,h,i){if("weixin"===h.device&&g.getLocation(function(){b.$broadcast("refreshLocation")}),"app"===h.device&&h.android)try{var j=window.jsObj.sendLocation(),k=j.split("*"),l={location:{lng:k[1],lat:k[0]}};i.setLoactionGPS(l).then(function(a){},function(a){})}catch(m){}b.$on("$stateChangeError",function(a,b,d,g,h,i){g.name?f.show({template:i.msg,duration:1e3}):e.alert({title:i.msg,cssClass:"tmm-ionic-alert",okText:"确认"}).then(function(){c.go("tab.recommend")})})}]).config(["$httpProvider","$stateProvider","$urlRouterProvider","$sceDelegateProvider","$ionicConfigProvider","$logProvider","ENV",function(a,b,c,d,e,f,g){function h(){var a=navigator.userAgent.toLowerCase();return"micromessenger"==a.match(/MicroMessenger/i)}function i(){var a=".has-header { top: 64px;} .navbar{padding-top: 20px}",b=document.getElementsByTagName("head")[0],c=document.createElement("style");c.setAttribute("type","text/css"),c.appendChild(document.createTextNode(a)),b.appendChild(c)}function j(a){var b=document.createElement("script");b.setAttribute("language","JavaScript"),b.setAttribute("src",a),document.body.appendChild(b)}a.defaults.withCredentials=!0,a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",e.views.transition("ios"),e.tabs.position("bottom"),e.tabs.style("standard"),e.scrolling.jsScrolling(!1),e.navBar.alignTitle("center"),g.isWeixin=h(),g.android=ionic.Platform.isAndroid(),g.iOS=ionic.Platform.isIOS(),g.debug?(g.apiEndpoint="http://test2.365tmm.net",f.debugEnabled(!0)):f.debugEnabled(!1),"app"===g.device&&g.iOS&&i();var k="";k="app"===g.device?"https://s4.cnzz.com/z_stat.php?id=1259610452&web_id=1259610452":"https://s95.cnzz.com/z_stat.php?id=1259610736&web_id=1259610736",j(k),b.state("tab",{"abstract":!0,templateUrl:"app/base/templates/tabs.html",controller:"TabBarCtrl"}),d.resourceUrlWhitelist(["self","**","http://wap.koudaitong.com/**","https://wap.koudaitong.com/**"]),c.otherwise("/index")}]).directive("tabBar",function(){}).controller("TabBarCtrl",["$scope","$state",function(a,b){function c(){a.active=b.current.name}a.$on("$stateChangeSuccess",c),a.active="tab.index"}]).filter("formatDay",function(){return function(a){a=parseInt(a);var b=["第一天","第一天","第二天","第二天","第三天","第三天","第四天","第四天","第五天","第五天","第六天","第六天","第七天","第七天","第八天","第八天","第九天","第九天","第十天","第十天"];return b[a]}}).filter("room",function(){return function(a){a=parseInt(a);var b=["","一","二","三","四","五","六","七","八","九","十"];return b[a]+"人间"}}),angular.module("app").constant("ENV",{debug:!0,device:"weixin",apiEndpoint:"https://m.365tmm.com",freshHomePage:"https://wap.koudaitong.com/v2/showcase/homepage?alias=162cb1d4e"}).constant("MESSAGES",{"order.num":"一个成人最多只能带两个儿童","order.goTime":"请选择出游日期","order.goNum":"请设置出游人数","order.retinue":"请添加主要联系人","order.retinueNum":"请确保主要联系人和随行人员总数与出游人数一致"}).factory("API",["ENV",function(a){var b=a.apiEndpoint;return{journey_index:b+"/index.php?r=api/shops/index&select_dot_thrand=thrand&page=1",journey_popular:b+"/index.php?r=api/shops/index&select_dot_thrand=thrand&page=1&order_brow=order_brow&is_area=is_area",journey_distance:b+"/index.php?r=api/shops/index&select_dot_thrand=thrand&is_area=is_area",create_mainretinue:b+"/index.php?r=api/retinue/create&type=1",create_retinue:b+"/index.php?r=api/retinue/create&type=0"}}]),angular.module("index",[]).config(["$stateProvider",function(a){a.state("tab.index",{url:"/index",templateUrl:"app/index/templates/index.html",controller:"IndexCtrl",resolve:{data:["$ionicViewSwitcher","$ionicHistory","ENV","device",function(a,b,c,d){"app"===c.device&&d.exitSeekFresh();var e=b.currentView();!e||"tab.recommend"!=e.stateName&&"tab.seek"!=e.stateName&&"tab.my"!=e.stateName||a.nextTransition("none")}]}}).state("tab.fresh-subject",{url:"/fresh-subject",templateUrl:"app/index/templates/fresh-subject.html",controller:"FreshSubjectCtrl"}).state("tab.interest-subject",{url:"/interest-subject",templateUrl:"app/index/templates/interest-subject.html",controller:"InterestSubjectCtrl"}).state("tab.fresh-list",{url:"/fresh-list/:link/:name",templateUrl:"app/index/templates/fresh-list.html",controller:"FreshListCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.fresh-list"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.interest-list",{url:"/interest-list/:link/:name",templateUrl:"app/index/templates/interest-list.html",controller:"InterestListCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.interest-list"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.seek-list",{url:"/seek-list/:link/:name",templateUrl:"app/index/templates/seek-list.html",controller:"SeekListCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.seek-list"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}})}]).controller("IndexCtrl",["$scope","$ionicHistory","$state","device","ENV","Resource","indexSubject",function(a,b,c,d,e,f,g){function h(b){function c(){e++,(!b&&4==e||b&&3==e)&&a.$broadcast("scroll.refreshComplete")}var e=0;b=null,b||f.get(j.banner).then(function(b){d.SET("banner",b.list_data),a.model.banner=b.list_data,c()}),f.get(j.hotsell).then(function(b){d.SET("hotsell",b.list_data),g.fresh=b,a.model.hotsell=b.list_data,c()}),f.get(j.hotact).then(function(b){d.SET("hotact",b.list_data),g.interest=b,a.model.hotact=b.list_data,c()}),f.get(j.circumtour).then(function(b){d.SET("circumtour",b.list_data),a.model.circumtour=b.list_data,a.model.nextPage=b.page.next,c()})}var i=e.apiEndpoint,j={banner:i+"/index.php?r=api/ad/list",hotsell:i+"/index.php?r=api/ad/index&type=1",hotact:i+"/index.php?r=api/shops/column",circumtour:i+"/index.php?r=api/shops/column&type=1"};a.$on("$ionicView.enter",function(){b.clearHistory()}),a.freshStyle={height:(window.innerWidth-30)/2*2/3*2+20+"px"},a.seekStyle={height:.66*(window.innerWidth-20)+"px"},a.model={},h(),a.model.banner=d.GET("banner"),a.model.hotsell=d.GET("hotsell"),a.model.hotact=d.GET("hotact"),a.model.circumtour=d.GET("circumtour"),a.doRefresh=function(){h(1)},a.loadMore=function(){a.model.nextPage&&f.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.circumtour=a.model.circumtour.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.goBannerDetail=function(a,b,f,g){var h;a=+a,a>3&&a<7?(h="tab.more-detail"+(a-3),c.go(h,{link:b})):7==a||8==a?"app"===e.device?d.goSeekFreshDetail2(f,f,g,b):window.location.href=b:a<=3&&(h="tab.shop"+a,c.go(h,{link:b,type:a}))}}]).controller("FreshSubjectCtrl",["$scope","$rootScope","indexSubject","Resource","ENV",function(a,b,c,d,e){function f(){d.get(e.apiEndpoint+"/index.php?r=api/ad/index&type=1").then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(){a.$broadcast("scroll.refreshComplete")})}b.hideTabs="tabs-item-hide";a.model={},a.name="精挑细选",a.imgStyle={height:.33*(window.innerWidth-30)+"px"},c.fresh||f(),a.$on("$ionicView.enter",function(){!a.model.list_data&&c.fresh&&(a.model.nextPage=c.fresh.page.next,a.model.list_data=c.fresh.list_data)}),a.doRefresh=function(){f()},a.loadMore=function(){a.model.nextPage&&d.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(){a.$broadcast("scroll.infiniteScrollComplete")})}}]).controller("InterestSubjectCtrl",["$scope","$rootScope","indexSubject","Resource","ENV",function(a,b,c,d,e){function f(){d.get(e.apiEndpoint+"/index.php?r=api/shops/column").then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(){a.$broadcast("scroll.refreshComplete")})}b.hideTabs="tabs-item-hide",a.model={},a.name="拒绝平凡",c.interest||f(),a.$on("$ionicView.enter",function(){!a.model.list_data&&c.interest&&(a.model.nextPage=c.interest.page.next,a.model.list_data=c.interest.list_data)}),a.seekStyle={height:.66*(window.innerWidth-20)+"px"},a.doRefresh=function(){f()},a.loadMore=function(){a.model.nextPage&&d.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(){a.$broadcast("scroll.infiniteScrollComplete")})}}]).controller("FreshListCtrl",["$scope","$rootScope","$state","$stateParams","data","ENV","device","Resource",function(a,b,c,d,e,f,g,h){function i(){h.get(j).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}b.hideTabs="tabs-item-hide",a.name=d.name,a.model={};var j=d.link;a.$on("$ionicView.enter",function(){a.model.list_data||(a.model.list_data=e.list_data,a.model.nextPage=e.page.next)}),a.imgStyle={height:2*(window.innerWidth-20)/3+"px"},a.loadMore=function(){a.model.nextPage&&h.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.doRefresh=function(){i()},a.goFresh=function(a,b,d,e){"app"===f.device?g.goSeekFreshDetail2(a,b,d,e):f.android?window.location.href=e:c.go("tab.fresh-item",{link:e,name:a})}}]).controller("InterestListCtrl",["$scope","$rootScope","$stateParams","data","ENV","Resource",function(a,b,c,d,e,f){function g(){f.get(h).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}b.hideTabs="tabs-item-hide",a.name=c.name,a.model={};var h=c.link;a.imgStyle={height:2*(window.innerWidth-20)/3+"px"},a.$on("$ionicView.enter",function(){a.model.list_data||(a.model.list_data=d.list_data,a.model.nextPage=d.page.next)}),a.loadMore=function(){a.model.nextPage&&f.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.doRefresh=function(){g()}}]).controller("SeekListCtrl",["$scope","$rootScope","$stateParams","data","ENV","Resource",function(a,b,c,d,e,f){function g(){f.get(h).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}b.hideTabs="tabs-item-hide",a.name=c.name,a.model={};var h=c.link;a.$on("$ionicView.enter",function(){a.model.list_data||(a.model.list_data=d.list_data,a.model.nextPage=d.page.next)}),a.imgStyle={height:2*(window.innerWidth-20)/3+"px"},a.loadMore=function(){a.model.nextPage&&f.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.doRefresh=function(){g()}}]).factory("indexSubject",function(){return{}}).directive("drawImg",function(){return{restrict:"E",replace:!0,template:"<canvas></canvas>",link:function(a,b,c){var d=b[0],e=d.getContext("2d"),f=window.innerWidth-20,g=Math.round(.666*f);d.width=2*f,d.height=2*g,d.style.width=f+"px",d.style.height=g+"px";var h=new Image;h.src=c.src,h.onload=function(){e.drawImage(h,0,0,d.width,d.height)}}}}).directive("drawSmallImg",function(){return{restrict:"E",replace:!0,template:"<canvas></canvas>",link:function(a,b,c){var d=b[0],e=Math.round(window.innerWidth-30)/2,f=Math.round(2*e/3),g=c.index,h=10+Math.floor(g/2)*(f+10),i=10+g%2*(e+10);b.css({width:e+"px",height:f+"px",top:h+"px",left:i+"px"}),d.width=2*e,d.height=2*f;var j=d.getContext("2d"),k=new Image;k.src=c.src,k.onload=function(){j.drawImage(k,0,0,d.width,d.height)}}}}),angular.module("recommend",["search"]).config(["$stateProvider",function(a){a.state("tab.seek",{url:"/seek",templateUrl:"app/recommend/templates/seek.html",controller:"SeekCtrl",resolve:{data:["$ionicViewSwitcher","$ionicHistory","ENV","device",function(a,b,c,d){"app"===c.device&&d.exitSeekFresh();var e=b.currentView();!e||"tab.recommend"!=e.stateName&&"tab.seek"!=e.stateName&&"tab.my"!=e.stateName||a.nextTransition("none")}]}})}]).controller("SeekCtrl",["$scope","$http","$ionicHistory","$rootScope","modify","ENV","Resource","autoRefresh",function(a,b,c,d,e,f,g,h){function i(){g.get(j).then(function(b){a.noData=!b.list_data.length,a.model.search=b.search,a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.address=b.orientation.value?b.orientation.value.address_info.name:b.location.value?b.location.value.address_info.name:"选择",a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}var j=f.apiEndpoint+"/index.php?r=api/shops/index&page=1",k="";a.noData=!1,a.selectValue="",a.selectTitle="",a.address="选择",a.model={nextPage:"",list_data:[],search:[],tags:[]},a.$on("$ionicView.loaded",function(){h.start("seek-content")}),a.$on("$ionicView.enter",function(){j=f.apiEndpoint+"/index.php?r=api/shops/index&page=1",a.isShowTag=!1,e.ismodify&&(h.start("seek-content"),e.ismodify=!1),c.clearHistory()}),a.selectTit=function(b,c){return a.selectTitle===c?void(a.isShowTag=!a.isShowTag):(k=c,a.isShowTag=!0,"app"===f.device&&f.iOS&&(a.seekIos=!0),void(a.model.tags=b.son))},a.selectTag=function(b,c){a.selectTitle=k,j=b,a.selectValue=c,a.isShowTag=!1,h.start("seek-content")},a.closeTag=function(b,c){a.isShowTag=!1},a.doRefresh=function(){i()},a.loadMore=function(){a.model.nextPage&&g.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})}}]).directive("recommendItem",function(){return{restrict:"E",replace:!0,templateUrl:"app/recommend/templates/recommend-item.html",link:function(a,b){b.find("img").css({height:2*window.innerWidth/3+"px"})}}}),angular.module("fresh",[]).config(["$stateProvider",function(a){a.state("tab.fresh",{url:"/fresh",templateUrl:"app/fresh/templates/fresh.html",controller:"FreshCtrl",resolve:{data:["ENV","device",function(a,b){"app"===a.device&&b.goFresh()}]}}).state("tab.fresh-item",{url:"/fresh-item/:name/:link",templateUrl:"app/fresh/templates/fresh-item.html",controller:"FreshItemCtrl"})}]).controller("FreshCtrl",["$scope","ENV","device",function(a,b,c){if("weixin"===b.device){if(a.isWeixin=!0,b.android){var d=Date.now(),e=!0,f=c.GET("freshTime");null!==f&&Date.now()-f<864e5&&(e=!1,d=f),c.SET("freshTime",d),e&&(window.location.href=b.freshHomePage)}}else a.isWeixin=!1;a.link=b.freshHomePage}]).controller("FreshItemCtrl",["$scope","$stateParams","device","ENV",function(a,b,c,d){"weixin"===d.device?a.isWeixin=!0:(a.isWeixin=!1,c.goFresh()),a.link=b.link,a.name=b.name}]),angular.module("search",[]).config(["$stateProvider",function(a){a.state("tab.search",{url:"/search",templateUrl:"app/search/templates/search.html",controller:"SearchCtrl"})}]).controller("SearchCtrl",["$scope","$ionicLoading","$ionicScrollDelegate","appFunc","Resource",function(a,b,c,d,e){function f(d){b.show({template:"加载中..."});var f="search_info";e.getSearchList(f,d).then(function(d){a.isHistory=!1,a.model=d,a.nextPage=d.page.next,c.scrollTo(0,0,!0),a.$broadcast("scroll.infiniteScrollComplete"),b.hide()},function(a){b.hide()})}function g(b){try{arr=JSON.parse(localStorage.getItem("searchHistory"))}catch(c){arr=[]}arr=angular.isArray(arr)?arr:[];for(var d=arr.length,e=0;e<d;e++)if(arr[e]==b)return;d>=10?(arr.unshift(b),arr.pop()):0===d?arr.push(b):arr.unshift(b),a.storage=arr,localStorage.setItem("searchHistory",JSON.stringify(arr))}function h(){var a=[];try{a=JSON.parse(localStorage.getItem("searchHistory"))}catch(b){a=[]}return a}var i="";a.storage=h(),a.isHistory=!0,a.searchContent=function(){var a=document.querySelectorAll(".item-input-wrapper .bar-search")[0];i=a.value,a.blur(),f(i),""!==i&&g(i)},a.clearContent=function(){var b=document.querySelectorAll(".item-input-wrapper .bar-search")[0];b.value="",b.focus(),a.isHistory=!0},a.searchHistory=function(a){f(a.target.innerHTML)},a.clearHistory=function(){localStorage.setItem("searchHistory",null),a.storage=h()},a.loadMore=function(){a.nextPage&&e.get(a.nextPage).then(function(b){a.model.list_data=a.model.list_data.concat(b.list_data),a.nextPage=b.page.next,a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})}}]),angular.module("destination",[]).config(["$stateProvider",function(a){a.state("tab.destination",{url:"/destination",templateUrl:"app/search/templates/destination.html",controller:"DestinationCtrl",resolve:{data:["Resource","$ionicLoading",function(a,b){return b.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getAreaList()}]}})}]).controller("DestinationCtrl",["$scope","$http","$ionicHistory","modify","Resource","data","device",function(a,b,c,d,e,f,g){var h=f.list_data;a.model=f,a.searchText="",a.isSearch=!1,a.hasData=!0,a.selectCity=function(a){e.get(a).then(function(a){c.goBack(),d.ismodify=!0})},a.clearText=function(){a.isSearch=!1,a.searchText="",a.model.list_data=h},a.changeText=function(){var b=!1;if(""===a.searchText)a.model.list_data=h;else{var c=new RegExp("^"+a.searchText,"i"),d=[],e={};for(var f in h)d=h[f].filter(function(b){return c.test(b.spell)||b.name.match(a.searchText)}),0!==d.length&&(e[f]=d,b=!0);a.hasData=b,a.model.list_data=e}},a.getLocation=function(){g.getLocation(function(){c.goBack(),d.ismodify=!0})},wx.ready(function(){}),wx.error(function(a){})}]),angular.module("shop",[]).config(["$stateProvider",function(a){a.state("tab.shop1",{url:"/recommend/1/:link/:type/:hasSub",templateUrl:"app/shops/templates/shop-dot-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.shop1"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.shop2",{url:"/recommend/2/:link/:type/:hasSub",templateUrl:"app/shops/templates/shop-line-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.shop2"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.shop3",{url:"/recommend/3/:link/:type/:hasSub",templateUrl:"app/shops/templates/shop-act-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.shop3"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.book-info",{url:"/recommend/:type/:id",templateUrl:"app/shops/templates/shop-book-info.html",controller:"BookInfoCtrl"}).state("tab.farm-list",{url:"/farmList/:link",templateUrl:"app/shops/templates/farm-list.html",controller:"FarmListCtrl"}).state("tab.share-shop1",{url:"/tuijiandetail_0/:id",templateUrl:"app/shops/templates/shop-dot-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","ENV",function(a,b,c,d,e){if(null==d.backView()||"tab.share-shop1"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(e.apiEndpoint+"/index.php?r=api/dot/view&id="+b.id)}]}}).state("tab.share-shop2",{url:"/tuijiandetail_1/:id",templateUrl:"app/shops/templates/shop-line-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","ENV",function(a,b,c,d,e){if(null==d.backView()||"tab.share-shop2"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(e.apiEndpoint+"/index.php?r=api/thrand/view&id="+b.id)}]}}).state("tab.share-shop3",{url:"/tuijiandetail_2/:id",templateUrl:"app/shops/templates/shop-act-detail.html",controller:"DetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","ENV",function(a,b,c,d,e){if(null==d.backView()||"tab.share-shop3"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(e.apiEndpoint+"/index.php?r=api/actives/view&id="+b.id)}]}})}]).controller("DetailCtrl",["$scope","$sce","$stateParams","appFunc","data","bookInfo","farmList","device","ENV",function(a,b,c,d,e,f,g,h,i){function j(a){for(var b={itemList:[],farmList:[]},c=0,d=a.length;c<d;c++)a[c].item_type.value==-1?b.farmList.push(a[c]):b.itemList.push(a[c]);return b}function k(){setTimeout(function(){h.share(a.model.name,o,a.model.share_image,a.model.page_info)},250)}var l,m=c.hasSub;if(a.hasSub=!m,a.model=e,"1"===a.model.c_id?l=a.model.dot_id:"2"===a.model.c_id?l=a.model.thrand_id:"3"===a.model.c_id&&(l=a.model.actives_id),a.link=c.link,3!=a.model.c_id&&2!=a.model.c_id||(a.model.list=d.mergeLineDay(a.model.list)),1==a.model.c_id){var n=j(a.model.list);a.model.list=n.itemList,g.list=a.model.exterior_link_arr}f.bookInfo=e.book_info,f.costInfo=e.cost_info,a.model.actives_info&&(a.active_intro=b.trustAsHtml(a.model.actives_info.remark));var o=i.apiEndpoint+"/index.php?r=site/share&share="+l;a.doShare=function(){h.shareMsg(a.model.name,a.model.page_info,a.model.share_image,o)},"weixin"===i.device&&k()}]).controller("FarmListCtrl",["$scope","$state","$stateParams","ENV","device","Resource","farmList",function(a,b,c,d,e,f,g){g.list?a.model=g.list:f.get(c.link).then(function(b){a.model=b.exterior_link_arr}),a.goFresh=function(a,c,f,g){"app"===d.device?e.goSeekFreshDetail2(a,c,f,g):b.go("tab.fresh-item",{link:g,name:a})}}]).controller("BookInfoCtrl",["$scope","$sce","$state","bookInfo",function(a,b,c,d){void 0===d.bookInfo&&c.go("tab.recommend"),a.bookInfo=b.trustAsHtml(d.bookInfo),a.costInfo=b.trustAsHtml(d.costInfo)}]).factory("bookInfo",function(){return{}}).factory("farmList",function(){return{}}).directive("shopBanner",["$window","Resource","$ionicLoading","$ionicActionSheet","$ionicPopup","appFunc","ENV","modify","device",function(a,b,c,d,e,f,g,h,i){return{restrict:"E",replace:!0,templateUrl:"app/shops/templates/shop-banner.tpl.html",link:function(e,f,j){f.css({height:2*a.innerWidth/3+"px",overflow:"hidden",position:"relative"}).find("img").css({display:"block",width:"100%",height:"100%"}),"weixin"===g.device&&(e.isWeixin=!0);var k=e.model,l="1"==k.c_id?k.dot_id:"2"==k.c_id?k.thrand_id:"3"==k.c_id?k.actives_id:0;e.doPraise=function(){b.postPraise(l).then(function(a){1==a.value?(c.show({template:"点赞成功",duration:600}),k.collent_status=1,k.praise=parseInt(k.praise)+1):(c.show({template:"取消赞成功",duration:600}),k.collent_status=0,k.praise=parseInt(k.praise)-1,h.ismodify=!0)})},e.doCall=function(){var a="3"==k.c_id?"联系代理商":"联系运营商";d.show({buttons:[{text:a},{text:"联系田觅觅客服"}],destructiveText:"取消",cssClass:"tmm-action-sheet",destructiveButtonClicked:function(){return!0},buttonClicked:function(a){return 0===a&&i.tmmWxCallPhone(k.manage_phone),1===a&&i.tmmWxCallPhone(k.tmm_phone),!0}})}}}}]).directive("shopIndicator",["$compile",function(a){return{restrict:"E",replace:!0,template:"",link:function(b,c,d){function e(){var a;return 1==b.model.is_sale.value?0==b.model.actives_status.value?a='<div class="tmm-detail-btn gray-btn">报名时间还未开始</div>':1==b.model.actives_status.value?a=0==b.model.actives_info.order_number.value?'<div class="tmm-detail-btn gray-btn">报名人数已满</div>':1==b.model.actives_pay_type.value?'<div ui-sref="tab.order-actA({id: model.actives_id})" class="tmm-detail-btn act-btn">{{model.actives_time.value == 1 ? "我也想去" : "我也要报名"}}</div>':b.model.order_actives.value==-1?'<div ui-sref="tab.order-act({id: model.actives_id})" class="tmm-detail-btn act-btn">{{model.actives_time.value == 1 ? "我也想去" : "我也要报名"}}</div>':'<div class="tmm-detail-btn gray-btn">已报名</div>':2==b.model.actives_status.value&&(a='<div class="tmm-detail-btn gray-btn">报名结束</div>'):a='<div class="tmm-detail-btn gray-btn">此点正在开发中，敬请期待</div>',a}function f(){var a;return a=1==b.model.is_sale.value?h(i(b.model.list))?'<div class="tmm-detail-btn gray-btn">线路免费</div>':'<div ui-sref="tab.order-line({id: model.thrand_id})" class="tmm-detail-btn line-btn">我也想去</div>':'<div class="tmm-detail-btn gray-btn">此点正在开发中，敬请期待</div>'}function g(){var a;return a=1==b.model.is_sale.value?h(b.model.list)?'<div class="tmm-detail-btn gray-btn">景点免费</div>':'<div ui-sref="tab.order-dot({id: model.dot_id})" class="tmm-detail-btn dot-btn">我也想去</div>':'<div class="tmm-detail-btn gray-btn">此点正在开发中，敬请期待</div>'}function h(a){for(var b=0,c=a.length;b<c;b++)if(1==a[b].free_status.value)return!1;return!0}function i(a){var b=[];for(var c in a)for(var d in a[c].dot_list[0].day_item)b.push(a[c].dot_list[0].day_item[d]);return b}var j=d.type,k="";if(b.hasSub){"act"==j?k=e():"line"==j?k=f():"dot"==j&&(k=g());var l=a(k)(b);c.append(l)}}}}]),angular.module("item",[]).config(["$stateProvider",function(a){a.state("tab.more-detail1",{url:"/eat/:link",templateUrl:"app/items/templates/eat.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.more-detail2",{url:"/live/:link",templateUrl:"app/items/templates/live.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.more-detail3",{url:"/play/:link",templateUrl:"app/items/templates/play.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.share-item1",{url:"/item/1/:id/1",templateUrl:"app/items/templates/eat.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getItemDetail(1,b.id)}]}}).state("tab.share-item2",{url:"/item/2/:id/2",templateUrl:"app/items/templates/eat.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getItemDetail(2,b.id)}]}}).state("tab.share-item3",{url:"/item/3/:id/3",templateUrl:"app/items/templates/eat.html",controller:"MoreDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getItemDetail(3,b.id)}]}})}]).controller("MoreDetailCtrl",["$scope","$stateParams","$sce","$ionicPopover","$ionicPopup","data","Resource","appFunc","device","ENV",function(a,b,c,d,e,f,g,h,i,j){function k(){setTimeout(function(){i.share(a.model.name,l,a.model.img,a.model.address)},250)}a.info=f,a.contentHTML=c.trustAsHtml(f.content),"app"===j.device?a.disMap=!0:a.disMap=!1,d.fromTemplateUrl("app/items/templates/item-intro.tpl.html",{scope:a}).then(function(b){a.popover=b}),a.openPopover=function(b){a.popover.show(b)},a.closePopover=function(){a.popover.remove()},a.$on("$destroy",function(){a.popover.remove()}),a.detailCall=function(){a.btnClick=!0;var b=a.info.phone;i.tmmWxCallPhone(b).then(function(){a.btnClick=!1})},a.$on("modal.removed",function(){}),a.linePraise=function(){},a.model=f;var l=j.apiEndpoint+"/index.php?r=site/share&share="+a.model.value+"&type=2";a.doShare=function(){i.shareMsg(a.model.name,a.model.address,a.model.img,l)},"weixin"===j.device&&(a.isWeixin=!0,k()),a.showMapItemView=function(a,b,c,d){"app"===j.device&&i.showMap(a,b,c,d)}}]),angular.module("order",[]).config(["$stateProvider",function(a){a.state("tab.order-dot",{url:"/order/dot/:id",templateUrl:"app/order/templates/order-dot.html",controller:"OrderDotCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.order-dot"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getOrderDetail(b.id)}]}}).state("tab.order-line",{url:"/order/line/:id",templateUrl:"app/order/templates/order-line.html",controller:"OrderLineCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.order-line"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getOrderDetail(b.id)}]}}).state("tab.order-act",{url:"/order/act/:id",templateUrl:"app/order/templates/order-act.html",controller:"OrderActCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.order-act"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getOrderDetail(b.id)}]}}).state("tab.order-actA",{url:"/order/actA/:id",templateUrl:"app/order/templates/order-actA.html",controller:"OrderActACtrl"})}]).controller("OrderDotCtrl",["$scope","$filter","$ionicModal","$state","$ionicLoading","backStep","Resource","modify","security","appFunc","MESSAGES","uiCalendar","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){for(var b=a.model.items_fare,c=0,d=0;d<b.length;d++)for(var e=0;e<b[d].fare.length;e++)c+=2==b[d].classliy.value?b[d].fare[e].number*b[d].fare[e].price*b[d].fare[e].hotel_number:b[d].fare[e].number*b[d].fare[e].price;return c}function o(){var b,c,d={},e=0,f=0;for(d[0]=[],d[0][0]={},d[0][0][a.model.value]=[],e=0;e<a.model.items_fare.length;e++)for(d[0][0][a.model.value][e]={},d[0][0][a.model.value][e][a.model.items_fare[e].value]=[],f=0;f<a.model.items_fare[e].fare.length;f++)if(a.model.items_fare[e].fare[f].number>0&&(d[0][0][a.model.value][e][a.model.items_fare[e].value][f]={},d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value]={},d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].price=a.model.items_fare[e].fare[f].price,d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].number=a.model.items_fare[e].fare[f].number,d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].count=a.model.items_fare[e].fare[f].price*a.model.items_fare[e].fare[f].number,"2"==a.model.items_fare[e].classliy.value)){if("0"==a.model.items_fare[e].fare[f].start_date||"0"==a.model.items_fare[e].fare[f].end_date)return!1;d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].start_date=a.model.items_fare[e].fare[f].start_date,d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].end_date=a.model.items_fare[e].fare[f].end_date,d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].hotel_number=a.model.items_fare[e].fare[f].hotel_number,d[0][0][a.model.value][e][a.model.items_fare[e].value][f][a.model.items_fare[e].fare[f].value].count=a.model.items_fare[e].fare[f].price*a.model.items_fare[e].fare[f].number*a.model.items_fare[e].fare[f].hotel_number}for(b in d[0][0])for(e=0;e<d[0][0][b].length;e++)for(c in d[0][0][b][e])for(f=0;f<d[0][0][b][e][c].length;f++)d[0][0][b][e][c][f]||(d[0][0][b][e][c].splice(f,1),f--);for(b in d[0][0])for(e=0;e<d[0][0][b].length;e++)for(c in d[0][0][b][e])0===d[0][0][b][e][c].length&&(d[0][0][b].splice(e,1),
e--);for(e=0;e<d[0].length;e++)for(b in d[0][e])0===d[0][e][b].length&&(d[0].splice(e,1),e--);return d}var p;a.model=m,a.date="",a.totalPrice=0,g.getUserInfo().then(function(b){i.userInfo=b,a.userInfo=b}),c.fromTemplateUrl("app/order/templates/selected-retinue.html",{scope:a}).then(function(b){a.modal=b}),a.$on("$ionicView.beforeLeave",function(){a.modal.hide()}),a.$on("$destroy",function(){a.modal.remove()}),a.$on("$ionicView.beforeEnter",function(){h.ismodify&&(g.getUserInfo().then(function(b){i.userInfo=b,a.userInfo=b}),h.ismodify=!1)}),a.$watch("totalPrice"),a.selectDate=function(){l.show({selected:function(c){p=c[0],a.date=b("date")(c[0],"yyyy-MM-dd")},minDate:new Date(Date.now()+864e5),num:1})},a.selectHotelDate=function(c,d){return p?void l.show({selected:function(e){d.start_date=b("date")(e[0],"yyyy-MM-dd"),d.end_date=b("date")(e[1],"yyyy-MM-dd"),d.hotel_number=parseInt((e[1].getTime()-e[0].getTime())/864e5),c.target.innerHTML=b("date")(e[0],"yyyy.MM.dd")+"-"+b("date")(e[1],"MM.dd")+"(共"+d.hotel_number+"晚)",a.totalPrice=n().toFixed(2)},minDate:p,maxDate:new Date(p.getTime()+7776e5),num:2}):void j.tipMsg(k["order.goTime"])},a.addNum=function(b){b.number++,a.totalPrice=n().toFixed(2)},a.subNum=function(b){b.number=b.number-1>0?b.number-1:0,a.totalPrice=n().toFixed(2)},a.submit=function(){var b={},c=[];if(c.push({is_main:"1",retinue_id:a.userInfo.main_retinueInfo.list[0].value}),a.userInfo.retinueInfo.list)for(var h=0;h<a.userInfo.retinueInfo.list.length;h++)if(a.userInfo.retinueInfo.list[h].isSelected){var i={is_main:"0",retinue_id:a.userInfo.retinueInfo.list[h].value};c.push(i)}var l=o();return a.date?l?0===l[0].length?void j.tipMsg("请选择商品",1500):0===c.length?void j.tipMsg(k["order.retinue"],1500):(b={Order:{user_price:"0",order_type:"1",pay_type:"1",order_price:a.totalPrice,son_order_count:"0",go_time:a.date,user_go_count:c.length},OrderRetinue:c,OrderItems:l},e.show({template:"订单提交中"}),void g.createOrder(b).then(function(a){e.hide(),j.alert("下单成功").then(function(){d.go("tab.myorderdetail_1",{link:a.link}).then(function(){f.step=-2})})},function(a){e.hide(),j.alert(a.msg)})):void j.tipMsg("您有未选择入住和退房日期的项目",1500):void j.tipMsg(k["order.goTime"],1500)}}]).controller("OrderLineCtrl",["$scope","$filter","$state","$ionicModal","$ionicLoading","backStep","MESSAGES","appFunc","Resource","modify","security","uiCalendar","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){var b=0,c=a.model.dot_list;for(var d in c)for(var e=0;e<c[d].length;e++)for(var f in c[d][e])if("$$hashKey"!=f)for(var g=0;g<c[d][e][f].length;g++)for(var h=0;h<c[d][e][f][g].fare.length;h++)c[d][e][f][g].fare[h].count=c[d][e][f][g].fare[h].number*c[d][e][f][g].fare[h].price,b=(c[d][e][f][g].fare[h].count+1*b).toFixed(2);return a.num=p+q,b=1*b,b.toFixed(2)}function o(){var b={},c=a.model.dot_list;for(var d in c){b[d]=[];for(var e=0;e<c[d].length;e++){b[d][e]={};for(var f in c[d][e])if(b[d][e][f]=[],"$$hashKey"!=f)for(var g=0;g<c[d][e][f].length;g++){b[d][e][f][g]={},b[d][e][f][g][c[d][e][f][g].value]=[];for(var h=0;h<c[d][e][f][g].fare.length;h++)b[d][e][f][g][c[d][e][f][g].value][h]={},b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value]={},b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].price=c[d][e][f][g].fare[h].price,b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].number=c[d][e][f][g].fare[h].number,b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].count=c[d][e][f][g].fare[h].count}}}return b.value=a.model.value,b}var p=0,q=0;a.model=m,a.goTime="",a.totlePrice=0,a.num=0,i.getUserInfo().then(function(b){k.userInfo=b,a.userInfo=b}),d.fromTemplateUrl("app/order/templates/selected-retinue.html",{scope:a}).then(function(b){a.modal=b}),a.$on("$ionicView.beforeLeave",function(){a.modal.hide()}),a.$on("$destroy",function(){a.modal.remove()}),a.$on("$ionicView.beforeEnter",function(){j.ismodify&&(i.getUserInfo().then(function(b){k.userInfo=b,a.userInfo=b}),j.ismodify=!1)}),a.selectDate=function(){l.show({selected:function(c){a.goTime=b("date")(c[0],"yyyy-MM-dd")},minDate:new Date(Date.now()+864e5),num:1})},a.addNum=function(b,c){var d=a.model.dot_list;if("成人"==b)a.model.OrderItemsFare[c].number=++p;else if("儿童"==b){if(q++,2*p<q)return h.tipMsg(g["order.num"]),void q--;a.model.OrderItemsFare[c].number=q}for(var e in d)for(var f=0;f<d[e].length;f++)for(var i in d[e][f])if("$$hashKey"!=i)for(var j=0;j<d[e][f][i].length;j++)for(var k=0;k<d[e][f][i][j].fare.length;k++)"成人"==d[e][f][i][j].fare[k].info?(d[e][f][i][j].fare[k].number=p,a.model.dot_list[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2)):"儿童"==d[e][f][i][j].fare[k].info&&(d[e][f][i][j].fare[k].number=q,d[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2)),"0"!=d[e][f][i][j].fare[k].room_number&&(d[e][f][i][j].fare[k].number=Math.ceil(p/d[e][f][i][j].fare[k].room_number),d[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2));a.totlePrice=n()},a.subNum=function(b,c){var d=a.model.dot_list;if("成人"==b){if(0===p)return;if(p--,2*p<q)return p++,void h.tipMsg(g["order.num"]);a.model.OrderItemsFare[c].number=p}else if("儿童"==b){if(0===q)return;q--,a.model.OrderItemsFare[c].number=q}for(var e in d)for(var f=0;f<d[e].length;f++)for(var i in d[e][f])if("$$hashKey"!=i)for(var j=0;j<d[e][f][i].length;j++)for(var k=0;k<d[e][f][i][j].fare.length;k++)"成人"==d[e][f][i][j].fare[k].info?(d[e][f][i][j].fare[k].number=p,d[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2)):"儿童"==d[e][f][i][j].fare[k].info&&(d[e][f][i][j].fare[k].number=q,d[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2)),"0"!=d[e][f][i][j].fare[k].room_number&&(d[e][f][i][j].fare[k].number=Math.ceil(p/d[e][f][i][j].fare[k].room_number),d[e][f][i][j].fare[k].count=(d[e][f][i][j].fare[k].number*d[e][f][i][j].fare[k].price).toFixed(2));a.totlePrice=n()},a.submit=function(){if(""===a.goTime)return void h.tipMsg(g["order.goTime"]);if(0===p)return void h.tipMsg(g["order.goNum"]);if(!a.userInfo.main_retinueInfo.list)return void h.tipMsg(g["order.retinue"]);var b={},d=[];if(d.push({is_main:"1",retinue_id:a.userInfo.main_retinueInfo.list[0].value}),a.userInfo.retinueInfo.list)for(var j=0;j<a.userInfo.retinueInfo.list.length;j++)if(a.userInfo.retinueInfo.list[j].isSelected){var k={is_main:"0",retinue_id:a.userInfo.retinueInfo.list[j].value};d.push(k)}return d.length!=p+q?void h.tipMsg(g["order.retinueNum"]):(b={Order:{user_price:"0",order_type:"2",order_price:a.totlePrice,son_order_count:"0",go_time:a.goTime,user_go_count:d.length},OrderRetinue:d,OrderItems:o(),OrderItemsFare:a.model.OrderItemsFare},e.show({template:"订单提交中"}),void i.createOrder(b).then(function(a){e.hide(),h.alert("下单成功").then(function(){c.go("tab.myorderdetail_2",{link:a.link}).then(function(){f.step=-2})})},function(a){e.hide(),h.alert(a.msg)}))}}]).controller("OrderActCtrl",["$scope","$state","$filter","$ionicModal","$ionicLoading","orderType","backStep","MESSAGES","appFunc","Resource","modify","security","uiCalendar","data",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){var b=0,c=a.model.dot_list;for(var d in c)for(var e=0;e<c[d].length;e++)for(var f in c[d][e])if("$$hashKey"!=f)for(var g=0;g<c[d][e][f].length;g++)for(var h=0;h<c[d][e][f][g].fare.length;h++)c[d][e][f][g].fare[h].count=c[d][e][f][g].fare[h].number*c[d][e][f][g].fare[h].price,b=(c[d][e][f][g].fare[h].count+1*b).toFixed(2);return a.num=q+r,t=s*a.num,b=1*b+1*t,b.toFixed(2)}function p(){var b={},c=a.model.dot_list;for(var d in c){b[d]=[];for(var e=0;e<c[d].length;e++){b[d][e]={};for(var f in c[d][e])if(b[d][e][f]=[],"$$hashKey"!=f)for(var g=0;g<c[d][e][f].length;g++){b[d][e][f][g]={},b[d][e][f][g][c[d][e][f][g].value]=[];for(var h=0;h<c[d][e][f][g].fare.length;h++)b[d][e][f][g][c[d][e][f][g].value][h]={},b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value]={},b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].price=c[d][e][f][g].fare[h].price,b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].number=c[d][e][f][g].fare[h].number,b[d][e][f][g][c[d][e][f][g].value][h][c[d][e][f][g].fare[h].value].count=c[d][e][f][g].fare[h].count}}}return b.value=a.model.value,b}var q=0,r=0,s=0,t=0;s=n.is_organizer.value?n.price.value:0,a.model=n,a.goTime="",a.totlePrice=0,a.num=0,j.getUserInfo().then(function(b){l.userInfo=b,a.userInfo=b}),d.fromTemplateUrl("app/order/templates/selected-retinue.html",{scope:a}).then(function(b){a.modal=b}),a.$on("$ionicView.beforeLeave",function(){a.modal.hide()}),a.$on("$destroy",function(){a.modal.remove()}),a.$on("$ionicView.beforeEnter",function(){k.ismodify&&(j.getUserInfo().then(function(b){l.userInfo=b,a.userInfo=b}),k.ismodify=!1)}),a.addNum=function(b,c){var d=a.model.dot_list;if("成人"==b)a.model.OrderItemsFare[c].number=++q;else if("儿童"==b){if(r++,2*q<r)return i.tipMsg(h["order.num"]),void r--;a.model.OrderItemsFare[c].number=r}for(var e in d)for(var f=0;f<d[e].length;f++)for(var g in d[e][f])if("$$hashKey"!=g)for(var j=0;j<d[e][f][g].length;j++)for(var k=0;k<d[e][f][g][j].fare.length;k++)"成人"==d[e][f][g][j].fare[k].info?(d[e][f][g][j].fare[k].number=q,a.model.dot_list[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2)):"儿童"==d[e][f][g][j].fare[k].info&&(d[e][f][g][j].fare[k].number=r,d[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2)),"0"!=d[e][f][g][j].fare[k].room_number&&(d[e][f][g][j].fare[k].number=Math.ceil(q/d[e][f][g][j].fare[k].room_number),d[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2));a.totlePrice=o()},a.subNum=function(b,c){var d=a.model.dot_list;if("成人"==b){if(0===q)return;if(q--,2*q<r)return q++,void i.tipMsg(h["order.num"]);a.model.OrderItemsFare[c].number=q}else if("儿童"==b){if(0===r)return;r--,a.model.OrderItemsFare[c].number=r}for(var e in d)for(var f=0;f<d[e].length;f++)for(var g in d[e][f])if("$$hashKey"!=g)for(var j=0;j<d[e][f][g].length;j++)for(var k=0;k<d[e][f][g][j].fare.length;k++)"成人"==d[e][f][g][j].fare[k].info?(d[e][f][g][j].fare[k].number=q,d[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2)):"儿童"==d[e][f][g][j].fare[k].info&&(d[e][f][g][j].fare[k].number=r,d[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2)),"0"!=d[e][f][g][j].fare[k].room_number&&(d[e][f][g][j].fare[k].number=Math.ceil(q/d[e][f][g][j].fare[k].room_number),d[e][f][g][j].fare[k].count=(d[e][f][g][j].fare[k].number*d[e][f][g][j].fare[k].price).toFixed(2));a.totlePrice=o()},a.submit=function(){if(0===q)return void i.tipMsg(h["order.goNum"]);if(!a.userInfo.main_retinueInfo.list)return void i.tipMsg(h["order.retinue"]);var c={},d=[];if(d.push({is_main:"1",retinue_id:a.userInfo.main_retinueInfo.list[0].value}),a.userInfo.retinueInfo.list)for(var k=0;k<a.userInfo.retinueInfo.list.length;k++)if(a.userInfo.retinueInfo.list[k].isSelected){var l={is_main:"0",retinue_id:a.userInfo.retinueInfo.list[k].value};d.push(l)}return d.length!=q+r?void i.tipMsg(h["order.retinueNum"]):(c={Order:{user_price:t,order_type:"3",order_price:a.totlePrice,son_order_count:"0",user_go_count:d.length},OrderRetinue:d,OrderItems:p(),OrderItemsFare:a.model.OrderItemsFare},e.show({template:"觅趣报名中"}),void j.createOrder(c).then(function(a){e.hide(),i.alert("报名成功").then(function(){f.joinact=1,b.go("tab.myorderdetail_3",{link:a.link}).then(function(){g.step=-2})})},function(a){e.hide(),i.alert(a.msg)}))}}]).controller("OrderActACtrl",["$scope","$state","$stateParams","orderType","removeBackView","Resource","appFunc","MESSAGES",function(a,b,c,d,e,f,g,h){function i(){var a=angular.element(document.querySelectorAll(".order.apply input"));a.removeClass("has-error");for(var b=0;b<a.length;b++){var c=angular.element(a[b]),d=c.attr("data-type"),e=c.val();if("name"==d){if(""===e)return g.tipMsg("姓名不能为空"),c.addClass("has-error"),!1;if(e.length>10)return g.tipMsg("姓名长度不能大于10个字符"),c.addClass("has-error"),!1}else if("phone"==d){if(""===e)return g.tipMsg("手机号码不能为空"),c.addClass("has-error"),!1;if(!/^1[34578][0-9]{9}$/.test(e))return g.tipMsg("手机号码格式有误"),c.addClass("has-error"),!1}else if("code"==d&&""===e)return g.tipMsg("短信验证码不能为空"),c.addClass("has-error"),!1}return!0}function j(){var b=0,c=[],d={Attend:[{sms:a.mainRetinueInfo.code,name:a.mainRetinueInfo.name,phone:a.mainRetinueInfo.phone,people:a.adultRetinueInfo.length+1,children:a.childRetinueInfo.length}]};for(b=0;b<a.adultRetinueInfo.length;b++)a.adultRetinueInfo[b].is_people=1,c.push(a.adultRetinueInfo[b]);for(b=0;b<a.childRetinueInfo.length;b++)a.childRetinueInfo[b].is_people=0,c.push(a.childRetinueInfo[b]);return d.Attend=d.Attend.concat(c),d}var k=1,l=0,m=null;id=c.id,a.c_num=1,a.e_num=0,a.mainRetinueInfo={name:"",phone:"",code:""},a.adultRetinueInfo=[],a.childRetinueInfo=[],a.addNum=function(b){if("adult"==b)a.c_num=++k,a.adultRetinueInfo.push({name:"",phone:""});else if("child"==b){if(l++,2*k<l)return g.tipMsg(h["order.num"]),void l--;a.e_num=l,a.childRetinueInfo.push({name:""})}},a.subNum=function(b){if("adult"==b){if(1===k)return;if(k--,2*k<l)return k++,void g.tipMsg(h["order.num"]);a.c_num=k,a.adultRetinueInfo.pop()}else if("child"==b){if(0===l)return;l--,a.e_num=l,a.childRetinueInfo.pop()}},a.$on("destory",function(){clearInterval(m)}),a.getCode=function(b){if(""===a.mainRetinueInfo.phone)return void g.tipMsg("请输入手机号码");if(!/^1[34578][0-9]{9}$/.test(a.mainRetinueInfo.phone))return void g.tipMsg("手机号码格式有误");var c=angular.element(b.target),d=60;if(!c.hasClass("gray")){c.addClass("gray"),c.html("获取验证码("+d+")"),m=setInterval(function(){d--,c.html("获取验证码("+d+")"),1==d&&(c.removeClass("gray"),c.html("获取验证码"),clearInterval(m))},1e3);var e={phone:a.mainRetinueInfo.phone};f.getApplyCode(id,e).then(function(a){},function(a){g.tipMsg(a.msg),c.removeClass("gray"),c.html("获取验证码"),clearInterval(m)})}},a.submit=function(){if(i()){var a=j();f.actApply(id,a).then(function(a){d.joinact=2,b.go("tab.myjoinact").then(function(){e.remove()})},function(a){for(var b in a.data.form)for(var c in a.data.form[b])g.tipMsg(a.data.form[b][c][0])})}}}]).filter("roomNumber",function(){return function(a,b,c){return"2"!==b?a:"单 双 三 四 五 六 七 八 九 十".split(" ")[parseInt(c)-1]+"人间"}}),angular.module("my",["myInfo","mycreateact"]).config(["$stateProvider",function(a){a.state("tab.my",{url:"/my",templateUrl:"app/my/templates/my.html",controller:"MyCtrl",resolve:{data:["$ionicViewSwitcher","$ionicHistory","device","ENV",function(a,b,c,d){"app"===d.device&&c.exitSeekFresh();var e=b.currentView();!e||"tab.recommend"!=e.stateName&&"tab.seek"!=e.stateName&&"tab.my"!=e.stateName||a.nextTransition("none")}]}})}]).controller("MyCtrl",["$scope","$ionicHistory","security","Resource","ENV",function(a,b,c,d,e){a.userInfo=c.currentUser,a.$on("$ionicView.enter",function(){c.getUserInfo().then(function(b){a.userInfo=b.userInfo},function(b){a.userInfo=null}),b.clearHistory()}),a.$on("getUserInfo",function(b,c){a.userInfo=c}),a.logout=function(){d.logOut().then(function(b){a.userInfo=null,c.userInfo=null},function(a){})},a.login=function(){c.login()},a.isWeixin="weixin"===e.device}]),angular.module("myInfo",[]).config(["$stateProvider",function(a){a.state("tab.myInfo",{url:"/myInfo",templateUrl:"app/my/templates/myInfo.html",controller:"MyInfoCtrl",resolve:{data:["security",function(a){return a.getUserInfo()}]}}).state("tab.updateLinkman",{url:"/updateLinkman/:type/:link",templateUrl:"app/my/templates/linkman.html",controller:"UpdateLinkmanCtrl"}).state("tab.updatePwd",{url:"/updatePwd",templateUrl:"app/my/templates/updatePwd.html",controller:"UpdatePwdCtrl"}).state("tab.updatePhone",{url:"/updatePhone",templateUrl:"app/my/templates/updatePhone.html",controller:"UpdatePhoneCtrl"})}]).controller("MyInfoCtrl",["$scope","$ionicPopup","$ionicActionSheet","modify","appFunc","Resource","data",function(a,b,c,d,e,f,g){a.model=g,a.$on("$ionicView.beforeEnter",function(){d.ismodify&&(f.getUserInfo().then(function(b){a.model=b}),d.ismodify=!1)}),a.updateNickname=function(){b.prompt({title:"修改昵称",cancelText:"取消",inputType:"text",okText:"确认",cssClass:"tmm-ionic-prompt"}).then(function(b){b&&f.updateUserInfo({User:{nickname:b,gender:a.model.userInfo.gender}}).then(function(c){a.model.userInfo.nickname=b},function(a){e.alert(a.msg)})})},a.updateGender=function(){c.show({buttons:[{text:"男"},{text:"女"}],destructiveText:"取消",cssClass:"tmm-action-sheet",destructiveButtonClicked:function(){return!0},buttonClicked:function(b){var c=b+1;return f.updateUserInfo({User:{nickname:a.model.userInfo.nickname,gender:c+""}}).then(function(b){a.model.userInfo.gender=c},function(a){e.alert(a.msg)}),!0}})}}]).controller("UpdateLinkmanCtrl",["$scope","$stateParams","$ionicPopup","$ionicHistory","API","modify","Resource","appFunc",function(a,b,c,d,e,f,g,h){function i(){return a.model.name?a.model.identity?a.model.phone?h.isPhone(a.model.phone)?!(a.model.email&&!h.isEmail(a.model.email))||(h.alert("邮箱格式错误"),!1):(h.alert("手机号格式有误"),!1):(h.alert("手机号不能为空"),!1):(h.alert("身份证不能为空"),!1):(h.alert("姓名不能为空"),!1)}var j=["添加主要联系人","修改主要联系人","添加随行人员","修改随行人员"],k=b.link,l="";a.type=b.type,a.title=j[b.type],a.model={},1==a.type||3==a.type?g.get(k).then(function(b){a.model=b,k=a.model.update_link}):0==a.type?k=e.create_mainretinue:2==a.type&&(k=e.create_retinue),a.submit=function(){if(i()){var b={Retinue:{name:a.model.name,identity:a.model.identity,phone:a.model.phone,email:a.model.email}};g.post(k,b).then(function(b){l=0==a.type||2==a.type?"添加成功":"修改成功",h.alert(l).then(function(a){d.goBack(),f.ismodify=!0})},function(a){h.alert(a.msg)})}},a.deleteman=function(){h.confirm("确认删除联系人吗?",function(){g.get(a.model.delete_link).then(function(a){h.alert("删除成功").then(function(){d.goBack(),f.ismodify=!0})})})}}]).controller("UpdatePwdCtrl",["$scope","$interval","$ionicHistory","Resource","appFunc","security",function(a,b,c,d,e,f){function g(){b.cancel(i),a.disable=!0;var c=60;a.txt=c+"秒后获取",i=b(function(){a.txt=--c+"秒后获取",0===c&&(b.cancel(i),a.txt="获取验证码",a.disable=!1,i=null)},1e3)}function h(){return a.model.phone?e.isPhone(a.model.phone)?a.model.code?a.model.pwd?a.model.pwd==a.model.comfirmPwd||(e.alert("两次密码不一致"),!1):(e.alert("密码不能为空"),!1):(e.alert("验证码不能为空"),!1):(e.alert("手机号必须为11位数字"),!1):(e.alert("手机号不能为空"),!1)}var i=null;a.disable=!1,a.txt="获取验证码",a.$on("$destroy",function(a){b.cancel(i)}),f.getUserInfo().then(function(b){a.model=angular.extend({},b.userInfo)}),a.getCode=function(){if(null===i){var b={phone:a.model.phone};d.getPwdCode(b).then(function(a){g()},function(a){e.alert(a.msg)})}},a.submit=function(){if(h()){var b={User:{phone:a.model.phone,sms:a.model.code,_pwd:a.model.pwd,confirm_pwd:a.model.comfirmPwd}};d.updatePwd(b).then(function(a){d.logOut().then(function(a){f.userInfo=null,f.login()},function(a){}),f.getUserInfo().then(function(a){null!==a.userInfo&&c.goBack()},function(a){})},function(a){e.alert(a.msg)})}}}]).controller("UpdatePhoneCtrl",["$scope","$interval","$ionicHistory","modify","appFunc","Resource",function(a,b,c,d,e,f){function g(){b.cancel(j),a.disable=!0;var c=60;a.txt=c+"秒后获取",j=b(function(){a.txt=--c+"秒后获取",0===c&&(b.cancel(j),a.txt="获取验证码",a.disable=!1,j=null)},1e3)}function h(a){return a?!!e.isPhone(a)||(e.alert("手机号不是有效值"),!1):(e.alert("手机号码不能为空"),!1)}function i(a){return!!a||(e.alert("验证码不能为空"),!1)}var j=null;a.isNext=!1,a.disable=!1,a.txt="获取验证码",a.old={},a["new"]={},a.$on("$destroy",function(a){b.cancel(j)}),a.getCode=function(b){if(h(a[b].phone)&&null===j){var c={phone:a[b].phone};f.getUpdatePhoneCode(c,b).then(function(a){g()},function(a){e.alert(a.msg)})}},a.nextStep=function(){if(h(a.old.phone)&&i(a.old.code)){var c={User:{phone:a.old.phone,sms:a.old.code}};f.updateOldPhone(c).then(function(c){a.isNext=!0,b.cancel(j),a.txt="获取验证码",a.disable=!1,j=null},function(a){e.alert(a.msg)})}},a.submit=function(){if(h(a["new"].phone)&&i(a["new"].code)){var b={User:{phone:a["new"].phone,sms:a["new"].code}};f.updateNewPhone(b).then(function(a){c.goBack(),d.ismodify=!0},function(a){e.alert(a.msg)})}}}]).factory("modify",function(){return{ismodify:!1,modifydate:{actname:"",actnum:"",tourprice:"",changeline:""}}}),angular.module("login",[]).config(["$stateProvider",function(a){a.state("tab.login",{url:"/login",templateUrl:"app/login/templates/login.html",controller:"LoginCtrl"})}]).controller("LoginCtrl",["$scope","$http","$timeout","$location","ENV","Resource","appFunc",function(a,b,c,d,e,f,g){function h(){a.accLoginData={verifyCodeUrl:"",g_hash:""},a.loginModel={phone:"13632846019",password:"1234qwer",verifycode:""},a.showAccVerifyCode=function(){f.showAccCode().then(function(c){b.get(e.apiEndpoint+c.verifyCode).success(function(b){a.accLoginData.g_hash=b.hash1,a.accLoginData.verifyCodeUrl=e.apiEndpoint+b.url},function(a){}),a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})},a.accLogin=function(){var b={UserLoginForm:{phone:a.loginModel.phone,password:a.loginModel.password,verifyCode:a.loginModel.verifycode}};g.isPhone(a.loginModel.phone)?g.validatePassword(a.loginModel.password)?f.accLogin(b).then(function(a){d.path("/my")},function(b){if(b.form)for(var c in b.form)"UserLoginForm_verifyCode"==c&&a.showAccVerifyCode(),g.alert(b.form[c][0]);else b.msg?(g.alert(b.msg),a.showAccVerifyCode()):g.alert("输入有误，请重试")}):g.alert("密码必须有数字和字母组合"):g.alert("手机号码格式不对")},a.showAccVerifyCode()}function i(){a.mobLoginData={csrf:"",verifyCodeUrl:"",g_hash:"",codeText:"获取验证码",isDisabled:!1},a.mobLoginModel={phone:"",verifycode:"",msgcode:""};var h=60,i=function(){0===h?(a.mobLoginData.isDisabled=!1,a.mobLoginData.codeText="获取验证码",h=60):(a.mobLoginData.isDisabled=!0,a.mobLoginData.codeText=h+"秒后重试",h--,c(function(){i()},1e3))};a.canSend=function(){return a.mobLoginData.isDisabled},a.showMobileVerifyCode=function(){f.showMobCode().then(function(c){a.mobLoginData.csrf=c.csrf.TMM_CSRF,b.get(e.apiEndpoint+c.verifyCode).success(function(b){a.mobLoginData.g_hash=b.hash1,a.mobLoginData.verifyCodeUrl=e.apiEndpoint+b.url},function(a){}),a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})},a.getMsgCode=function(){if(g.isPhone(a.mobLoginModel.phone))if(""===a.mobLoginModel.verifycode)g.alert("图形验证码不能为空");else{var b={phone:a.mobLoginModel.phone,verifyCode:a.mobLoginModel.verifycode,TMM_CSRF:a.mobLoginData.csrf};f.getMobCode(b).then(function(b){if(b.data.form)for(var c in b.data.form)"verifyCode"==c&&a.showMobileVerifyCode(),g.alert(b.data.form[c][0]);else i()},function(a){})}else g.alert("手机号码格式不对")},a.mobLogin=function(){var b={UserSmsLoginForm:{phone:a.mobLoginModel.phone,sms:a.mobLoginModel.msgcode,verifyCode:a.mobLoginModel.verifycode}};g.isPhone(a.mobLoginModel.phone)?""===a.mobLoginModel.verifycode?g.alert("图形验证码不能为空"):""===a.mobLoginModel.msgcode?g.alert("短信验证码不正确"):f.mobLogin(b).then(function(a){d.path("/my")},function(b){if(b.form)for(var c in b.form)"UserSmsLoginForm_verifyCode"==c&&a.showVerifyCode(),g.alert(b.form[c][0]);else b.msg?(g.alert(b.msg),a.showMobileVerifyCode()):g.alert("输入有误，请重试")}):g.alert("手机号码格式不对")},a.showMobileVerifyCode()}a.accLoginShow=!0,a.mobileLogin=!1,h(),a.showLogin=function(b){1==b?(a.accLoginShow=!0,a.mobileLogin=!1,h()):2==b&&(a.accLoginShow=!1,a.mobileLogin=!0,i())}}]),angular.module("wallet",[]).config(["$stateProvider",function(a){a.state("tab.mywallet",{url:"/mywallet",cache:!1,templateUrl:"app/wallet/templates/my-wallet.html",controller:"WalletCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mywithdraw",{cache:!1,url:"/mywithdraw/:withdraw/:withdraw_format",templateUrl:"app/wallet/templates/my-wallet-withdraw.html",controller:"WithdrawWalletCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mywithdrawmessage",{cache:!1,url:"/mywithdrawmessage",templateUrl:"app/wallet/templates/my-withdraw-message.html",controller:"WithdrawWalletCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mywithdrawinfo",{url:"/mywithdrawinfo",templateUrl:"app/wallet/templates/my-withdraw-info.html",controller:"MyWithDrawInfoCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.withdrawRecord",{url:"/withdrawRecord",templateUrl:"app/wallet/templates/my-withdraw-record.html",controller:"WithDrawRecordCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mybankcardmanagement",{url:"/mybankcardmanagement",templateUrl:"app/wallet/templates/my-bankcard-management.html",controller:"MyBankCardManageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mybankcardchange",{url:"/mybankcardchange",templateUrl:"app/wallet/templates/my-bankcard-change.html",controller:"MyBankCardManageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.mybankcardprotocal",{url:"/mybankcardprotocal",templateUrl:"app/wallet/templates/my-bankcard-protocal.html"})}]).config(["$stateProvider",function(a){a.state("tab.mybankcardmessage",{cache:!1,url:"/mybankcardmessage",templateUrl:"app/wallet/templates/my-bankcard-message.html",controller:"MyBankCardManageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.newbank",{url:"/newbank",templateUrl:"app/wallet/templates/my-bankcard-new.html",controller:"MyBankCardManageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.traderecord",{url:"/traderecord",templateUrl:"app/wallet/templates/my-trade-record.html",controller:"TradeRecordCtrl"})}]).controller("WalletCtrl",["$scope","$http","$state","Resource","appFunc",function(a,b,c,d,e){a.withdraw=0,a.withdraw_format=0,d.getBurseInfo().then(function(b){a.json=b,a.withdraw=b.money,a.withdraw_format=b.money_format},function(a){}),a.BankCardHasOrNot=function(){d.getCash().then(function(b){0!=b.data.status?c.go("tab.mywithdraw",{withdraw:a.withdraw,withdraw_format:a.withdraw_format}):e.alert("请添加银行卡")},function(a){})},a.BankCardManageLink=function(){d.getCash().then(function(a){0!=a.data.status?c.go("tab.mybankcardmanagement"):c.go("tab.newbank")},function(a){})}}]).controller("WithdrawWalletCtrl",["$scope","$http","$stateParams","$interval","$state","Resource","appFunc","tmmCache","security",function(a,b,c,d,e,f,g,h,i){a.withdraw=c.withdraw,a.withdraw_format=c.withdraw_format,f.getCash().then(function(b){0!=b.data.status?a.json=b.data.data[0]:g.alert("获取相关银行卡信息出错")},function(a){}),i.getUserInfo().then(function(b){a.loginPhone=b.userInfo.phone}),a.json={},a.regText={sms:"",key:""},a.text="获取验证码",a.flag=!0,a.withdrawForm=function(){if(a.withdraw_form.drawMoney.$error.required)g.alert("提现金额不能为空");else if(isNaN(a.regText.drawMoney))g.alert("提现金额输入有误");else if(a.regText.drawMoney<100)g.alert("提现金额不能小于100元");else if(a.regText.drawMoney.length>12)g.alert("提现金额不能大于12位");else if(parseFloat(a.regText.drawMoney)>parseFloat(a.withdraw)){var b="可提现金额不足"+a.regText.drawMoney+"元";g.alert(b)}else a.withdraw_form.$valid&&(h.set("withdrawMoney",parseFloat(a.regText.drawMoney)),a.submitBank())},a.submitBank=function(){var a={Cash:{price:h.get("withdrawMoney")}};f.withdrawCash(a).then(function(a){1==a.status&&e.go("tab.mywithdrawmessage")},function(a){a.msg?g.alert(a.msg):g.alert("输入有误，请重试")})},a.goTime=function(){var b=60;a.text=b+"秒后重新获取",timer=d(function(){b--,a.text=b+"秒后重新获取",0==b&&(d.cancel(timer),a.text="获取验证码",a.flag=!0)},1e3)},a.getCode=function(){0!=a.flag&&f.getWithDrawCode().then(function(b){0==b.status?a.flag=!0:(a.flag=!1,a.goTime())},function(a){a.msg?g.alert(a.msg):g.alert("提现失败")})},a.chkBtnShow=!1,a.chkBtnHide=!0,a.messageFormButton=function(){a.message_form.sms.$error.required?(a.chkBtnShow=!1,a.chkBtnHide=!0):(a.chkBtnShow=!0,a.chkBtnHide=!1)},a.messageForm=function(){a.message_form.sms.$error.required&&mobileMessage("验证码不能为空，请输入验证码"),a.message_form.$valid&&a.submit()},a.submit=function(){var b={Cash:{sms:a.regText.sms,price:h.get("withdrawMoney")}};f.withdrawMessage(b).then(function(a){1==a.status&&e.go("tab.mywithdrawinfo")},function(a){a.msg?g.alert(a.msg):g.alert("提现失败")})}}]).controller("MyWithDrawInfoCtrl",["$scope","$http","Resource","tmmCache",function(a,b,c,d){a.withdrawMoney=d.get("withdrawMoney")}]).controller("WithDrawRecordCtrl",["$scope","$http","Resource","tmmCache","autoRefresh",function(a,b,c,d,e){a.list_data=[],a.listNum=0;var f=null;a.doRefresh=function(){c.getWithDrawRecord().then(function(b){a.listNum=b.list_data.length,a.list_data=b.list_data,f=b.page.next,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})},a.doRefresh(),a.loadMore=function(){c.get(f).then(function(b){a.list_data=a.list_data.concat(b.list_data),f=b.page.next,a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.hasMoreData=function(){return!!f}}]).controller("MyBankCardManageCtrl",["$scope","$http","$interval","$state","Resource","security","appFunc",function(a,b,c,d,e,f,g){function h(){var b={BankCard:{bank_id:a.bankInfo.bankname,bank_name:a.regText.username,bank_branch:a.regText.subbranch,bank_code:a.regText.bank_code,bank_type:"2",bank_identity:"",is_default:"0"}};e.createBankCard(b).then(function(a){d.go("tab.mybankcardmessage")},function(a){g.alert(a.msg)})}function i(){var b=60;a.text=b+"秒后重新获取",timer=c(function(){b--,a.text=b+"秒后重新获取",0==b&&(c.cancel(timer),a.text="获取验证码",a.flag=!0)},1e3)}function j(){var b={User:{sms:a.regText.sms}};e.validateBankCardCode(b).then(function(a){1==a.status&&d.go("tab.mywallet")},function(a){a.msg?g.alert(a.msg):g.alert("管理银行卡失败")})}a.regText={username:"",bank_code:"",sms:"",key:"",chk:!1},a.bankInfo={bankname:""},a.phone="",a.text="获取验证码",a.flag=!0,a.titleType="",f.getUserInfo().then(function(b){a.loginPhone=b.userInfo.phone}),e.getCash().then(function(b){1==b.data.status&&(a.json=b.data.data[0])},function(a){}),e.getBankList().then(function(b){1==b.data.status&&(a.bankList=b.data.data)},function(a){}),a.signupForm=function(){null==a.bankInfo.bankname||""==a.bankInfo.bankname?g.alert("开户行必须选择"):a.signup_form.subbranch.$error.required?g.alert("开户支行不能为空"):a.signup_form.username.$error.required?g.alert("开户名不能为空"):a.signup_form.bank_code.$error.required?g.alert("卡号不能为空"):isNaN(a.regText.bank_code)?g.alert("卡号只能为数字"):a.regText.chk?a.signup_form.$valid&&h():g.alert('请先查看"银行卡管理协议"并同意')},a.chkBtnShow=!1,a.chkBtnHide=!0,a.signupFormButton=function(){null==a.bankInfo.bankname||""==a.bankInfo.bankname||a.signup_form.subbranch.$error.required||a.signup_form.username.$error.required||a.signup_form.bank_code.$error.required||!a.regText.chk?(a.chkBtnShow=!1,a.chkBtnHide=!0):(a.chkBtnShow=!0,a.chkBtnHide=!1)},a.getCode=function(){0!=a.flag&&e.getBankcardCode().then(function(b){0==b.status?a.flag=!0:(a.flag=!1,i())},function(a){a.msg?g.alert(a.msg):g.alert("获取短信验证码失败")})},a.messageBtnShow=!1,a.messageBtnHide=!0,a.messageFormButton=function(){a.tmm_message_form.sms.$error.required?(a.messageBtnShow=!1,a.messageBtnHide=!0):(a.messageBtnShow=!0,a.messageBtnHide=!1)},a.messageForm=function(){a.tmm_message_form.sms.$error.required&&mobileMessage("验证码不能为空，请输入验证码"),a.tmm_message_form.$valid&&j()}}]).controller("TradeRecordCtrl",["$scope","$http","Resource","tmmCache","autoRefresh",function(a,b,c,d,e){a.list_data=[],a.listNum=0;var f="";a.doRefresh=function(){c.getTradeRecord().then(function(b){a.listNum=b.list_data.length,a.list_data=b.list_data,f=b.page.next,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})},a.doRefresh(),a.loadMore=function(){c.get(f).then(function(b){a.listNum=b.list_data.length,a.list_data=a.list_data.concat(b.list_data),f=b.page.next,a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.hasMoreData=function(){return!!f}}]),angular.module("payment",[]).config(["$stateProvider",function(a){a.state("tab.payment",{url:"/payment",templateUrl:"app/payment/templates/my-payment.html",controller:"PaymentMessageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.paymentmessage",{
cache:!1,url:"/paymentmessage",templateUrl:"app/payment/templates/my-payment-message.html",controller:"PaymentMessageCtrl"})}]).config(["$stateProvider",function(a){a.state("tab.setPassword",{url:"/setPassword/:pwdlink",templateUrl:"app/payment/templates/my-set-password.html",controller:"PaymentPwdCtrl"})}]).controller("PaymentMessageCtrl",["$scope","$http","$ionicHistory","$state","$location","$interval","$state","Resource","appFunc","security",function(a,b,c,d,e,f,d,g,h,i){function j(){g.getPayPasswd().then(function(b){a.info.data=b,a.info.type.status=b.value,a.info.type.value=k[b.value]})}i.getUserInfo().then(function(b){a.loginPhone=b.userInfo.phone}),a.info={},a.info={type:{},data:{}};var k={"-3":"设置支付密码","-2":"设置支付密码","-1":"设置支付密码",0:"设置支付密码",1:"设置支付密码"};a.json={},a.regText={sms:"",key:""},a.text="获取验证码",a.flag=!0,j(),a.showVerifyPhone=function(){g.getIsvalidate().then(function(b){1==b.data.status&&(1==b.data.data.value?d.go("tab.setPassword",{pwdlink:a.info.data.link}):e.path("/paymentmessage"))})},a.goTime=function(){var b=60;a.text=b+"秒后重新获取",timer=f(function(){b--,a.text=b+"秒后重新获取",0==b&&(f.cancel(timer),a.text="获取验证码",a.flag=!0)},1e3)},a.getCode=function(){g.get(a.info.data.sms_link).then(function(b){0==b.status?a.flag=!0:(a.flag=!1,a.goTime())},function(a){a.msg?h.alert(a.msg):h.alert("网络错误")})},a.chkBtnShow=!1,a.chkBtnHide=!0,a.messageFormButton=function(){a.message_form.sms.$error.required?(a.chkBtnShow=!1,a.chkBtnHide=!0):(a.chkBtnShow=!0,a.chkBtnHide=!1)},a.messageForm=function(){a.message_form.sms.$error.required&&mobileMessage("验证码不能为空，请输入验证码"),a.message_form.$valid&&a.submit()},a.submit=function(){var b={Password:{sms:a.regText.sms}};g.post(a.info.data.validate,b).then(function(a){1==a.status&&c.goBack(-3)},function(a){a.msg?h.alert(a.msg):h.alert("网络错误")})}}]).controller("PaymentPwdCtrl",["$scope","$http","$state","$location","$interval","$stateParams","Resource","appFunc",function(a,b,c,d,e,f,g,h){function i(a){function b(a){f.addEventListener("click",function(b){a(b.target.index+1)})}function c(){f.style.transform="translate3d(0, 100%, 0)",f.style.webkitTransform="translate3d(0, 100%, 0)",setTimeout(function(){a.removeChild(f)},250)}var d,e=[],f=document.createElement("div");f.className="keyboard";for(var g=0;g<12;g++)d=document.createElement("span"),d.index=g,e.push(d),d.className="keyboard-item",f.appendChild(d);return a.appendChild(f),setTimeout(function(){f.style.transform="translate3d(0, 0, 0)",f.style.webkitTransform="translate3d(0, 0, 0)"},0),{cancel:c,getTap:b}}function j(){n="",o="";var a=document.getElementById("tmm-payment-setpwd"),b=i(a);b.getTap(function(a){k(a)})}function k(a){n.length>=6?12==a&&(n=n.substr(0,n.length-1),r<n.length?(document.getElementsByClassName("passwd-item")[r].className="passwd-item pwd-input",r++):r>0&&(r--,document.getElementsByClassName("passwd-item")[r].className="passwd-item")):(11==a?n+=0:12==a?n=n.substr(0,n.length-1):10==a||(n+=a),r<n.length?(document.getElementsByClassName("passwd-item")[r].className="passwd-item pwd-input",r++):r>0&&(r--,document.getElementsByClassName("passwd-item")[r].className="passwd-item")),l()}function l(){if(1==p){if(6==n.length){o=n,n="",r=0,k(10),p=2;for(var a=0;a<document.getElementsByClassName("passwd-item").length;a++)document.getElementsByClassName("passwd-item")[a].className="passwd-item";document.getElementById("passwd-msg").innerText="请再次输入支付密码",document.getElementById("passwd-button-hide").style.display="block"}}else 6==n.length?(document.getElementById("passwd-button-show").style.display="block",document.getElementById("passwd-button-hide").style.display="none"):(document.getElementById("passwd-button-show").style.display="none",document.getElementById("passwd-button-hide").style.display="block")}function m(){r=0,n="",o="",p=1;for(var a=0;a<document.getElementsByClassName("passwd-item").length;a++)document.getElementsByClassName("passwd-item")[a].className="passwd-item";document.getElementById("passwd-msg").innerText="请输入支付密码",document.getElementById("passwd-button-show").style.display="none",document.getElementById("passwd-button-hide").style.display="none",k(10)}var n="",o="",p=1,q=f.pwdlink;j();var r=0;a.confirmPasswd=function(){if(n==o){var a={Password:{_pwd:o,_confirm_pwd:n}};g.post(q,a).then(function(a){1==a.status&&d.path("/payment")},function(a){a.msg?(m(),h.alert(a.msg)):h.alert("网络错误")})}else m(),h.alert("两次密码输入不一致，请重新输入")}}]),angular.module("mypraise",[]).config(["$stateProvider",function(a){a.state("tab.mypraise",{url:"/mypraise",templateUrl:"app/mypraise/templates/my-praise.html",controller:"MyPraiseCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.mypraise"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getMyPraise()}]}})}]).controller("MyPraiseCtrl",["$scope","$http","$ionicHistory","$rootScope","modify","data","Resource","autoRefresh",function(a,b,c,d,e,f,g,h){function i(){g.getMyPraise().then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.model.nextPage="",a.$broadcast("scroll.refreshComplete")})}a.model={nextPage:"",list_data:[]},a.model.nextPage=f.page.next,a.model.list_data=f.list_data,a.$on("$ionicView.enter",function(){e.ismodify&&(i(),e.ismodify=!1)}),a.doRefresh=function(){i()},a.loadMore=function(){a.model.nextPage&&g.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})}}]).directive("praiseItem",function(){return{restrict:"E",replace:!0,templateUrl:"app/mypraise/templates/my-praise-item.html"}}),angular.module("myorder",[]).config(["$stateProvider",function(a){a.state("tab.myorder",{url:"/myorder",templateUrl:"app/myorder/templates/my-order.html",controller:"MyOrderCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","orderType",function(a,b,c,d,e){if(null==d.backView()||"tab.myorder"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getOrderList(e.myorder)}]}})}]).config(["$stateProvider",function(a){a.state("tab.myorderdetail_1",{url:"/myorderdetail_1/:link",templateUrl:"app/myorder/templates/my-dot-order-detail.html",controller:"OrderDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),isNaN(Number(b.link))?a.get(b.link):a.getOrderPayDetail(b.link)}]}})}]).config(["$stateProvider",function(a){a.state("tab.myorderdetail_2",{url:"/myorderdetail_2/:link",templateUrl:"app/myorder/templates/my-line-order-detail.html",controller:"OrderDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),isNaN(Number(b.link))?a.get(b.link):a.getOrderPayDetail(b.link)}]}})}]).config(["$stateProvider",function(a){a.state("tab.myorderdetail_3",{url:"/myorderdetail_3/:link",templateUrl:"app/myorder/templates/my-line-order-detail.html",controller:"OrderDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),isNaN(Number(b.link))?a.get(b.link):a.getOrderPayDetail(b.link)}]}})}]).config(["$stateProvider",function(a){a.state("tab.myorderdetail_4",{url:"/myorderdetail_4/:link",templateUrl:"app/myorder/templates/my-line-order-detail.html",controller:"OrderDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){return c.show({template:"玩命加载中...",hideOnStateChange:!0}),isNaN(Number(b.link))?a.get(b.link):a.getOrderPayDetail(b.link)}]}})}]).controller("MyOrderCtrl",["$scope","$ionicScrollDelegate","$ionicLoading","orderType","data","Resource","appFunc","payFunc","device","ENV",function(a,b,c,d,e,f,g,h,i,j){function k(){f.getOrderList(l).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}var l=d.myorder;a.isActive="order_dot_thrand"==l?1:2,a.model={nextPage:e.page.next,list_data:e.list_data},a.showTab=function(c){a.isActive!=c&&(a.isActive=c,1==c?d.myorder=l="order_dot_thrand":2==c&&(d.myorder=l="order_tour"),a.doRefresh(),b.scrollTo(0,0,!0))},a.doRefresh=function(){k()},a.loadMore=function(){a.model.nextPage&&f.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.model.nextPage="",a.$broadcast("scroll.infiniteScrollComplete")})},a.orderCancle=function(a){g.confirm("确定取消吗？",function(){f.orderCancle(a).then(function(a){c.show({template:"取消成功",duration:600}),k()},function(a){g.alert("取消失败")})})},a.$on("wxPay",function(a,b){k()}),a.orderPay=function(a,b,c){h.payOrder(a,b,c,function(a){try{if(j.iOS)connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{PayCode:a.alipay},function(a){})});else if(j.android){window.jsObj.payMoney(a.alipay)}}catch(b){}k()},function(a){g.alert("网络超时，请重试")},function(a){k()})},a.refund=function(){i.tmmWxCallPhone("400-019-7090")}}]).controller("OrderDetailCtrl",["$scope","$stateParams","$ionicModal","appFunc","QRCode","Resource","data","payFunc","ENV",function(a,b,c,d,e,f,g,h,i){a.actback=0,"actOrder"==b.actOrder&&(a.actback=1),a.model=g,a.hasRetinue=0;for(var j=0;j<g.retinue.length;j++)if(0==g.retinue[j].is_main){a.hasRetinue=1;break}c.fromTemplateUrl("app/myorder/templates/qr-code.html",{scope:a}).then(function(b){a.modal=b}),a.$on("$destroy",function(){a.modal.remove()}),a.showCode=function(b,c){1==c&&f.get(b).then(function(b){var c=b.barcode.value,f=d.toFormatNum(c),g=a.modal.el.querySelector(".qr-code"),h=a.modal.el.querySelector(".csu-code");g.innerHTML="";var i=new e(g,{width:.6*window.innerWidth,height:.6*window.innerWidth});i.makeCode(c),h.innerHTML="消费码："+f,a.modal.show()},function(a){})},a.$on("wxPay",function(c,d){f.get(b.link).then(function(b){a.model=b})}),a.orderPay=function(c,e){h.payOrder(c,a.model.status.order_type.value,e,function(c){try{if(i.iOS)connectWebViewJavascriptBridge(function(a){a.callHandler("ObjcCallback",{PayCode:c.alipay},function(a){})});else if(i.android){window.jsObj.payMoney(c.alipay)}}catch(d){}f.get(b.link).then(function(b){a.model=b})},function(a){d.alert("网络超时，请重试")},function(c){f.get(b.link).then(function(b){a.model=b})})}}]).factory("orderType",function(){return{joinact:1,myorder:"order_dot_thrand"}}).directive("orderItem",function(){return{restrict:"E",replace:!0,templateUrl:"app/myorder/templates/my-order-item.html"}}),angular.module("myjoinact",[]).config(["$stateProvider",function(a){a.state("tab.myjoinact",{url:"/myjoinact",templateUrl:"app/myjoinact/templates/my-join-act.html",controller:"MyJoinActCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","orderType",function(a,b,c,d,e){if(null===d.backView()||"tab.myjoinact"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getJoinActList(e.joinact)}]}}).state("tab.myjoinactdetail",{url:"/myjoinactdetail/:link",templateUrl:"app/myjoinact/templates/my-joinact-detail.html",controller:"MyJoinActDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory","orderType",function(a,b,c,d,e){if(null===d.backView()||"tab.myjoinactdetail"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}})}]).controller("MyJoinActCtrl",["$scope","$ionicScrollDelegate","$ionicPopover","$filter","$ionicLoading","orderType","data","Resource","autoRefresh","appFunc","modify","payFunc","uiCalendar","device","ENV",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){h.getJoinActList(q).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}var q=f.joinact;a.isPayType=q,a.model={nextPage:"",list_data:[]},a.model.nextPage=g.page.next,a.model.list_data=g.list_data,c.fromTemplateUrl("app/myjoinact/templates/my-joinact-actType.html",{scope:a}).then(function(b){a.popover=b}),a.openPopover=function(b){a.popover.show(b)},a.showTab=function(c){a.isPayType!=c&&(a.isPayType=c,1==c?f.joinact=q=1:2==c&&(f.joinact=q=2),a.popover.hide(),a.doRefresh(),b.scrollTo(0,0,!0))},a.$on("$ionicView.enter",function(){k.ismodify&&(p(),k.ismodify=!1)}),a.doRefresh=function(){p()},a.loadMore=function(){a.model.nextPage&&h.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.model.nextPage="",a.$broadcast("scroll.infiniteScrollComplete")})},a.orderCancle=function(a){j.confirm("确定取消报名吗？",function(){h.orderCancle(a).then(function(a){e.show({template:"取消报名成功",duration:600}),p()},function(a){j.alert("取消报名失败")})})},a.$on("wxPay",function(a,b){p()}),a.orderPay=function(a,b,c){l.payOrder(a,b,c,function(a){try{if(o.iOS)connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{PayCode:a.alipay},function(a){})});else if(o.android){window.jsObj.payMoney(a.alipay)}}catch(b){}p()},function(a){j.alert("网络超时，请重试")},function(a){p()})},a.orderEnterCancle=function(a){j.confirm("确定取消报名吗？",function(){h.orderEnterCancle(a).then(function(a){1==a.status?(e.show({template:"取消报名成功",duration:600}),p()):j.alert("取消报名失败")},function(a){j.alert("取消报名失败")})})},a.orderTourConfirm=function(a){j.confirm("确认出游吗",function(){h.tourConfirm(a).then(function(a){e.show({template:"确认出游成功",duration:600}),p()},function(a){j.alert("确认出游失败")})})},a.setGoTime=function(a){m.show({selected:function(b){var c=d("date")(b[0],"yyyy-MM-dd");j.confirm("出游日期确认为："+c,function(){var b={Actives:{go_time:c}};h.post(a,b).then(function(a){e.show({template:"出游日期确认成功",duration:600}),p()},function(a){j.alert(a.msg)})})},minDate:new Date(Date.now()+864e5),num:1})},a.refund=function(){n.tmmWxCallPhone("400-019-7090")}}]).directive("joinactItem",function(){return{restrict:"E",replace:!1,templateUrl:"app/myjoinact/templates/my-joinact-item.html"}}).controller("MyJoinActDetailCtrl",["$scope","$http","$ionicHistory","$ionicLoading","data","Resource","appFunc","security","modify",function(a,b,c,d,e,f,g,h,i){function j(){""!=l?a.loadmore=!0:a.loadmore=!1}a.model=e,a.selType=1;var k=(e.actives_id,"");a.orderModel=null,a.orderListModel=null;var l="";a.loadmore=!1,h.getUserInfo().then(function(b){a.userInfo=b.userInfo}),"1"==e.is_me&&(k=e.actives_info.attend_list),null==a.orderListModel&&""!=k&&f.get(k).then(function(b){a.orderModel=b,a.orderListModel=b.list_data,l=b.page.next},function(a){}),a.showTabs=function(b){a.selType!=b&&(a.selType=b,2==b&&j())},a.loadMoreParticipant=function(){l&&f.get(l).then(function(b){l=b.page.next,a.orderListModel=a.orderListModel.concat(b.list_data)},function(a){}),j()},a.orderEnterCancle=function(a){g.confirm("确定取消报名吗？",function(){f.orderEnterCancle(a).then(function(a){1==a.status?(i.ismodify=!0,d.show({template:"取消报名成功",duration:600}),c.goBack()):g.alert("取消报名失败")},function(a){g.alert("取消报名失败")})})}}]),angular.module("mycreateact",["mycreateactdetail","mysponsoract"]).config(["$stateProvider",function(a){a.state("tab.mycreateact",{url:"/mycreateact",templateUrl:"app/mycreateact/templates/my-create-act.html",controller:"MyCreateActCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.mycreateact"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.getCreateActList()}]}}).state("tab.createactpay",{url:"/createactpay/:link/:orderlink/:orderid/:ordertype/:gotime",templateUrl:"app/mycreateact/templates/my-createact-pay.html",controller:"CreateActCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.createactpay"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.participant",{url:"/participant/:link",templateUrl:"app/mycreateact/templates/my-participant.html",controller:"Participant",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null==d.backView()||"tab.participant"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}})}]).controller("MyCreateActCtrl",["$scope","$http","$ionicHistory","$filter","$ionicLoading","data","Resource","autoRefresh","appFunc","payFunc","uiCalendar","modify","device",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){g.getCreateActList().then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}function o(a){var b={actives_thrand:0,is_insurance:1,shops_info:"",Actives:{actives_type:0,tour_type:1,number:0,price:0,tour_price:0,remark:"",start_time:"",end_time:"",go_time:"",is_organizer:1,is_open:1,pay_type:0},Shops:{name:""},Pro:{},ProFare:{}};b.actives_thrand=a.thrand_id,b.Actives.number=a.actives_info.number.value,b.Actives.tour_price=a.actives_info.tour_price.value,b.Actives.start_time=a.actives_time.start_time,b.Actives.end_time=a.actives_time.end_time,b.Actives.is_organizer=a.is_organizer.value,b.Actives.is_open=a.actives_is_open.value,b.Actives.pay_type=a.actives_pay_type.value,"出游日期未定"==a.actives_time.go_time?b.Actives.go_time="":b.Actives.go_time=a.actives_time.go_time,b.Actives.remark=a.actives_info.remark,b.Shops.name=a.name;var c=a.actives_id;g.editActInfo(c,b).then(function(a){1==a.status&&(e.show({template:"觅趣提交审核成功",duration:600}),n())},function(a){i.alert(a.msg)})}a.model={nextPage:"",list_data:[]},a.model.nextPage=f.page.next,a.model.list_data=f.list_data,a.$on("$ionicView.enter",function(){l.ismodify&&(n(),l.ismodify=!1)}),a.doRefresh=function(){n()},a.loadMore=function(){a.model.nextPage&&g.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.model.nextPage="",a.$broadcast("scroll.infiniteScrollComplete")})},a.reviewAct=function(a){g.get(a).then(function(a){o(a)},function(a){})},a.setGoTime=function(a){k.show({selected:function(b){var c=d("date")(b[0],"yyyy-MM-dd");i.confirm("出游日期确认为："+c,function(){var b={Actives:{go_time:c}};g.post(a,b).then(function(a){e.show({template:"出游日期确认成功",duration:600}),n()},function(a){i.alert(a.msg)})})},minDate:new Date(Date.now()+864e5),num:1})},a.cancelAct=function(){m.tmmWxCallPhone("400-019-7090")}}]).directive("createactItem",function(){return{restrict:"E",replace:!0,templateUrl:"app/mycreateact/templates/my-createact-item.html"}}).controller("CreateActCtrl",["$scope","$http","$ionicHistory","$stateParams","$ionicPopup","$location","$state","$filter","data","Resource","appFunc","payFunc","security","uiCalendar","backStep","modify","ENV",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(){j.get(d.link).then(function(b){a.model=b})}function s(a){var b=0;for(var c in a)for(var d in a[c])for(var e in a[c][d])if("1"===a[c][d][e].classliy.value||"3"===a[c][d][e].classliy.value)for(var f in a[c][d][e].fare)"成人"==a[c][d][e].fare[f].info?a[c][d][e].fare[f].number=i.actives_info.attend.people:"儿童"==a[c][d][e].fare[f].info&&(a[c][d][e].fare[f].number=i.actives_info.attend.children),a[c][d][e].fare[f].count=a[c][d][e].fare[f].number*a[c][d][e].fare[f].price,b+=a[c][d][e].fare[f].count;else if("2"===a[c][d][e].classliy.value)for(var f in a[c][d][e].fare)a[c][d][e].fare[f].number=Math.ceil(i.actives_info.attend.people/a[c][d][e].fare[f].room_number),a[c][d][e].fare[f].count=a[c][d][e].fare[f].number*a[c][d][e].fare[f].price,b+=a[c][d][e].fare[f].count;return b+=i.actives_info.tour_price.value*i.actives_info.attend.number,b.toFixed(2)}function t(a,b){p.ismodify=!0,l.payOrder(a,4,b,function(a){try{if(q.iOS)connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{PayCode:a.alipay},function(a){})});else if(q.android){window.jsObj.payMoney(a.alipay)}}catch(b){}},function(a){k.alert("网络超时，请重试")},function(a){g.go("tab.myorderdetail_4",{link:a.status.type.link,actOrder:"actOrder"}).then(function(){o.step=-2})})}a.model=i,m.getUserInfo().then(function(b){a.userInfo=b.userInfo}),a.total_price=s(i.items_fare);var u=d.orderlink,v=(d.orderid,d.ordertype);a.gotime=i.actives_time.go_time;var w=i.actives_info.attend.main.name;1==i.actives_time.go_time_value?a.gotime_value=1:a.gotime_value=0,a.selectDate=function(){n.show({selected:function(b){a.gotime=h("date")(b[0],"yyyy-MM-dd")},minDate:new Date,num:1})},a.setMainName=function(){e.prompt({title:"请输入联系人姓名",cancelText:"取消",inputType:"text",okText:"确认",cssClass:"tmm-ionic-prompt"}).then(function(a){a&&j.post(i.actives_info.attend.main.link,{Attend:{name:a}}).then(function(b){w=a,r()},function(a){k.alert(a.msg)})})},a.actOrderPay=function(){var b={Order:{order_price:a.total_price,go_time:a.gotime},OrderShops:{shops_id:i.actives_id},Attend:{name:w}};if(1==v)t(a.model.actives_info.order.value,a.total_price);else if(0==v){if("出游日期未定"==a.gotime)return void k.alert("请设置出游时间");j.post(u,b).then(function(b){v=1,j.get(d.link).then(function(b){a.model=b}),t(b.id.value,a.total_price)},function(a){k.alert(a.msg)})}},a.$on("wxPay",function(a,b){c.goBack()})}]).controller("Participant",["$scope","$http","$ionicHistory","$stateParams","data","Resource","appFunc",function(a,b,c,d,e,f,g){function h(){f.get(d.link).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=b.list_data,a.$broadcast("scroll.refreshComplete")},function(b){a.$broadcast("scroll.refreshComplete")})}a.model={nextPage:"",list_data:[]},a.model.nextPage=e.page.next,a.model.list_data=e.list_data,a.doRefresh=function(){h()},a.loadMore=function(){a.model.nextPage&&f.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})}}]).directive("participantItem",function(){return{restrict:"E",replace:!0,templateUrl:"app/mycreateact/templates/my-participant-item.html"}}),angular.module("mycreateactdetail",[]).config(["$stateProvider",function(a){a.state("tab.mycreateactdetail",{url:"/mycreateactdetail/:link",templateUrl:"app/mycreateact/templates/my-createact-detail.html",controller:"MyCreateActDetailCtrl",resolve:{data:["Resource","$stateParams","$ionicLoading","$ionicHistory",function(a,b,c,d){if(null===d.backView()||"tab.mycreateactdetail"!==d.backView().stateName)return c.show({template:"玩命加载中...",hideOnStateChange:!0}),a.get(b.link)}]}}).state("tab.editactname",{url:"/editactname/:actname/:actid",templateUrl:"app/mycreateact/templates/edit-act-name.html",controller:"MyActEditCtrl"}).state("tab.editactnum",{url:"/editactname/:actnum/:actid",templateUrl:"app/mycreateact/templates/edit-act-num.html",controller:"MyActEditCtrl"}).state("tab.edittourprice",{url:"/edittourprice/:tourprice/:actid",templateUrl:"app/mycreateact/templates/edit-tour-price.html",controller:"MyActEditCtrl"})}]).controller("MyCreateActDetailCtrl",["$scope","$http","$ionicActionSheet","$filter","$sce","$stateParams","$ionicPopup","$ionicLoading","data","modify","Resource","appFunc","uiCalendar","security","device","ENV",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){function q(){k.get(f.link).then(function(b){a.model=b,a.model.actives_info.remark=e.trustAsHtml(a.model.actives_info.remark)})}function r(){""!=v?a.loadmore=!0:a.loadmore=!1}function s(){setTimeout(function(){o.share(a.model.name,y,a.model.image,x)},250)}a.model=i,a.selType=1;var t=i.actives_id,u=null;a.orderModel=null,a.orderListModel=null;var v="";a.loadmore=!1,a.detailLink=f.link;var w=i.actives_info.remark;a.model.actives_info.remark=e.trustAsHtml(a.model.actives_info.remark),n.getUserInfo().then(function(b){a.userInfo=b.userInfo}),a.$on("$ionicView.enter",function(){j.ismodify&&(""!=j.modifydate.actname&&(a.model.name=j.modifydate.actname),""!=j.modifydate.actnum&&(a.model.actives_info.number.value=j.modifydate.actnum),""!=j.modifydate.tourprice&&(a.model.actives_info.tour_price.value=j.modifydate.tourprice),""!=j.modifydate.changeline&&q())}),"1"===i.actives_pay_type.value?u=i.actives_info.attend_list:"0"===i.actives_pay_type.value&&(u=i.actives_info.order_list),Boolean(u)?k.get(u).then(function(b){a.orderModel=b,a.orderListModel=b.list_data,v=b.page.next,a.participantNum=1},function(a){}):a.participantNum=0,a.showTabs=function(b){a.selType!=b&&(a.selType=b,2==b&&r())},a.loadMoreParticipant=function(){v&&k.get(v).then(function(b){v=b.page.next,a.orderListModel=a.orderListModel.concat(b.list_data)},function(a){}),r()},a.deletePepole=function(b,c){l.confirm("确认删除所有参与人吗?",function(){k.get(b).then(function(b){a.orderListModel.splice(c,1),h.show({template:"删除成功",duration:600})},function(a){})})},a.reviewAct=function(){var a=i,b={actives_thrand:0,is_insurance:1,shops_info:"",Actives:{actives_type:0,tour_type:1,number:0,price:0,tour_price:0,remark:"",start_time:"",end_time:"",go_time:"",is_organizer:1,is_open:1,pay_type:0},Shops:{name:""},Pro:{},ProFare:{}};b.actives_thrand=a.thrand_id,b.Actives.number=a.actives_info.number.value,b.Actives.tour_price=a.actives_info.tour_price.value,b.Actives.start_time=a.actives_time.start_time,b.Actives.end_time=a.actives_time.end_time,b.Actives.is_organizer=a.is_organizer.value,b.Actives.is_open=a.actives_is_open.value,b.Actives.pay_type=a.actives_pay_type.value,"出游日期未定"==a.actives_time.go_time?b.Actives.go_time="":b.Actives.go_time=a.actives_time.go_time,b.Actives.remark=w,b.Shops.name=a.name;var c=a.actives_id;k.editActInfo(c,b).then(function(a){1==a.status&&(h.show({template:"觅趣提交审核成功",duration:600}),j.ismodify=!0,q())},function(a){l.alert(a.msg)})},a.editPayType=function(){c.show({buttons:[{text:"自费"},{text:"代付"}],destructiveText:"取消",titleText:"选择付款方式",cssClass:"tmm-action-sheet",destructiveButtonClicked:function(){return!0},buttonClicked:function(b){var c={Actives:{pay_type:b}};return k.editPayType(c,t).then(function(c){h.show({template:"修改付款方式成功",duration:600}),a.model.actives_pay_type.value=b},function(a){l.alert(a.msg)}),!0}})},a.editActOpen=function(){c.show({buttons:[{text:"私密"},{text:"公开"}],destructiveText:"取消",titleText:"选择觅趣公开性",cssClass:"tmm-action-sheet",destructiveButtonClicked:function(){return!0},buttonClicked:function(b){var c={Actives:{is_open:b}};return k.editActOpen(c,t).then(function(c){h.show({template:"修改觅趣公开性成功",duration:600}),a.model.actives_is_open.value=b},function(a){l.alert(a.msg)}),!0}})},a.setActGoTime=function(){m.show({selected:function(b){var c=d("date")(b[0],"yyyy-MM-dd");l.confirm("出游日期确认为："+c,function(){var b={Actives:{go_time:c}};k.editActGotime(b,t).then(function(b){h.show({template:"出游日期确认成功",duration:600}),a.model.actives_time.go_time=c,j.ismodify=!0},function(a){l.alert(a.msg)})})},minDate:new Date(Date.now()+864e5),num:1})},a.editEnrolldate=function(){m.show({selected:function(b){var c=d("date")(b[0],"yyyy-MM-dd"),e=d("date")(b[1],"yyyy-MM-dd");l.confirm("报名日期确认为："+c+"至"+e,function(){var b={Actives:{start_time:c,end_time:e}};k.editEnrolldate(b,t).then(function(b){h.show({template:"修改报名日期成功",duration:600}),a.model.actives_time.start_time=c,a.model.actives_time.end_time=e},function(a){l.alert(a.msg)})})},minDate:new Date,num:2})};var x=a.model.list_info?a.model.list_info:"来自田觅觅的觅趣分享",y=p.apiEndpoint+"/index.php?r=site/share&share="+a.model.shops.value;a.shareFriend=function(){"weixin"===p.device?g.alert({title:"点击右上角分享邀请好友",okText:"取消",cssClass:"tmm-ionic-alert sharebg"}):o.shareMsg(a.model.name,x,a.model.image,y)},"weixin"===p.device&&s()}]).controller("MyActEditCtrl",["$scope","$stateParams","$ionicHistory","$ionicLoading","modify","Resource","appFunc",function(a,b,c,d,e,f,g){a.name=b.actname,a.num=b.actnum,a.tourprice=b.tourprice;var h=b.actid;a.model={editactname:"",editactnum:"",edittourprice:""},a.editName=function(){if(""==a.model.editactname)return void g.alert("觅趣名称不能为空");var b={Shops:{name:a.model.editactname}};f.editActName(b,h).then(function(b){d.show({template:"修改觅趣名称成功",duration:600}),e.ismodify=!0,e.modifydate.actname=a.model.editactname,c.goBack()},function(a){g.alert(a.msg)})},a.editNum=function(){if(""==a.model.editactnum)return void g.alert("觅趣参与人数不能为空");var b={Actives:{number:a.model.editactnum}};f.editActNum(b,h).then(function(b){d.show({template:"修改觅趣参与人数成功",duration:600}),e.ismodify=!0,e.modifydate.actnum=a.model.editactnum,c.goBack()},function(a){g.alert(a.msg)})},a.editTourPrice=function(){if(""==a.model.edittourprice)return void g.alert("服务费不能为空");var b={Actives:{tour_price:a.model.edittourprice}};f.editTourPrice(b,h).then(function(b){d.show({template:"修改服务费成功",duration:600}),e.ismodify=!0,e.modifydate.tourprice=a.model.edittourprice,c.goBack()},function(a){g.alert(a.msg)})}}]),angular.module("mysponsoract",[]).config(["$stateProvider",function(a){a.state("tab.mysponsoract_1",{url:"/mysponsoract_1",templateUrl:"app/mycreateact/templates/mysponsoract_1.html",controller:"SponsorAct_1_Ctrl"}).state("tab.mysponsoract_2",{url:"/mysponsoract_2/:type/:actId/:actDetailLink",templateUrl:"app/mycreateact/templates/mysponsoract_2.html",controller:"SponsorAct_2_Ctrl"}).state("tab.mysponsoract_3",{url:"/mysponsoract_3",templateUrl:"app/mycreateact/templates/mysponsoract_3.html",controller:"SponsorAct_3_Ctrl"}).state("tab.mysponsoract_4",{url:"/mysponsoract_4",templateUrl:"app/mycreateact/templates/mysponsoract_4.html",controller:"SponsorAct_4_Ctrl"})}]).controller("SponsorAct_1_Ctrl",["$scope","$state","$filter","sponsorData","appFunc","uiCalendar",function(a,b,c,d,e,f){var g=f.show({contrainer:document.querySelector(".mysponsoract .calendar"),selected:function(a){d.go_time=a[0]},minDate:new Date(Date.now()+864e5),num:1});a.nextStep=function(){d.go_time?b.go("tab.mysponsoract_2"):e.tipMsg("请选择出游日期")},a.skipStep=function(){d.go_time="",g.clearDate(),b.go("tab.mysponsoract_2")}}]).controller("SponsorAct_2_Ctrl",["$scope","$state","$ionicPopover","$stateParams","modify","appFunc","API","Resource","autoRefresh","modify","sponsorData",function(a,b,c,d,e,f,g,h,i,e,j){function k(){h.get(l).then(function(b){a.model=b,a.model.nextPage=b.page.next,a.$broadcast("scroll.refreshComplete"),a.noData=!a.model.list_data.length,j.id=null},function(b){a.$broadcast("scroll.refreshComplete")})}var l=g.journey_index;a.isDistance=!0,a.checkedItem=null,a.isReplaceStroke=d.type,a.selectType="按人气",a.selectLeft=!0;var m=d.actId,n=d.actDetailLink;k();var o='<ion-popover-view class="mysponsoract-popular"><div class="tit" ng-click="selectedPopuler(1)">按人气</div><div class="tit" ng-click="selectedPopuler(2)">按距离</div></ion-popover-view>';a.popover=c.fromTemplate(o,{scope:a}),a.$on("$destroy",function(){a.popover.remove()}),a.$on("$ionicView.enter",function(){e.ismodify&&(l=g.journey_index,i.start("journey-content"),e.ismodify=!1)}),a.selectPopular=function(b){a.popover.show(b)},a.selectedPopuler=function(b){1==b?(a.selectType="按人气",l=g.journey_popular,i.start("journey-content"),a.isDistance=!1):2==b&&(a.selectType="按距离",l=g.journey_index,i.start("journey-content"),a.isDistance=!0),a.selectLeft=!1,a.popover.hide()},a.doRefresh=function(){k()},a.loadMore=function(){a.model.nextPage&&h.get(a.model.nextPage).then(function(b){a.model.nextPage=b.page.next,a.model.list_data=a.model.list_data.concat(b.list_data),a.$broadcast("scroll.infiniteScrollComplete")},function(b){a.$broadcast("scroll.infiniteScrollComplete")})},a.selectItem=function(a){j.id=a},a.nextStep=function(){return j.id?void b.go("tab.mysponsoract_3"):void f.tipMsg("请选择行程")},a.changeLine=function(){if(!j.id)return void f.tipMsg("请选择行程");var a={actives_thrand:j.id};h.changeLine(a,m).then(function(a){f.alert("修改觅趣线路成功"),
e.ismodify=!0,e.modifydate.changeline="changeline",b.go("tab.mycreateactdetail",{link:n})},function(a){f.alert(a.msg)})}}]).controller("SponsorAct_3_Ctrl",["$scope","$state","sponsorData",function(a,b,c){c.id||b.go("tab.my"),a.selectPayType=function(a){c.pay_type=a,b.go("tab.mysponsoract_4")}}]).controller("SponsorAct_4_Ctrl",["$scope","$state","$filter","$ionicHistory","modify","appFunc","uiCalendar","Resource","sponsorData","security",function(a,b,c,d,e,f,g,h,i,j){function k(){if(!a.model.name)return f.tipMsg("觅趣名称不能为空"),!1;if(!m||!l)return f.tipMsg("请选择觅趣开始和结束时间"),!1;if(!a.model.number)return f.tipMsg("觅趣参与人数不能为空"),!1;if(a.model.userInfo.is_organizer&&"0"!==a.model.userInfo.organizer.status){if(!a.model.tour_price)return f.tipMsg("服务费不能为空"),!1}else a.model.tour_price="0.00";return!0}i.id&&void 0!==i.pay_type||b.go("tab.my");var l,m,n=i.go_time;a.model={},j.getUserInfo().then(function(b){a.model.userInfo=b.userInfo}),a.selectedDate=function(){g.show({selected:function(b){return i.go_time&&i.go_time.getTime()<b[0].getTime()?void f.tipMsg("报名开始日期必须小于出游日期"):(l=b[0],m=b[1],void(a.model.time=c("date")(l,"yyyy.MM.dd")+"-"+c("date")(m,"yyyy.MM.dd")))},minDate:new Date,num:2})},a.submit=function(){if(k()){var b={actives_thrand:i.id,is_insurance:1,shops_info:"",Actives:{actives_type:0,tour_type:1,number:a.model.number,price:0,tour_price:a.model.tour_price,remark:a.model.remark,start_time:c("date")(l,"yyyy-MM-dd"),end_time:c("date")(m,"yyyy-MM-dd"),go_time:n?c("date")(n,"yyyy-MM-dd"):"",is_organizer:a.model.userInfo.is_organizer,is_open:Number(!a.model.is_close),pay_type:i.pay_type},Shops:{name:a.model.name},Pro:{},ProFare:{}};h.createAct(b).then(function(a){f.alert("创建成功！").then(function(){d.goBack(-4),e.ismodify=!0})},function(a){f.tipMsg(a.msg,1500)})}}}]).factory("sponsorData",function(){return{}}),angular.module("security",[]).factory("security",["$q","$rootScope","$ionicModal","$http","$interval","appFunc","ENV",function(a,b,c,d,e,f,g){var h={currentUser:null,userInfo:null,getUserInfo:function(){return null!==h.userInfo?a.when(h.userInfo):d.get(g.apiEndpoint+"/index.php?r=api/user/view").then(function(b){return 1==b.data.status?(h.userInfo=b.data.data,h.userInfo):(h.login(),a.reject({code:"2",msg:"您没有登录"}))})},login:function(a){function i(){e.cancel(j),k.disable=!0;var a=60;k.txt=a+"秒后重试",j=e(function(){k.txt=--a+"秒后重试",0===a&&(e.cancel(j),k.txt="获取验证码",k.disable=!1,j=null)},1e3)}var j=null,k=b.$new(!0);k.isAccLogin=!0,k.title="帐号密码登录",k.txt="获取验证码",k.disable=!1,k.accModel={phone:"",password:""},k.mobModel={phone:"",code:""},k.loginStyle={top:window.innerHeight-48+"px"},c.fromTemplateUrl("app/common/templates/login.html",{scope:k,animation:"slide-in-up"}).then(function(a){k.modal=a,k.modal.show()}),b.$on("$stateChangeSuccess",function(){k.cancel()}),k.cancel=function(){k.modal.remove(),k.$destroy(),e.cancel(j)},k.showLogin=function(a){1===a?(k.isAccLogin=!0,k.title="帐号密码登录"):(k.isAccLogin=!1,k.title="手机号快捷登录")},k.accLogin=function(){var c=g.apiEndpoint+"/index.php?r=api/login/index",e={UserLoginForm:{phone:k.accModel.phone,password:k.accModel.password}};return""===k.accModel.phone?void f.alert("手机号码不能为空"):""===k.accModel.password?void f.alert("密码不能为空"):f.isPhone(k.accModel.phone)?f.validatePassword(k.accModel.password)?void d.get(c+"&csrf=csrf").success(function(g){e.TMM_CSRF=g.data.csrf.TMM_CSRF,d.post(c,e).success(function(c){if(1==c.status)h.currentUser=c.data,b.$broadcast("getUserInfo",h.currentUser),a&&a(h.currentUser),k.cancel();else{if(c.form)for(var d in c.form)return void f.alert(c.form[d]);f.alert("网络连接错误")}}).error(function(a){f.alert("网络连接错误")})}):void f.alert("密码必须有数字和字母组合"):void f.alert("手机号码格式不对")},k.getMsgCode=function(){if(null===j){if(!k.mobModel.phone)return void f.alert("手机号码不能为空");if(!f.isPhone(k.mobModel.phone))return void f.alert("手机号码格式不对");var a=g.apiEndpoint+"/index.php?r=api/login/captcha_sms",b={phone:k.mobModel.phone};d.get(a+"&csrf=csrf").success(function(c){1==c.status&&(b.TMM_CSRF=c.data.csrf.TMM_CSRF,d.post(a,b).success(function(a){if(1==a.status)i();else{if(a.form)for(var b in a.form)return void f.alert(a.form[b]);f.alert("网络连接错误")}}).error(function(){f.alert("网络连接错误")}))}).error(function(){f.alert("网络连接错误")})}},k.mobLogin=function(){if(!k.mobModel.phone)return void f.alert("手机号码不能为空");if(!f.isPhone(k.mobModel.phone))return void f.alert("手机号码格式不对");if(!k.mobModel.code)return void f.alert("验证码不能为空");var c=g.apiEndpoint+"/index.php?r=api/login/login_sms",e={UserSmsLoginForm:{phone:k.mobModel.phone,sms:k.mobModel.code}};d.get(c+"&csrf=csrf").success(function(g){1==g.status&&(e.TMM_CSRF=g.data.csrf.TMM_CSRF,d.post(c,e).success(function(c){if(1==c.status)h.currentUser=c.data,b.$broadcast("getUserInfo",h.currentUser),a&&a(h.currentUser),k.cancel();else{if(c.form)for(var d in c.form)return void f.alert(c.form[d]);f.alert("网络连接错误")}}).error(function(){f.alert("网络连接错误")}))}).error(function(){f.alert("网络连接错误")})}}};return h}]),angular.module("resources",["security"]).factory("Resource",["$http","$q","$log","$rootScope","$ionicLoading","security","ENV",function(a,b,c,d,e,f,g){var h=g.apiEndpoint,i=function(a){return a.then(function(a){if(c.debug("debug: ",a),1===a.data.status){var e=new k(a.data.data);return e}if(!a.data.form)return 0===a.data.data.login?(d.$broadcast("getUserInfo",null),f.userInfo=null,f.login(),b.reject({code:"2",msg:"您没有登录"})):b.reject({code:"0",msg:"没有相关数据"});for(var g in a.data.form)return b.reject({code:"0",msg:a.data.form[g][0]})},function(a){return b.reject({code:"-1",msg:"网络连接错误"})})},j=function(a){return a.then(function(a){if(c.debug("debug: ",a),1===a.data.status){var d=new k(a.data.data);return d}if(!a.data.form)return b.reject({code:"0",msg:"没有相关数据"});for(var e in a.data.form)return b.reject({code:"1",msg:a.data.form[e][0],data:a.data})},function(a){return b.reject({code:"-1",msg:"网络连接错误"})})},k=function(a){angular.extend(this,a)};return k.get=function(b){var c=a.get(b);return i(c)},k.post=function(c,d){return this.get(c+"&csrf=csrf").then(function(b){d.TMM_CSRF=b.csrf.TMM_CSRF;var e=a.post(c,d);return j(e)},function(a){return b.reject(a)})},k.getRecommend=function(){return this.get(h+"/index.php?r=api/shops/selected&page=1")},k.getSeek=function(){return this.get(h+"/index.php?r=api/shops/index&page=1")},k.getUser=function(){return this.get(h+"/index.php?r=api/user/view")},k.logout=function(){return this.get(h+"/index.php?r=api/login/out")},k.postPraise=function(a){var b=h+"/index.php?r=api/shops/collect";return this.post(b,{Collect:{shops_id:a,user_address:""}})},k.getUserInfo=function(){return this.get(h+"/index.php?r=api/user/view")},k.logOut=function(){return this.get(h+"/index.php?r=api/login/out")},k.showAccCode=function(){return this.get(h+"/index.php?r=api/login/index&csrf=csrf")},k.accLogin=function(a){var b=h+"/index.php?r=api/login/index";return this.post(b,a)},k.showMobCode=function(){return this.get(h+"/index.php?r=api/login/login_sms&csrf=csrf")},k.getMobCode=function(b){var c=h+"/index.php?r=api/login/captcha_sms";return a.post(c,b)},k.mobLogin=function(a){var b=h+"/index.php?r=api/login/login_sms";return this.post(b,a)},k.getBurseInfo=function(){return this.get(h+"/index.php?r=api/account/my_burse")},k.getCash=function(){return a.get(h+"/index.php?r=api/bankCard/view_list")},k.withdrawCash=function(a){var b=h+"/index.php?r=api/Cash/cash_verify_price";return this.post(b,a)},k.getWithDrawCode=function(){return this.get(h+"/index.php?r=api/cash/captcha_cash")},k.withdrawMessage=function(a){var b=h+"/index.php?r=api/cash/create";return this.post(b,a)},k.getBankList=function(){return a.get(h+"/index.php?r=api/bankCard/bank_index")},k.createBankCard=function(a){var b=h+"/index.php?r=api/bankCard/create";return this.post(b,a)},k.getBankcardCode=function(){return this.get(h+"/index.php?r=api/user/captcha_bank_sms")},k.validateBankCardCode=function(a){var b=h+"/index.php?r=api/bankCard/bankcard_sms";return this.post(b,a)},k.getWithDrawRecord=function(){return this.get(h+"/index.php?r=api/cash/index&page=1")},k.getTradeRecord=function(){return this.get(h+"/index.php?r=api/accountLog/index&page=1")},k.getPayPasswd=function(){return this.get(h+"/index.php?r=api/password/view")},k.getIsvalidate=function(){return a.get(h+"/index.php?r=api/password/isvalidate&type=0")},k.getMyPraise=function(){return this.get(h+"/index.php?r=api/shops/praise&page=1")},k.getOrderList=function(a){return this.get(h+"/index.php?r=api/order/index&type="+a+"&page=1")},k.orderCancle=function(a){return this.get(h+"/index.php?r=api/order/cancel&id="+a)},k.orderPay=function(a){var b=h+"/index.php?r=api/order/payment";return this.post(b,a)},k.weixinPay=function(a){return this.get(h+"/api/order/paywx/id/"+a)},k.sendPayPasswd=function(a,b){var c=h+"/index.php?r=api/callback/account&id="+b;return this.post(c,a)},k.updateUserInfo=function(a){return this.post(h+"/index.php?r=api/user/update",a)},k.getPwdCode=function(c){return this.get(h+"/index.php?r=api/user/pwd&csrf=csrf").then(function(b){c.TMM_CSRF=b.csrf.TMM_CSRF;var d=a.post(h+"/index.php?r=api/user/captcha_pwd_sms",c);return j(d)},function(a){return b.reject(a)})},k.updatePwd=function(a){return this.post(h+"/index.php?r=api/user/pwd",a)},k.getUpdatePhoneCode=function(c,d){var e="",f="";return"old"==d?(e=h+"/index.php?r=api/user/captcha_old_sms",f=h+"/index.php?r=api/user/phone_old&csrf=csrf"):"new"==d&&(e=h+"/index.php?r=api/user/captcha_new_sms",f=h+"/index.php?r=api/user/phone_new&csrf=csrf"),this.get(f).then(function(b){c.TMM_CSRF=b.csrf.TMM_CSRF;var d=a.post(e,c);return j(d)},function(a){return b.reject(a)})},k.updateOldPhone=function(a){return this.post(h+"/index.php?r=api/user/phone_old",a)},k.updateNewPhone=function(a){return this.post(h+"/index.php?r=api/user/phone_new",a)},k.getJoinActList=function(a){return 1==a?this.get(h+"/index.php?r=api/order/index&type=actives_tour&page=1"):2==a?this.get(h+"/index.php?r=api/attend/index&page=1"):void 0},k.orderEnterCancle=function(a){return this.get(h+"/index.php?r=api/attend/delete&id="+a)},k.tourConfirm=function(a){return this.get(h+"/index.php?r=api/order/confirm&id="+a)},k.getSearchList=function(a,b){return this.get(h+"/index.php?r=api/shops/index&"+a+"="+b)},k.getAreaList=function(){return this.get(h+"/index.php?r=api/area/index")},k.getOrderDetail=function(a){return this.get(h+"/index.php?r=api/order/fare&id="+a)},k.getOrderPayDetail=function(a){return this.get(h+"/index.php?r=api/order/view&id="+a)},k.getCreateActList=function(){return this.get(h+"/index.php?r=api/orderActives/index&page=1")},k.editActInfo=function(a,b){var c=h+"/index.php?r=api/actives/update&id="+a;return this.post(c,b)},k.createOrder=function(a){return this.post(h+"/index.php?r=api/order/create",a)},k.getApplyCode=function(a,b){return this.post(h+"/index.php?r=api/attend/captcha_sms&id="+a,b)},k.actApply=function(a,b){return this.post(h+"/index.php?r=api/attend/create&id="+a,b)},k.editActName=function(a,b){var c=h+"/index.php?r=api/actives/UpdateShopsName&id="+b;return this.post(c,a)},k.editActNum=function(a,b){var c=h+"/index.php?r=api/actives/UpdateNumber&id="+b;return this.post(c,a)},k.createAct=function(a){return this.post(h+"/index.php?r=api/actives/create",a)},k.editPayType=function(a,b){var c=h+"/index.php?r=api/actives/UpdatePayType&id="+b;return this.post(c,a)},k.editActOpen=function(a,b){var c=h+"/index.php?r=api/actives/UpdateIsOpen&id="+b;return this.post(c,a)},k.editActGotime=function(a,b){var c=h+"/index.php?r=api/actives/UpdateGoTime&id="+b;return this.post(c,a)},k.editEnrolldate=function(a,b){var c=h+"/index.php?r=api/actives/UpdateStartEndTime&id="+b;return this.post(c,a)},k.editTourPrice=function(a,b){var c=h+"/index.php?r=api/actives/UpdateTourPrice&id="+b;return this.post(c,a)},k.changeLine=function(a,b){var c=h+"/index.php?r=api/actives/UpdateThrand&id="+b;return this.post(c,a)},k.getWeixinToken=function(a){return this.get(h+"/index.php?r=api/shops/wxgps&wxgps=wxgps&url="+a)},k.setLoactionGPS=function(a){return this.post(h+"/index.php?r=api/area/gps",a)},k.getItemDetail=function(a,b){var c;return 1===a?c="eat":2===a?c="hotel":3===a&&(c="play"),this.get(h+"/index.php?r=api/"+c+"/view&id="+b)},k}]),angular.module("tools",[]).service("autoRefresh",["$timeout","$ionicScrollDelegate",function(a,b){this.start=function(c){a(function(){var a=b.$getByHandle(c).getScrollView();a&&(a.triggerPullToRefresh(),a.__refreshShow(),a.__refreshActivate())})}}]).factory("backStep",function(){return{step:-1}}).factory("removeBackView",["$ionicHistory",function(a){return{remove:function(){var b=a,c=b.viewHistory(),d=c.histories[b.currentHistoryId()],e=d.cursor,f=d.stack[e],g=d.stack[e-1],h=d.stack[e-2];g&&h&&(d.stack.splice(e-1,1),b.clearCache([g.viewId]),f.backViewId=h.viewId,f.index=f.index-1,h.forwardViewId=f.viewId,c.backView=h,d.currentCursor+=-1)}}}]).factory("tmmCache",function(){var a={};return{set:function(b,c){c=c||"",a[b]=c},get:function(b){return a[b]=a[b]||"",a[b]},clean:function(b){delete a[b]},cleanAll:function(){a={}}}}).filter("trustHtml",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]).filter("html2Txt",function(){return function(a){return a.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"')}}).factory("appFunc",["$ionicPopup","$ionicLoading",function(a,b){return{isPhone:function(a){var b=/^1[34578][0-9]{9}$/;return b.test(a)},isEmail:function(a){var b=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;return b.test(a)},isUndefine:function(a){return void 0==a},validatePassword:function(a){var b=/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]+$/;return b.test(a)},validateVerifyCodeHash:function(a,b){for(var c=a.length-1,d=0;c>=0;--c)d+=a.toLowerCase().charCodeAt(c);return d==b},alert:function(b){return a.alert({title:b,cssClass:"tmm-ionic-alert",okText:"确定"})},tipMsg:function(a,c){c=c?c:1e3,b.show({template:a,duration:c,noBackdrop:!0})},mergeLineDay:function(a){var b,c,d={},e=["第一天","第二天","第三天","第四天","第五天","第六天","第七天","第八天","第九天","第十天"];for(c in a)b=Math.ceil((1*c+1)/2),b in d?d[b].dot_list=d[b].dot_list.concat(a[c].dot_list):d[b]=a[c],d[b].descript_day=e[b-1];return d},confirm:function(b,c){a.confirm({template:b,cssClass:"tmm-ionic-confirm",buttons:[{text:"取消"},{text:"<a>确定</a>",onTap:function(a){c()}}]})},toFormatNum:function(a){a=(a||0).toString();for(var b="";a.length>4;)b=" "+a.slice(-4)+b,a=a.slice(0,a.length-4);return a&&(b=a+b),b},tmmCallPhone:function(b,c){a.confirm({template:"请拨打电话"+b+c,cssClass:"tmm-ionic-confirm",buttons:[{text:"取消",type:"button-default"},{text:'<a href="tel:'+b+'">立即拨打</a>',type:"button-default",onTap:function(a){return!1}}]})}}}]),angular.module("tools").factory("QRCode",function(){var a;return function(){function b(a){this.mode=k.MODE_8BIT_BYTE,this.data=a,this.parsedData=[];for(var b=0,c=this.data.length;b<c;b++){var d=[],e=this.data.charCodeAt(b);e>65536?(d[0]=240|(1835008&e)>>>18,d[1]=128|(258048&e)>>>12,d[2]=128|(4032&e)>>>6,d[3]=128|63&e):e>2048?(d[0]=224|(61440&e)>>>12,d[1]=128|(4032&e)>>>6,d[2]=128|63&e):e>128?(d[0]=192|(1984&e)>>>6,d[1]=128|63&e):d[0]=e,this.parsedData.push(d)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function c(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function d(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function e(a,b){this.totalCount=a,this.dataCount=b}function f(){this.buffer=[],this.length=0}function g(){return"undefined"!=typeof CanvasRenderingContext2D}function h(){var a=!1,b=navigator.userAgent;return/android/i.test(b)&&(a=!0,aMat=b.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(a=parseFloat(aMat[1]))),a}function i(a,b){for(var c=1,d=j(a),e=0,f=q.length;e<=f;e++){var g=0;switch(b){case l.L:g=q[e][0];break;case l.M:g=q[e][1];break;case l.Q:g=q[e][2];break;case l.H:g=q[e][3]}if(d<=g)break;c++}if(c>q.length)throw new Error("Too long data");return c}function j(a){var b=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return b.length+(b.length!=a?3:0)}b.prototype={getLength:function(a){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;b<c;b++)a.put(this.parsedData[b],8)}},c.prototype={addData:function(a){var c=new b(a);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(a<0||this.moduleCount<=a||b<0||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,b){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,b),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=c.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,b)},setupPositionProbePattern:function(a,b){for(var c=-1;c<=7;c++)if(!(a+c<=-1||this.moduleCount<=a+c))for(var d=-1;d<=7;d++)b+d<=-1||this.moduleCount<=b+d||(0<=c&&c<=6&&(0==d||6==d)||0<=d&&d<=6&&(0==c||6==c)||2<=c&&c<=4&&2<=d&&d<=4?this.modules[a+c][b+d]=!0:this.modules[a+c][b+d]=!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;c<8;c++){this.makeImpl(!0,c);var d=n.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=a%2==0);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=b%2==0)},setupPositionAdjustPattern:function(){for(var a=n.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;f<=2;f++)for(var g=-2;g<=2;g++)f==-2||2==f||g==-2||2==g||0==f&&0==g?this.modules[d+f][e+g]=!0:this.modules[d+f][e+g]=!1}},setupTypeNumber:function(a){for(var b=n.getBCHTypeNumber(this.typeNumber),c=0;c<18;c++){var d=!a&&1==(b>>c&1);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;c<18;c++){var d=!a&&1==(b>>c&1);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=n.getBCHTypeInfo(c),e=0;e<15;e++){var f=!a&&1==(d>>e&1);e<6?this.modules[e][8]=f:e<8?this.modules[e+1][8]=f:this.modules[this.moduleCount-15+e][8]=f}for(var e=0;e<15;e++){var f=!a&&1==(d>>e&1);e<8?this.modules[8][this.moduleCount-e-1]=f:e<9?this.modules[8][15-e-1+1]=f:this.modules[8][15-e-1]=f}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;g>0;g-=2)for(6==g&&g--;;){for(var h=0;h<2;h++)if(null==this.modules[d][g-h]){var i=!1;f<a.length&&(i=1==(a[f]>>>e&1));var j=n.getMask(b,d,g-h);j&&(i=!i),this.modules[d][g-h]=i,e--,e==-1&&(f++,e=7)}if(d+=c,d<0||this.moduleCount<=d){d-=c,c=-c;break}}}},c.PAD0=236,c.PAD1=17,c.createData=function(a,b,d){for(var g=e.getRSBlocks(a,b),h=new f,i=0;i<d.length;i++){var j=d[i];h.put(j.mode,4),h.put(j.getLength(),n.getLengthInBits(j.mode,a)),j.write(h)}for(var k=0,i=0;i<g.length;i++)k+=g[i].dataCount;if(h.getLengthInBits()>8*k)throw new Error("code length overflow. ("+h.getLengthInBits()+">"+8*k+")");for(h.getLengthInBits()+4<=8*k&&h.put(0,4);h.getLengthInBits()%8!=0;)h.putBit(!1);for(;!(h.getLengthInBits()>=8*k)&&(h.put(c.PAD0,8),!(h.getLengthInBits()>=8*k));)h.put(c.PAD1,8);return c.createBytes(h,g)},c.createBytes=function(a,b){for(var c=0,e=0,f=0,g=new Array(b.length),h=new Array(b.length),i=0;i<b.length;i++){var j=b[i].dataCount,k=b[i].totalCount-j;e=Math.max(e,j),f=Math.max(f,k),g[i]=new Array(j);for(var l=0;l<g[i].length;l++)g[i][l]=255&a.buffer[l+c];c+=j;var m=n.getErrorCorrectPolynomial(k),o=new d(g[i],m.getLength()-1),p=o.mod(m);h[i]=new Array(m.getLength()-1);for(var l=0;l<h[i].length;l++){var q=l+p.getLength()-h[i].length;h[i][l]=q>=0?p.get(q):0}}for(var r=0,l=0;l<b.length;l++)r+=b[l].totalCount;for(var s=new Array(r),t=0,l=0;l<e;l++)for(var i=0;i<b.length;i++)l<g[i].length&&(s[t++]=g[i][l]);for(var l=0;l<f;l++)for(var i=0;i<b.length;i++)l<h[i].length&&(s[t++]=h[i][l]);return s};for(var k={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},l={L:1,M:0,Q:3,H:2},m={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},n={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;n.getBCHDigit(b)-n.getBCHDigit(n.G15)>=0;)b^=n.G15<<n.getBCHDigit(b)-n.getBCHDigit(n.G15);return(a<<10|b)^n.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;n.getBCHDigit(b)-n.getBCHDigit(n.G18)>=0;)b^=n.G18<<n.getBCHDigit(b)-n.getBCHDigit(n.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return n.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case m.PATTERN000:return(b+c)%2==0;case m.PATTERN001:return b%2==0;case m.PATTERN010:return c%3==0;case m.PATTERN011:return(b+c)%3==0;case m.PATTERN100:return(Math.floor(b/2)+Math.floor(c/3))%2==0;case m.PATTERN101:return b*c%2+b*c%3==0;case m.PATTERN110:return(b*c%2+b*c%3)%2==0;case m.PATTERN111:return(b*c%3+(b+c)%2)%2==0;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var b=new d([1],0),c=0;c<a;c++)b=b.multiply(new d([1,o.gexp(c)],0));return b},getLengthInBits:function(a,b){if(1<=b&&b<10)switch(a){case k.MODE_NUMBER:return 10;case k.MODE_ALPHA_NUM:return 9;case k.MODE_8BIT_BYTE:return 8;case k.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(b<27)switch(a){case k.MODE_NUMBER:return 12;case k.MODE_ALPHA_NUM:return 11;case k.MODE_8BIT_BYTE:return 16;case k.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(b<41))throw new Error("type:"+b);switch(a){case k.MODE_NUMBER:return 14;case k.MODE_ALPHA_NUM:return 13;case k.MODE_8BIT_BYTE:return 16;case k.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;d<b;d++)for(var e=0;e<b;e++){for(var f=0,g=a.isDark(d,e),h=-1;h<=1;h++)if(!(d+h<0||b<=d+h))for(var i=-1;i<=1;i++)e+i<0||b<=e+i||0==h&&0==i||g==a.isDark(d+h,e+i)&&f++;f>5&&(c+=3+f-5)}for(var d=0;d<b-1;d++)for(var e=0;e<b-1;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++,0!=j&&4!=j||(c+=3)}for(var d=0;d<b;d++)for(var e=0;e<b-6;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;e<b;e++)for(var d=0;d<b-6;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var k=0,e=0;e<b;e++)for(var d=0;d<b;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;return c+=10*l}},o={glog:function(a){if(a<1)throw new Error("glog("+a+")");return o.LOG_TABLE[a]},gexp:function(a){for(;a<0;)a+=255;for(;a>=256;)a-=255;return o.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},p=0;p<8;p++)o.EXP_TABLE[p]=1<<p;for(var p=8;p<256;p++)o.EXP_TABLE[p]=o.EXP_TABLE[p-4]^o.EXP_TABLE[p-5]^o.EXP_TABLE[p-6]^o.EXP_TABLE[p-8];for(var p=0;p<255;p++)o.LOG_TABLE[o.EXP_TABLE[p]]=p;d.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),c=0;c<this.getLength();c++)for(var e=0;e<a.getLength();e++)b[c+e]^=o.gexp(o.glog(this.get(c))+o.glog(a.get(e)));return new d(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=o.glog(this.get(0))-o.glog(a.get(0)),c=new Array(this.getLength()),e=0;e<this.getLength();e++)c[e]=this.get(e);for(var e=0;e<a.getLength();e++)c[e]^=o.gexp(o.glog(a.get(e))+b);return new d(c,0).mod(a)}},e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(a,b){var c=e.getRsBlockTable(a,b);if(void 0==c)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var d=c.length/3,f=[],g=0;g<d;g++)for(var h=c[3*g+0],i=c[3*g+1],j=c[3*g+2],k=0;k<h;k++)f.push(new e(i,j));return f},e.getRsBlockTable=function(a,b){switch(b){case l.L:return e.RS_BLOCK_TABLE[4*(a-1)+0];case l.M:return e.RS_BLOCK_TABLE[4*(a-1)+1];case l.Q:return e.RS_BLOCK_TABLE[4*(a-1)+2];case l.H:return e.RS_BLOCK_TABLE[4*(a-1)+3];default:return}},f.prototype={get:function(a){var b=Math.floor(a/8);return 1==(this.buffer[b]>>>7-a%8&1)},put:function(a,b){for(var c=0;c<b;c++)this.putBit(1==(a>>>b-c-1&1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}};var q=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],r=function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){function b(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c}var c=this._htOption,d=this._el,e=a.getModuleCount();Math.floor(c.width/e),Math.floor(c.height/e);this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),d.appendChild(f),f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(var g=0;g<e;g++)for(var h=0;h<e;h++)if(a.isDark(g,h)){var i=b("use",{x:String(g),y:String(h)});i.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),f.appendChild(i)}},a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},a}(),s="svg"===document.documentElement.tagName.toLowerCase(),t=s?r:g()?function(){function a(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function b(a,b){var c=this;if(c._fFail=b,c._fSuccess=a,null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1,c._fFail&&_fFail.call(c)},f=function(){c._bSupportDataURI=!0,c._fSuccess&&c._fSuccess.call(c)};return d.onabort=e,d.onerror=e,d.onload=f,void(d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}c._bSupportDataURI===!0&&c._fSuccess?c._fSuccess.call(c):c._bSupportDataURI===!1&&c._fFail&&c._fFail.call(c)}if(this._android&&this._android<=2.1){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,h,i,j,k){if("nodeName"in a&&/img/i.test(a.nodeName))for(var l=arguments.length-1;l>=1;l--)arguments[l]=arguments[l]*c;else"undefined"==typeof j&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var e=function(a,b){this._bIsPainted=!1,this._android=h(),this._htOption=b,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=b.width,this._elCanvas.height=b.height,
a.appendChild(this._elCanvas),this._el=a,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return e.prototype.draw=function(a){var b=this._elImage,c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),i=Math.round(g);b.style.display="none",this.clear();for(var j=0;j<e;j++)for(var k=0;k<e;k++){var l=a.isDark(j,k),m=k*f,n=j*g;c.strokeStyle=l?d.colorDark:d.colorLight,c.lineWidth=1,c.fillStyle=l?d.colorDark:d.colorLight,c.fillRect(m,n,f,g),c.strokeRect(Math.floor(m)+.5,Math.floor(n)+.5,h,i),c.strokeRect(Math.ceil(m)-.5,Math.ceil(n)-.5,h,i)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&b.call(this,a)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(a){return a?Math.floor(1e3*a)/1e3:a},e}():function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['<table style="border:0;border-collapse:collapse;">'],h=0;h<d;h++){g.push("<tr>");for(var i=0;i<d;i++)g.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,i)?b.colorDark:b.colorLight)+';"></td>');g.push("</tr>")}g.push("</table>"),c.innerHTML=g.join("");var j=c.childNodes[0],k=(b.width-j.offsetWidth)/2,l=(b.height-j.offsetHeight)/2;k>0&&l>0&&(j.style.margin=l+"px "+k+"px")},a.prototype.clear=function(){this._el.innerHTML=""},a}();a=function(a,b){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:l.H},"string"==typeof b&&(b={text:b}),b)for(var c in b)this._htOption[c]=b[c];"string"==typeof a&&(a=document.getElementById(a)),this._android=h(),this._el=a,this._oQRCode=null,this._oDrawing=new t(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},a.prototype.makeCode=function(a){this._oQRCode=new c(i(a,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(a),this._oQRCode.make(),this._el.title=a,this._oDrawing.draw(this._oQRCode),this.makeImage()},a.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},a.prototype.clear=function(){this._oDrawing.clear()},a.CorrectLevel=l}(),a}),angular.module("device",[]).factory("device",["$ionicHistory","$ionicPopup","$rootScope","$filter","modify","appFunc","ENV","Resource",function(a,b,c,d,e,f,g,h){function i(a){navigator.geolocation&&navigator.geolocation.getCurrentPosition(a)}window.connectWebViewJavascriptBridge=function(a){window.WebViewJavascriptBridge?a(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){a(WebViewJavascriptBridge)},!1)},connectWebViewJavascriptBridge(function(a){a.init(function(a,b){})}),connectWebViewJavascriptBridge(function(a){a.callHandler("ObjcCallback",{setNetwork:1},function(a){})}),connectWebViewJavascriptBridge(function(a){a.registerHandler("JSCallback",function(a,b){""==a?window.device.getAddress(a):window.device.getAddress(a.longitude,a.latitude,a.city)})}),connectWebViewJavascriptBridge(function(a){a.registerHandler("PayCallback",function(a,b){"1"==a&&window.device.goOrderDetail()})}),connectWebViewJavascriptBridge(function(a){a.registerHandler("JSLogin_Callback",function(a,b){window.tmmSdk.JSLogin_Callback()})});var j={goFresh:function(){var a=g.freshHomePage;try{g.iOS?connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{youzan_1:a},function(a){})}):g.android&&window.jsObj.jumpActivity(a,0)}catch(b){}},goSeekFreshDetail2:function(a,b,c,e){try{a=d("html2Txt")(a),b=d("html2Txt")(b)}catch(f){}g.iOS?connectWebViewJavascriptBridge(function(d){d.callHandler("ObjcCallback",{youzan_3:{title:a,description:b,thumb_url:c,webpageUrl:e}},function(a){})}):g.android&&window.jsObj.jumpActivity(e,2,a,c,e,b)},exitSeekFresh:function(){try{g.iOS?connectWebViewJavascriptBridge(function(a){a.callHandler("ObjcCallback",{youzan_exit:""},function(a){})}):g.android&&window.jsObj.hindJumpActivity()}catch(a){}},share:function(a,b,c,d){var e=window.location.href;h.getWeixinToken(e).then(function(e){wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:a,link:b,imgUrl:c,success:function(){},cancel:function(){}}),wx.onMenuShareAppMessage({title:a,desc:d,link:b,imgUrl:c,type:"",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareQQ({title:a,desc:d,link:b,imgUrl:c,success:function(){},cancel:function(){}})})})},shareMsg:function(a,b,c,d){try{g.iOS?connectWebViewJavascriptBridge(function(e){e.callHandler("ObjcCallback",{wx_share:{title:a,description:b,thumb_url:c,webpageUrl:d}},function(a){})}):g.android&&window.jsObj.showShare(a,"",b,c,d,"","")}catch(e){}},getLocation:function(a){if("app"===g.device)try{g.iOS?connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{getLoc:""},function(b){if(b===!1||"false"===b);else{var c={location:{lng:b.longitude,lat:b.latitude}};h.setLoactionGPS(c).then(function(b){a&&a()},function(a){})}})}):g.android&&window.jsObj.getAddress()}catch(b){}else if(g.isWeixin){var c=window.location.href;h.getWeixinToken(c).then(function(b){wx.config({debug:!1,appId:b.appId,timestamp:b.timestamp,nonceStr:b.nonceStr,signature:b.signature,jsApiList:["getLocation"]}),wx.ready(function(){wx.getLocation({type:"wgs84",success:function(b){var c=b.latitude,d=b.longitude,e=(b.speed,b.accuracy,{location:{lng:d,lat:c}});h.setLoactionGPS(e).then(function(b){a&&a()},function(a){})}})})})}else i(function(b){var c={location:{lng:b.coords.longitude,lat:b.coords.latitude}};h.setLoactionGPS(c).then(function(b){a&&a()})})},showMap:function(a,b,c,d){try{g.iOS?(connectWebViewJavascriptBridge(function(a){a.callHandler("ObjcCallback",{navi:b},function(a){})}),connectWebViewJavascriptBridge(function(e){e.callHandler("ObjcCallback",{navi_loc:{lng:c+"",lat:d+"",address:b,city:a}},function(a){})})):g.android&&(window.jsObj.jumpMap(a,b),window.jsObj.jumpMaps(c+"",d+"",b,a))}catch(e){}},tmmWxCallPhone:function(a){if("weixin"===g.device)var c=b.alert({title:'<a href="tel:'+a+'">点击拨打电话'+a+"</a>",cssClass:"tmm-ionic-alert",okText:"取消"});else var c=b.confirm({template:"请拨打电话"+a,cssClass:"tmm-ionic-confirm",buttons:[{text:"取消",type:"button-default"},{text:"立即拨打",type:"button-default",onTap:function(b){a=a.replace(/\-/g,"");try{g.iOS?connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{phone:a},function(a){})}):g.android&&window.jsObj.callPhone(a)}catch(b){}}}]});return c},getAddress:function(a,b,c){a&&(j.location={lng:a,lat:b,city:c},j.setLocationCity(a,b))},setLocationCity:function(a,b){var c={location:{lng:a,lat:b}};h.setLoactionGPS(c).then(function(a){},function(a){})},getLocationCallBack:function(b,c,d){b?h.setLoactionGPS({location:{lng:b,lat:c}}).then(function(b){a.goBack(-1),e.ismodify=!0}):f.tipMsg("获取地理位置失败")},wxPay:function(a){try{g.iOS?(console.log(a),connectWebViewJavascriptBridge(function(b){b.callHandler("ObjcCallback",{WxPay:a},function(a){})})):g.android&&window.jsObj.weixinPay(angular.toJson(a),"window.device.goOrderDetail")}catch(b){}},goOrderDetail:function(){c.$broadcast("wxPay","success")},SET:function(a,b){"string"!=typeof b&&(b=JSON.stringify(b));try{localStorage.setItem(a,b)}catch(c){}},GET:function(a){var b=null;try{b=localStorage.getItem(a),b=JSON.parse(b)}catch(c){}return b}};return window.device=j,j}]),angular.module("tmmui",[]).directive("hideTabs",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){b.$on("$ionicView.beforeEnter",function(){b.$watch(d.hideTabs,function(b){a.hideTabs="tabs-item-hide"})}),b.$on("$ionicView.beforeLeave",function(){b.$watch(d.hideTabs,function(b){a.hideTabs="tabs-item-hide"}),b.$watch("$destroy",function(){a.hideTabs=""})})}}}]).directive("barClass",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){b.$on("$ionicView.beforeEnter",function(){a.barClass=d.barClass}),b.$on("$ionicView.beforeLeave",function(){a.barClass=""})}}}]).directive("loadIcon",function(){return{restrict:"E",replace:!0,template:'<div class="load-more"><ion-spinner icon="dots"></ion-spinner></div>'}}).directive("navBack",["$ionicHistory","$ionicViewSwitcher","$state","backStep",function(a,b,c,d){return{restrict:"A",link:function(e,f,g){g.ngClick||f.bind("click",function(){if(b.nextDirection("back"),a.viewHistory().backView)a.goBack(d.step),d.step=-1;else{a.clearCache().then(function(){c.go("tab.index")})}})}}}]).controller("SilderController",["$scope","$element",function(a,b){function c(){l==n.length-1&&(l=-1),g(++l)}function d(){o.innerHTML="";var a=s-15;o.style.cssText="width: 100%;line-height: 0; text-align:center;position: absolute; top:"+a+"px; z-index: 11;text-align: center;";for(var c=0,d=n.length;c<d;c++){var e=document.createElement("li");e.style.cssText="display:inline-block; width:5px; height:5px; margin:0 8px; border-radius:50%; background-color:#fff;",o.appendChild(e),m.push(e)}n.length>1&&(b[0].parentNode.appendChild(o),m[l].style.backgroundColor=p)}function e(){var a,d,e,g,j,m=function(b){clearInterval(r),a=1*new Date,d=b.touches[0].pageX,e=b.touches[0].pageY,h.offsetX=0},n=function(a){g=a.targetTouches[0].pageX-d,j=a.targetTouches[0].pageY-e,Math.abs(g)>Math.abs(j)&&(a.stopPropagation(),a.preventDefault(),q=!1),q||(g=g>=i/4?i/4:g,t.style.webkitTransition="-webkit-transform 0s ease-out",t.style.webkitTransform="translate3d("+(-l*i+g)+"px, 0, 0)")},o=function(b){if(k&&(r=setInterval(c,+k)),!q){var d=i/4,e=1*new Date;f(e-a>300?g>=d?-1:g<=-d?1:0:g>50?-1:g<-50?1:0),q=!0}};b[0].addEventListener("touchstart",m),b[0].addEventListener("touchmove",n),b[0].addEventListener("touchend",o)}function f(a){var b=n.length;l+=a,l>b-1?l=b-1:l<0&&(l=0),g(l)}function g(a){var b=n.length;t.style.webkitTransition="-webkit-transform 0.2s ease-out",t.style.webkitTransform="translate3d(-"+i*a+"px, 0, 0)";for(var c=0;c<b;c++)m[c].style.backgroundColor="#fff";m[a].style.backgroundColor=p}var h=this,i=window.innerWidth,j=b.attr("ratio"),k=b.attr("spacetime"),l=0,m=[],n=[],o=document.createElement("ul"),p="#007aff",q=!0,r=null;j&&(i*=j);var s=2*i/3;b.css({height:s+"px"});var t=b[0].querySelector(".img-wrap");e(),h.init=function(){l=0,d(),g(l)},k&&(r=setInterval(c,+k)),h.reset=function(){n=[],m=[]},h.addElm=function(a){n.push(a)}}]).directive("slider",function(){return{restrict:"EA",replace:!0,transclude:!0,controller:"SilderController",template:'<div ratio class="wrap"><div style="position: relative; width:100%; height: 100%;"><div class="img-wrap" ng-transclude></div></div></div>'}}).directive("sliderItem",function(){return{restrict:"EA",require:"^slider",replace:!0,template:'<img ng-src="{{imgsrc}}">',scope:{last:"=?",first:"=?",imgsrc:"=imgSrc"},link:function(a,b,c,d){a.first&&d.reset(),d.addElm(b[0]),a.last&&d.init()}}}).controller("NavbarController",function(){}).directive("navbar",["$compile","ENV",function(a,b){return{restrict:"E",replace:!0,controller:"NavbarController",transclude:!0,template:'<div class="navbar-wrap"><div ng-transclude class="tmm-navbar"></div></div>',link:function(c,d,e,f){"app"===b.device&&b.iOS&&d.css({paddingTop:"20px"});var g=angular.element(d.find("div")[0]);"back"in e&&g.prepend(a('<div class="left"><i class="icon-back" nav-back="back"></i></div>')(c)),"title"in e&&g.append('<div class="title">'+e.title+"</i></div>")}}}]),angular.module("payType",[]).factory("payFunc",["$ionicPopup","$http","Resource","appFunc","device","ENV",function(a,b,c,d,e,f){return{payOrder:function(a,g,h,i,j,k){function l(a){M?(D.innerHTML='<i class="icon icon-wallet"></i>钱包（余额'+a+'元）<span class="right-arrow"><i class="icon-right-arrow"></i></span>',D.addEventListener("click",s)):(D.className="pay-item disabled",D.innerHTML='<i class="icon icon-wallet"></i>钱包（余额不足）<span class="right-arrow"><i class="icon-right-arrow"></i></span>'),A.addEventListener("click",p),"weixin"!==f.device&&E.addEventListener("click",m),F.addEventListener("click",n),document.body.appendChild(x),document.body.appendChild(y),x.style.opacity=1,"weixin"!==f.device?m():n()}function m(){B.innerHTML="支付宝支付",C.innerHTML="",C.appendChild(G),C.appendChild(E),C.appendChild(I),E.removeEventListener("click",m),E.addEventListener("click",o),I.addEventListener("click",q)}function n(){B.innerHTML="微信支付",C.innerHTML="",C.appendChild(G),C.appendChild(F),C.appendChild(J),F.removeEventListener("click",n),F.addEventListener("click",o),J.addEventListener("click",r)}function o(){B.innerHTML="选择付款方式",C.innerHTML="",C.appendChild(D),"weixin"!==f.device&&C.appendChild(E),C.appendChild(F),N&&N.cancel(),N=null,y.className="pay-order-choice",M&&(D.removeEventListener("click",o),D.addEventListener("click",s)),E.removeEventListener("click",o),E.addEventListener("click",m),F.removeEventListener("click",o),F.addEventListener("click",n)}function p(){document.body.removeChild(y),x.style.opacity=0,setTimeout(function(){document.body.removeChild(x)},400),N&&N.cancel(),N=null}function q(){var b={id:a,pay_type:"1"};c.orderPay(b).then(function(a){i(a)},function(a){j(a)}),p()}function r(){if("app"===f.device)b.get(f.apiEndpoint+"/api/order/paywx?id="+a+"&type=1").success(function(a){e.wxPay(a.data.wxpay),p()}).error(function(a){});else{var c=["myorderdetail_1","myorderdetail_2","myorderdetail_3","myorderdetail_4"],d=window.location.href,h=c[g-1],i=d.substring(d.indexOf("#")+2),j=f.apiEndpoint+"/api/order/paywx?id="+a+"&page="+h+"&error="+i;window.location.href=j}}function s(){var a,b=u("div","passwd-wrap"),c=[],d=0;for(K="",B.innerHTML="请输入支付密码",D.removeEventListener("click",s),D.addEventListener("click",o),H.innerHTML="￥"+h;d<6;d++)a=u("div","passwd-item"),a.index=d,c.push(a),b.appendChild(a);G.appendChild(H),C.innerHTML="",C.appendChild(G),C.appendChild(D),C.appendChild(b),y.className="pay-order-choice pay-wallet",N=w(document.body),N.getTap(function(a){t(a,c)})}function t(a,b){if(K.length<6){11==a?K+=0:12==a?K=K.substr(0,K.length-1):10==a||(K+=a);for(var c=0;c<b.length;c++)c<K.length?b[c].className="passwd-item pwd-input":b[c].className="passwd-item"}else if(12==a){K=K.substr(0,K.length-1);for(var c=0;c<b.length;c++)c<K.length?b[c].className="passwd-item pwd-input":b[c].className="passwd-item"}6==K.length&&L&&(v(K,b),L=!1)}function u(a,b,c){var d=document.createElement(a);return b&&(d.className=b),c&&(d.innerHTML=c),d}function v(b,e){var f={Password:{_pwd:b}};c.sendPayPasswd(f,a).then(function(a){var b="";if(1==a.value){if(1==a.status.value)return b=a.status.info,d.alert(b),p(),void(k&&k(a));b=a.status.info}else b=a.name;K="",t(10,e),d.alert(b),L=!0},function(a){d.alert("网络错误"),L=!0})}function w(a){function b(a){f.addEventListener("click",function(b){a(b.target.index+1)})}function c(){f.style.transform="translate3d(0, 100%, 0)",f.style.webkitTransform="translate3d(0, 100%, 0)",setTimeout(function(){a.removeChild(f)},250)}var d,e=[],f=document.createElement("div");f.className="keyboard";for(var g=0;g<12;g++)d=document.createElement("span"),d.index=g,e.push(d),d.className="keyboard-item",f.appendChild(d);return a.appendChild(f),setTimeout(function(){f.style.transform="translate3d(0, 0, 0)",f.style.webkitTransform="translate3d(0, 0, 0)"},0),{cancel:c,getTap:b}}var x=u("div","modal-mask"),y=u("div","pay-order-choice"),z=u("div","pay-tit"),A=u("i","icon-close ticon-close"),B=u("span","","选择付款方式"),C=u("div","pay-wrap"),D=u("div","pay-item"),E=u("div","pay-item"),F=u("div","pay-item"),G=u("div","pay-price","支付"),H=u("div","pric-num","￥"+h),I=u("div","zhifubao-button","确认"),J=u("div","wx-button","确认"),K="",L=!0,M=!1,N=null;z.appendChild(A),z.appendChild(B),G.appendChild(H),y.appendChild(z),y.appendChild(C),"weixin"!==f.device&&(E.innerHTML='<i class="zifubao"></i>支付宝<span class="right-arrow"><i class="icon-right-arrow"></i></span>'),F.innerHTML='<i class="icon wx"></i>微信支付<span class="right-arrow"><i class="icon-right-arrow"></i></span>',c.getBurseInfo().then(function(a){M=Number(a.money)>Number(h),l(a.money)},function(a){})}}}]),angular.module("calendar",["ionic"]).factory("uiCalendar",["$rootScope","$compile","$timeout","$ionicBody","$animate",function(a,b,c,d,e){function f(f){function g(a,b){var c,d,e,f,g,j,l=new Date,m=l.getDate(),o=l.getMonth()+1,p=l.getFullYear(),q=i(a,b),r=[],s=[];c=1==b?12:b-1,e=1==b?a-1:a,d=12==b?1:b+1,f=12==b?a+1:a,l.setFullYear(a),l.setMonth(b-1),l.setDate(1);var t=null,u=!1;for(g=l.getDay(),j=i(e,c);g>0;g--)t=new Date(e,c-1,j+1-g),(k.opts.minDate&&t.getTime()<k.opts.minDate||k.opts.maxDate&&t.getTime()>k.opts.maxDate)&&(u=!0),h(n.date,t)?r.push(n):r.push({date:t,isOther:!0,isSelected:!1,disabled:u,isToday:j+1-g==m&&c==o&&e==p}),u=!1;for(g=1;g<=q;g++)t=new Date(a,b-1,g),(k.opts.minDate&&t.getTime()<k.opts.minDate||k.opts.maxDate&&t.getTime()>k.opts.maxDate)&&(u=!0),h(n.date,t)?r.push(n):r.push({date:t,isOther:!1,isSelected:!1,disabled:u,isToday:g==m&&b==o&&a==p}),u=!1;for(g=1,j=r.length;g<=42-j;g++)t=new Date(f,d-1,g),(k.opts.minDate&&t.getTime()<k.opts.minDate||k.opts.maxDate&&t.getTime()>k.opts.maxDate)&&(u=!0),h(n.date,t)?r.push(n):r.push({date:t,isOther:!0,isSelected:!1,disabled:u,isToday:g==m&&d==o&&f==p}),u=!1;for(g=0;g<6;g++)s.push(r.splice(0,7));return k.canPrev=!0,k.canNext=!0,k.opts.minDate&&k.opts.minDate>new Date(e,c-1,i(e,c)).getTime()&&(k.canPrev=!1),k.opts.maxDate&&k.opts.maxDate<new Date(f,d-1,1).getTime()&&(k.canNext=!1),s}function h(a,b){return a instanceof Date&&b instanceof Date&&(a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate())}function i(a,b){return 1==b||3==b||5==b||7==b||8==b||10==b||12==b?31:4==b||6==b||9==b||11==b?30:2==b&&j(a)?29:28}function j(a){return a%4===0&&a%100!==0||a%400===0}var k=a.$new(!0),l=angular.noop,m=[],n={};k.opts={},angular.extend(k.opts,{contrainer:null,defaultDate:null,selecting:l,selected:l,cancel:l,format:"-",maxDate:null,minDate:null,num:1},f||{}),n.date=k.opts.defaultDate,k.opts.minDate=k.opts.minDate?new Date(k.opts.minDate.getFullYear(),k.opts.minDate.getMonth(),k.opts.minDate.getDate()):null,k.opts.maxDate=k.opts.maxDate?new Date(k.opts.maxDate.getFullYear(),k.opts.maxDate.getMonth(),k.opts.maxDate.getDate()):null,k.months=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],k.dayNames=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],k.year=(new Date).getFullYear(),k.month=(new Date).getMonth()+1,k.canPrev=!0,k.canNext=!0,k.weeks=g(k.year,k.month),k.opts.contrainer||a.$on("$stateChangeSuccess",function(){k.cancel()}),k.nextMonth=function(a){a&&(12==k.month?(k.year=k.year+1,k.month=1):k.month=k.month+1,k.weeks=g(k.year,k.month))},k.prevMonth=function(a){a&&(1==k.month?(k.year=k.year-1,k.month=12):k.month=k.month-1,k.weeks=g(k.year,k.month))},element=b("<ui-calendar></ui-calendar>")(k);var o=angular.element(element[0].querySelector(".calendar-wrapper")),p=(angular.element(o[0].querySelector(".calendar-day")),!0);return k.selecteDate=function(a,b){if(null!==k.opts.contrainer)n.isSelected=!1,k.weeks[a][b].isSelected=!0,n=k.weeks[a][b],m[0]=k.weeks[a][b].date,k.opts.selected(m);else{if(!p)return;if(k.weeks[a][b].isSelected=!0,m.push(k.weeks[a][b].date),k.opts.selecting(m),m.length==k.opts.num)return 2==k.opts.num&&h(m[0],m[1])?void m.pop():(m.sort(function(a,b){return a.getTime()-b.getTime()}),k.opts.selected(m),null!==k.opts.contrainer||c(function(){k.removeCalendar()},350),void(p=!1))}},k.showSheet=function(a){d.append(element),e.addClass(element,"active"),c(function(){o.addClass("calendar-up")},20,!1)},k.removeCalendar=function(a){k.removed||(k.removed=!0,o.removeClass("calendar-up"),e.removeClass(element,"active").then(function(){k.$destroy(),element.remove(),(a||l)(m)}))},k.cancel=function(){k.opts.cancel(),k.removeCalendar()},null===k.opts.contrainer?k.showSheet():(element.addClass("static"),o.addClass("calendar-up"),angular.element(k.opts.contrainer).append(element)),clearDate=function(){n={},k.weeks=g(k.year,k.month)},{clearDate:clearDate}}return{show:f}}]).directive("uiCalendar",["$document",function(a){return{restrict:"E",scope:!0,replace:!0,template:'<div class="calendar-backdrop"><div class="calendar-wrapper"><div class="calendar-toolbar"><i ng-click="prevMonth(canPrev)" ng-class="{true:\'touchstyle\',false:\'disabled\'}[canPrev]" class="icon arrow-left"></i><div class="current-year">{{year}}年</div><div class="current-month">{{months[month-1]}}</div><i ng-click="nextMonth(canNext)" ng-class="{true:\'touchstyle\',false:\'disabled\'}[canNext]" class="icon arrow-right"></i></div><table class="calendar-month"><thead><tr class="week"><th ng-repeat="day in dayNames">{{day}}</th></tr></thead><tbody class="calendar-day"><tr class="week-day" ng-repeat="week in weeks track by $index" ng-init="m=$index"><td ng-class="{\'otherMonth\':day.isOther}" ng-repeat="day in week track by $index" ng-init="n=$index"><span ng-click="day.disabled || selecteDate(m,n)" ng-class="{\'disabled\':day.disabled, \'today\':day.isToday, \'selected\':day.isSelected}">{{day.date.getDate()}}</span></td></tr></tbody></table></div></div>',link:function(a,b,c){var d=function(c){c.target==b[0]&&(a.cancel(),a.$apply())};a.$on("$destroy",function(){b.remove()}),b.bind("click",d)}}}]),angular.module("app").run(["$templateCache",function(a){"use strict";a.put("app/base/templates/tabs.html",'<ion-nav-view></ion-nav-view> <div class="tabs tabs-icon-top tmm-recommend-tabs {{$root.hideTabs}}"> <a class="tab-item" ui-sref-active="active" ui-sref="tab.index" nav-transition="none"> <i class="icon" ng-class="{true: \'icon-index-click\', false : \'icon-index\'}[active === \'tab.index\']"></i> 首页 </a> <a class="tab-item" ui-sref-active="active" ui-sref="tab.fresh" nav-transition="none"> <i class="icon" ng-class="{true: \'icon-fresh-click\', false : \'icon-fresh\'}[active === \'tab.fresh\']"></i> 觅鲜 </a> <a class="tab-item" ui-sref-active="active" ui-sref="tab.seek" nav-transition="none"> <i class="icon" ng-class="{true: \'icon-seek-click\', false : \'icon-seek\'}[active === \'tab.seek\']"></i> 觅境 </a> <a class="tab-item" ui-sref-active="active" ui-sref="tab.my" nav-transition="none"> <i class="icon" ng-class="{true: \'icon-my-click\', false : \'icon-my\'}[active === \'tab.my\']"></i> 我的 </a> </div> '),a.put("app/common/templates/login.html",'<ion-modal-view class="tmmLogin"> <ion-content class="padding" scroll="false"> <div class="navbar"><div class="loginTitle"><span ng-click="cancel()" class="tmm-login-back icon-back-arrow"></span>{{title}}</div></div> <div class="tmm-acc-login-wrap" ng-if="isAccLogin"> <div class="list list-inset"> <label class="item item-input"> <input type="text" placeholder="请输入手机号" ng-model="accModel.phone"> </label> <label class="item item-input"> <input type="password" placeholder="请输入密码" ng-model="accModel.password"> </label> </div> <div class="list list-inset list-button"> <button class="button button-block acc-login-button" ng-click="accLogin()"> 登录 </button> </div> </div> <div class="tmm-acc-login-wrap" ng-if="!isAccLogin"> <div class="list list-inset"> <label class="item item-input"> <input type="text" placeholder="请输入手机号" ng-model="mobModel.phone"> </label> <div class="item item-input-inset"> <label class=""> <input type="text" placeholder="请输入短信验证码" ng-model="mobModel.code"> </label> <button class="login-code" ng-class="{\'gray\': disable}" ng-click="getMsgCode()">{{txt}}</button> </div> </div> <div class="list list-inset list-button"> <button class="button button-block acc-login-button" ng-click="mobLogin()"> 登录 </button> </div> </div> <div class="login" ng-style="loginStyle"> <a class="acc-login" href="javascript:;" ng-click="showLogin(1)">帐号密码登录</a> <a class="mob-login" href="javascript:;" ng-click="showLogin(2)">手机号快捷登录</a> </div> </ion-content> </ion-modal-view>'),a.put("app/fresh/templates/fresh-item.html",'<ion-view animation="no-animation" hide-tabs> <navbar back title="{{name}}"></navbar> <ion-content> <iframe ng-if="isWeixin" style="height: 100%;width:100%" allowfullscreen ng-src="{{link}}" frameborder="0"> </iframe> </ion-content> </ion-view>'),a.put("app/fresh/templates/fresh.html",'<ion-view animation="no-animation" hide-nav-bar="true" view-title="田觅觅"> <ion-content class="iframe"> <iframe id="mainfresh" ng-if="isWeixin" allowfullscreen ng-src="{{link}}" frameborder="0" class="ng-scope" style="height: 100%;width: 100%"> </iframe> <div class="empty"></div> </ion-content> </ion-view>'),a.put("app/index/templates/fresh-list.html",' <ion-view hide-tabs> <navbar back class="beyond-nav" title="{{name}}"></navbar> <ion-content class="index-list" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <load-icon ng-if="!model.list_data"></load-icon> <div ng-repeat="item in model.list_data" class="media-card"> <draw-img ng-style="imgStyle" ng-click="goFresh(item.name, item.name, item.img, item.link)" class="img" src="{{item.img}}"></draw-img> <div class="intro"> <div class="tit" ng-bind-html="item.name | trustHtml"></div> <div class="txt"><span><i class="icon-grass"></i>原产地：{{item.info}}</span></div> </div> </div> <div class="empty"></div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view>'),a.put("app/index/templates/fresh-subject.html",' <ion-view hide-tabs> <navbar back title="{{name}}"></navbar> <ion-content class="index"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <load-icon ng-if="!model.list_data"></load-icon> <div class="hotsell hotselllist"> <div class="box-img"> <div class="box-item" ng-repeat="item in model.list_data"> <img ui-sref="tab.fresh-list({link: item.link, name: item.name})" class="hot-img" ng-src="{{item.img}}" ng-style="imgStyle"> </div> </div> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/index/templates/index-subject-item.html",'<div class="media-card"> <img class="img" ng-style="imgStyle" ng-src="{{item.image}}" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value})"> <div class="intro" ng-transclude> </div> </div> '),a.put("app/index/templates/index.html",'<ion-view animation="no-animation" bar-class="index-nav"> <ion-content class="index no-top"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <slider class="banner" spacetime="3000"> <slider-item ng-click="goBannerDetail(item.link_type.value, item.link, item.name, item.img)" ng-repeat="item in model.banner" img-src="item.img" last="$last" first="$first"></slider-item> </slider> <div class="hotsell hotsellpos"> <div class="title"> <div class="tit">精挑细选<span class="disc">为你寻觅大自然里的好味道</span></div> <span ui-sref="tab.fresh-subject" class="more" ng-if="model.hotsell.length > 4 ">更多</span></div> <div class="fresh-img" ng-style="freshStyle"> <draw-small-img ng-repeat="item in model.hotsell| limitTo:4" src="{{item.img}}" ui-sref="tab.fresh-list({link: item.link, name: item.name})" index="{{$index}}"></draw-small-img> </div> </div> <div class="hotact" ng-if="model.hotact.length"> <div class="title"> <div class="tit">拒绝平凡<span class="disc">给你专属的深度趣味体验</span></div> <span ui-sref="tab.interest-subject" class="more" ng-if="model.hotact.length > 1">更多</span></div> <div ui-sref="tab.interest-list({link:item.link, name: item.name})" ng-repeat="item in model.hotact | limitTo:1" class="box-img"> <img class="img" ng-style="seekStyle" ng-src="{{item.img}}"> <div class="intro"> <div class="tit">{{item.name}}</div> <div class="txt">{{item.info}}</div> </div> </div> </div> <div class="circumtour"> <div class="title"> <div class="tit">远离城市<span class="disc">还你最原始纯净的蓝天</span></div> </div> <div ui-sref="tab.seek-list({link:item.link, name: item.name})" ng-repeat="item in model.circumtour" class="box-img"> <img class="img" ng-style="seekStyle" ng-src="{{item.img}}"> <div class="intro"> <div class="tit">{{item.name}}</div> <div class="txt">{{item.count +\'个热门旅行线路推荐\'}} <span ng-if="item.distance">&nbsp;&nbsp;{{\'距离\' + item.distance}}</span></div> </div> </div> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> <div class="tabbar-empty"></div> </ion-content> <em ui-sref="tab.search" class="index-search icon-r-search"></em> </ion-view> '),a.put("app/index/templates/interest-list.html",' <ion-view hide-tabs> <navbar back title="{{name}}"></navbar> <ion-content class="index-list" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <load-icon ng-if="!model.list_data"></load-icon> <div ng-repeat="item in model.list_data" class="media-card"> <draw-img class="img" src="{{item.image}}" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value})"></draw-img> <div class="intro"> <div class="tit">{{item.name}}</div> <div class="info">{{item.info}}</div> <div class="txt"><span><i class="icon-people"></i>{{item.actives.number.value - item.actives.order_number.value}}人报名</span><span><i class="icon-car"></i>{{item.actives.actives_time.value ? item.actives.actives_time.go_time + \'出游\': item.actives.actives_time.go_time }}</span><span ng-if="item.distance"><i class="icon-distance"></i>距离{{item.distance.substring(0, item.distance.indexOf(\'.\')) + \'km\'}}</span></div> <span class="state" ng-class="item.actives.actives_status.value == \'1\' ? \'orange\':\'brown\'">{{item.actives.actives_status.name}}</span> </div> </div> <div class="empty"></div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/index/templates/interest-subject.html",' <ion-view hide-tabs> <navbar back title="{{name}}"></navbar> <ion-content class="index"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <load-icon ng-if="!model.list_data"></load-icon> <div class="hotact hotactlist"> <div ui-sref="tab.interest-list({link:item.link, name:item.name})" ng-repeat="item in model.list_data" class="box-img"> <img class="img" ng-style="seekStyle" ng-src="{{item.img}}"> <div class="intro"><div class="tit">{{item.name}}</div><div class="txt">{{item.info}}</div></div> </div> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"></ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/index/templates/seek-list.html",' <ion-view hide-tabs> <navbar back title="{{name}}"></navbar> <ion-content class="index-list" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <load-icon ng-if="!model.list_data"></load-icon> <div ng-repeat="item in model.list_data" class="media-card"> <draw-img class="img" ng-style="imgStyle" src="{{item.image}}" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value})"></draw-img> <div class="intro"> <div class="tit">{{item.name}}</div> <div class="info">{{item.info}}</div> <div class="txt"><span ng-if="item.distance"><i class="icon-distance"></i>距离{{item.distance}}</span></div> </div> </div> <div class="empty"></div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view>'),a.put("app/items/templates/eat.html",'<ion-view cache-view="false" hide-tabs> <navbar back title="{{info.name}}"> <div class="right"> <i ng-if="!isWeixin" class="icon-redshare" ng-click="doShare()"></i> <i class="icon-infor" ng-click="openPopover($event)"></i> </div> </navbar> <ion-content class="tmm-eat-detail-content"> <div class="item-edit-content" data-ng-bind-html="contentHTML"></div> </ion-content> </ion-view> '),
a.put("app/items/templates/item-intro.tpl.html",'<ion-popover-view class="item-intro"> <ion-content> <div class="item-banner"> <slider ratio="0.9"> <slider-item ng-repeat="imgdetail in info.img_arr" img-src="imgdetail" last="$last"></slider-item> </slider> </div> <ion-list class="tmm-eat-detail-list"> <div class="cell"> <div class="tit">开放时间</div> <div class="intro">{{info.start_work}}&nbsp;-&nbsp;{{info.end_work}}</div> </div> <div class="cell"> <div class="tit">地址</div> <div class="intro-location">{{info.address}} <div class="location" ng-if="disMap && info.distance" ng-click="showMapItemView(\'{{info.address_arr.city}}\',\'{{info.address}}\',\'{{info.lng}}\',\'{{info.lat}}\')"> <img src="images/location.7b82251d.png"> <span>{{info.distance}}</span> </div> </div> </div> <div class="cell"> <div class="tit">联系电话</div> <div class="intro" ng-click="btnClick || detailCall()"><i class="icon-detailPhone"></i>{{info.phone}}</div> </div> <div class="cell"> <div class="tit">微信</div> <div class="intro">{{info.weixin}}</div> </div> <div class="cell" ng-if="info.free_status.value == 0"> <div class="tit">费用</div> <div class="intro">免费</div> </div> <div class="cell fee-cell" ng-if="info.free_status.value == 1"> <div class="tit">费用</div> <div class="intro fee"> <div class="fee-item" ng-repeat="infoContent in info.fare"> <ul> <li>{{infoContent.name}}</li> <li ng-if="info.item_type.value != 2">{{infoContent.info}}</li> <li ng-if="info.item_type.value == 2">{{infoContent.number | room}}</li> <li>{{infoContent.price}} 元</li> </ul> </div> </div> </div> <div class="cell servie" ng-if="info.item_type.value == 2"> <div class="tit">酒店服务</div> <div class="intro servie-intro"> <span ng-repeat="hotelInfo in info.wifi">{{hotelInfo.name}}</span> </div> </div> </ion-list> </ion-content> </ion-popover-view> '),a.put("app/items/templates/live.html",' <ion-view cache-view="false" hide-tabs> <navbar back title="{{info.name}}"> <div class="right"> <i ng-if="!isWeixin" class="icon-redshare" ng-click="doShare()"></i> <i class="icon-infor" ng-click="openPopover($event)"></i> </div> </navbar> <ion-content class="tmm-eat-detail-content"> <div class="item-edit-content" data-ng-bind-html="contentHTML"></div> </ion-content> </ion-view> '),a.put("app/items/templates/play.html",' <ion-view cache-view="false" hide-tabs> <navbar back title="{{info.name}}"> <div class="right"> <i ng-if="!isWeixin" class="icon-redshare" ng-click="doShare()"></i> <i class="icon-infor" ng-click="openPopover($event)"></i> </div> </navbar> <ion-content> <div class="item-edit-content" data-ng-bind-html="contentHTML"></div> </ion-content> </ion-view> '),a.put("app/login/templates/login.html",'<ion-view view-title="登录" hide-nav-bar="true" hide-tabs="true"> <div class="tmm-login-nav"> <nav class="login"> <a class="acc-login" href="javascript:;" ng-click="showLogin(1)">帐号密码登录</a> <a class="mob-login" href="javascript:;" ng-click="showLogin(2)">手机号快捷登录</a> </nav> </div> <ion-content class="padding" scroll="false"> <div class="tmm-acc-login-wrap" ng-show="accLoginShow"> <div class="list list-inset"> <label class="item item-input"> <input type="text" placeholder="请输入手机号" ng-model="loginModel.phone"> </label> <label class="item item-input"> <input type="password" placeholder="请输入密码" ng-model="loginModel.password"> </label> </div> <div class="list list-inset list-button"> <button class="button button-block acc-login-button" ng-click="accLogin()"> 登录 </button> </div> </div> <div class="tmm-acc-login-wrap" ng-show="mobileLogin"> <div class="list list-inset"> <label class="item item-input"> <input type="text" placeholder="请输入手机号" ng-model="mobLoginModel.phone"> </label> <div class="item item-input-inset"> <label class="item-input-wrapper"> <input type="text" placeholder="请输入图形验证码" ng-model="mobLoginModel.verifycode"> </label> <img class="tmm-verifycode-img" src="{{mobLoginData.verifyCodeUrl}}" ng-click="showMobileVerifyCode()"> </div> <div class="item item-input-inset"> <label class="item-input-wrapper"> <input type="text" placeholder="请输入短信验证码" ng-model="mobLoginModel.msgcode"> </label> <button class="login-code" ng-disabled="canSend()" ng-click="getMsgCode()">{{mobLoginData.codeText}}</button> </div> </div> <div class="list list-inset list-button"> <button class="button button-block acc-login-button" ng-click="mobLogin()"> 登录 </button> </div> </div> <a href="javascript:;" class="tmm-login-back icon-back-arrow" ui-sref="tab.my" nav-direction="back"> </a> </ion-content> </ion-view> '),a.put("app/my/templates/linkman.html",'<ion-view view-title="{{title}}" hide-tabs> <navbar back title="{{title}}"> <div class="right"> <i class="icon-deleteman" ng-if="type == 3" ng-click="deleteman()"></i> </div> </navbar> <ion-content class="linkman" over-scroll="false"> <div class="form"> <div class="cell input"><div class="tit">姓名</div><input ng-model="model.name" type="text" placeholder="必填"></div> <div class="cell input"><div class="tit">身份证</div><input ng-model="model.identity" type="text" placeholder="用于购买保险，平台不会泄漏(必填)"></div> <div class="cell input"><div class="tit">手机号码</div><input ng-model="model.phone" type="tel" placeholder="方便商家联系(必填)"></div> <div class="cell input"><div class="tit">邮箱</div><input type="text" ng-model="model.email" placeholder="{{(type == 0 || type == 1) ? \'必填\' : \'选填\'}}"></div> </div> <div class="f_button"><button class="submit" ng-click="submit()">确认</button></div> </ion-content> </ion-view> '),a.put("app/my/templates/my.html",' <ion-view> <navbar title="我的"></navbar> <ion-content class="tmm-my-content" scroll="false"> <div> <div ng-if="!userInfo" class="login-item" ng-click="login()">快速登录帐号 </div> <div ng-if="userInfo" class="header-item"> <div class="header-wrap" ui-sref="tab.myInfo"> <img class="header-logo" src="images/header.8ce188d4.png"> <div class="header-tel">{{userInfo.phone}}</div> </div> <div class="header-exit" ng-click="logout()">退出</div> </div> <div class="menu-item"> <div class="menu-row"> <div class="col" ui-sref="tab.myorder"> <i class="icon-my-order"></i> <p>我的订单</p> </div> <div class="col" ui-sref="tab.mywallet"> <i class="icon-my-flag"></i> <p>我的钱包</p> </div> <div class="col" ui-sref="tab.myjoinact"> <i class="icon icon-participate-act"></i> <p>我参加的觅趣</p> </div> </div> <div class="menu-row"> <div class="col" ui-sref="tab.mypraise"> <i class="icon-my-praise"></i> <p>我的赞</p> </div> <div class="col" ui-sref="tab.mycreateact"> <i class="icon-launch-act"></i> <p>我发起的觅趣</p> </div> <div class="col" style="display:none"> <i class="icon-my-msg"></i> <p>我的消息</p> </div> </div> </div> <span ng-if="!isWeixin" class="version">版本号：V1.2.7</span> </div> </ion-content> </ion-view> '),a.put("app/my/templates/myInfo.html",'<ion-view hide-tabs> <navbar back title="我的信息"></navbar> <ion-content class="myInfo" over-scroll="false"> <div class="group"> <div class="cell" ng-click="updateNickname()"> <div class="tit">昵称</div> <div class="txt">{{model.userInfo.nickname}}<i class="icon-right-arrow"></i></div> </div> <div class="cell" ng-click="updateGender()"> <div class="tit">性别</div> <div class="txt">{{model.userInfo.gender == 0 ? \'未设置\' : model.userInfo.gender == 1 ? \'男\' : \'女\'}}<i class="icon-right-arrow"></i></div> </div> <div class="cell" ui-sref="tab.updatePhone"> <div class="tit">手机号码</div> <div class="txt">{{model.userInfo.phone}}<i class="icon-right-arrow"></i></div> </div> <div class="cell" ui-sref="tab.updatePwd"> <div class="tit">密码</div> <div class="txt">修改密码<i class="icon-right-arrow"></i></div> </div> </div> <div class="main-title">主要联系人</div> <div class="cell-list"><span class="cell-item" ui-sref="tab.updateLinkman({type: 1, link: attr.view_link})" ng-repeat="attr in model.main_retinueInfo.list">{{attr.name}}</span><span ng-if="!model.main_retinueInfo.list.length" class="cell-item add" ui-sref="tab.updateLinkman({type: 0, link: model.main_retinueInfo.create_link})">添加</span></div> <div class="main-title">随行人员</div> <div class="cell-list"> <div class="wrap"><span class="cell-item" ui-sref="tab.updateLinkman({type: 3, link: attr.view_link})" ng-repeat="attr in model.retinueInfo.list">{{attr.name}}</span><span class="cell-item add" ui-sref="tab.updateLinkman({type: 2, link: model.retinueInfo.create_link})">添加</span></div> </div> </ion-content> </ion-view> '),a.put("app/my/templates/updatePhone.html",'<ion-view hide-tabs> <navbar back title="修改手机号"></navbar> <ion-content class="updatePhone" over-scroll="false"> <div class="formwrap" ng-class="{\'next\':isNext}"> <div class="setPhoneWrap"> <div class="form"> <div class="cell input"> <input ng-model="old.phone" type="text" placeholder="请输入旧手机号"> </div> <div class="cell input"> <input ng-model="old.code" type="text" placeholder="请输入短信验证码"> <div class="codeBtn" ng-class="{\'gray\':disable}" ng-click="getCode(\'old\')">{{txt}}</div> </div> </div> <div class="f_button"> <button class="submit" ng-click="nextStep()">下一步</button> </div> </div> <div class="setPhoneWrap"> <div class="form"> <div class="cell input"> <input ng-model="new.phone" type="text" placeholder="请输入新手机号"> </div> <div class="cell input"> <input ng-model="new.code" type="text" placeholder="请输入短信验证码"> <div class="codeBtn" ng-class="{\'gray\':disable}" ng-click="getCode(\'new\')">{{txt}}</div> </div> </div> <div class="f_button"> <button class="submit" ng-click="submit()">确认</button> </div> </div> </div> </ion-content> </ion-view> '),a.put("app/my/templates/updatePwd.html",'<ion-view hide-tabs> <navbar title="设置密码" back></navbar> <ion-content over-scroll="false"> <div class="form"> <div class="cell input"><input readonly ng-model="model.phone" type="text" placeholder="手机号"></div> <div class="cell input"><input ng-model="model.code" type="text" placeholder="输入验证码"><div class="codeBtn" ng-class="{\'gray\':disable}" ng-click="getCode()">{{txt}}</div></div> <div class="cell input"><input ng-model="model.pwd" type="password" placeholder="请输入密码"></div> <div class="cell input"><input type="password" ng-model="model.comfirmPwd" placeholder="确认新密码"></div> </div> <div class="f_button"><button class="submit" ng-click="submit()">确认</button></div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/edit-act-name.html",'<ion-view hide-tabs="true"> <navbar title="觅趣名称" back></navbar> <ion-content> <div class="tmm-edit-act"> <div class="edit-title"> <input required class="content-txt title-width" type="text" placeholder="{{name}}" ng-model="model.editactname"> </div> <span class="card-btn" ng-click="editName()">完成</span> </div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/edit-act-num.html",'<ion-view hide-tabs="true"> <navbar title="觅趣参与人数" back></navbar> <ion-content> <div class="tmm-edit-act"> <div class="edit-title"> <input required class="content-txt num-width" type="text" placeholder="{{num}}" ng-model="model.editactnum">&nbsp;&nbsp;人 </div> <span class="card-btn" ng-click="editNum()">完成</span> </div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/edit-tour-price.html",'<ion-view hide-tabs="true"> <navbar title="服务费" back></navbar> <ion-content> <div class="tmm-edit-act"> <div class="edit-title"> <input required class="content-txt num-width" type="text" placeholder="{{tourprice}}" ng-model="model.edittourprice">&nbsp;&nbsp;元 </div> <span class="card-btn" ng-click="editTourPrice()">完成</span> </div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/my-create-act.html",'<ion-view hide-tabs="true"> <navbar title="我发起的觅趣" back> <div class="right"> <i class="icon-add-act add-act-pos" ui-sref="tab.mysponsoract_1"></i> </div> </navbar> <ion-content overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-order-list"> <createact-item></createact-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/my-createact-detail.html",'<ion-view hide-tabs="true"> <navbar title="觅趣详情" back></navbar> <ion-content class="tmm-createact-detail"> <div class="page-content"> <div class="seekfun-banner"> <img ng-src="{{model.image}}" ng-if="model.image != \'\'" class="commond_bg"> <img src="images/defaultbig.6161dd37.jpg" ng-if="model.image == \'\'" class="commond_bg"> <div class="seekfun-tabs"> <span class="tab-item journery" ng-class="{\'active\':selType == 1}" ng-click="showTabs(1)">行程</span> <span class="tab-item join" ng-class="{\'active\':selType == 2}" ng-click="showTabs(2)">参与人</span> <span class="tab-item intro" ng-class="{\'active\':selType == 3}" ng-click="showTabs(3)">概要</span> </div> </div> <div ng-if="selType === 1"> <div class="journery-block"> <div class="seekfun-item"> <div class="day-tit" ng-repeat-start="(key,value) in model.items_fare" ng-if="key%2"> <div class="tit">{{key | formatDay}}</div> </div> <div class="day-list" ng-repeat-end ng-repeat="list in value"> <div class="day-con" ng-repeat="(key2, attr) in list"> <div class="day-item" ng-repeat="attr1 in attr.fare"> <span class="img"> <i ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i> </span> <div class="describe"> <div class="tit">{{attr.name}}</div> <div class="txt">{{attr1.name}} 　{{attr.classliy.value==2?(attr1.room_number | room):attr1.info}}　￥{{attr1.price}}</div> </div> </div> </div> </div> </div> </div> <div class="join-block"> <p style="text-align: center;margin-top: 20px">您还没有参与人哦！</p> </div> </div> <div ng-if="selType == 2"> <div ng-if="participantNum == 1"> <div class="join-first-item"> <p class="txt" ng-if="model.actives_pay_type.value == \'1\'">已参与人数：<span>{{orderModel.people}}成人 {{orderModel.children}}儿童</span></p> <div ng-if="model.actives_pay_type.value == \'0\'"> <p class="txt">已参与人数：<span>{{model.actives_info.number.value - model.actives_info.order_number.value}}/{{model.actives_info.number.value}}</span></p> <p class="txt">费用总额：<span>{{model.actives_info.total.value}}元</span></p> </div> <span ng-click="shareFriend()" class="share-invite invite">邀请好友参加</span> </div> <div ng-if="model.actives_pay_type.value == \'1\'"> <div class="join-list"> <div ng-repeat="participant in orderListModel track by $index"> <div ng-if="participant.is_main == 1"> <div class="join-item" style="margin:0px"> <div class="item-top item-pepole"> <span class="time">主要联系人</span> </div> <div class="item-inner"> <p class="tit"><span class="name">{{participant.name}}</span></p> <p class="describe"><span class="join-num">手机：{{participant.phone}}</span></p> </div> </div> </div> <div ng-if="participant.is_main == 0"> <div class="join-item" style="margin:0px"> <div class="item-top item-pepole"> <span class="time">{{participant.add_time}}</span><span class="delete-join-people" ng-click="deletePepole(participant.deletelink, $index)">删除</span> </div> <div class="item-inner"> <p class="tit"> <span class="name">{{participant.name}}</span> <span class="phone">{{participant.phone}}</span> </p> <p class="describe"> <span class="join-num">参与人数：{{participant.people}}成人</span> <span class="order-price" ng-if="participant.number - participant.people > \'0\'">{{participant.number - participant.people}}儿童</span> </p> </div> </div> </div> </div> </div> </div> <div ng-if="model.actives_pay_type.value ==\'0\'"> <div class="join-list"> <div ng-repeat="participant in orderListModel"> <div class="join-item"> <div class="item-top item-pepole"> <span class="time">{{participant.add_time}}</span><span class="status green">{{participant.status.order_status.name}}</span> </div> <div class="item-inner"> <p class="tit"> <span class="name">{{participant.main_retinue.name}}</span><span class="phone">{{participant.main_retinue.phone}}</span> </p> <p class="describe"> <span class="join-num">参与人数：{{participant.user_go_count}}人</span> <span class="order-price">订单金额：{{participant.order_price}}元</span> </p> </div> </div> </div> </div> </div> <div class="loadmore" ng-show="loadmore" ng-click="loadMoreParticipant()">点击加载更多</div> </div> <p ng-if="participantNum == 0" class="noParticipant">您还没有参与人哦！</p> </div> <div ng-if="selType == 3"> <div class="intro-block" ng-if="model.audit_status.value == \'-2\' || model.audit_status.value == \'-1\'"> <div class="normal-group"> <div class="normal-cell"> 觅趣名称 </div> <div class="normal-cell" ui-sref="tab.editactname({actname:model.name, actid:model.actives_id})"> <span id="editactname">{{model.name}}</span> <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group tmmGoTime"> <div class="normal-cell"> 出游日期 </div> <div class="normal-cell" ng-click="setActGoTime()"> {{model.actives_time.go_time}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group"> <div class="normal-cell"> 付款方式 </div> <div class="normal-cell" ng-click="editPayType()"> {{model.actives_pay_type.value == \'1\'?\'代付\':\'自费\'}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣报名日期 </div> <div class="normal-cell" ng-click="editEnrolldate()"> {{model.actives_time.start_time}} 至 {{model.actives_time.end_time}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣参与人数 </div> <div class="normal-cell" ui-sref="tab.editactnum({actnum:model.actives_info.number.value, actid:model.actives_id})"> {{model.actives_info.number.value}}人 <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group" ng-if="userInfo.is_organizer == 1 && userInfo.organizer.status != 0"> <div class="normal-cell"> 服务费（交通、导服及其他） </div> <div class="normal-cell" ui-sref="tab.edittourprice({tourprice:model.actives_info.tour_price.value, actid:model.actives_id})"> {{model.actives_info.tour_price.value}}元/人 <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣公开性 </div> <div class="normal-cell" ng-click="editActOpen()"> {{model.actives_is_open.value == \'1\' ? \'公开\':\'私密\'}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </div> <div class="normal-group"> <div class="normal-cell"> 创建日期 </div> <div class="normal-cell"> {{model.actives_time.add_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣简介 </div> <div class="editer-con" ng-bind-html="model.actives_info.remark"> </div> </div> </div> <div class="intro-block" ng-if="model.audit_status.value != \'-2\' && model.audit_status.value != \'-1\'"> <div class="normal-group"> <div class="normal-cell"> 觅趣名称 </div> <div class="normal-cell"> {{model.name}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 出游日期 </div> <div class="normal-cell"> {{model.actives_time.go_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 付款方式 </div> <div class="normal-cell"> {{model.actives_pay_type.value == \'1\'?\'代付\':\'自费\'}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣报名日期 </div> <div class="normal-cell"> {{model.actives_time.start_time}} 至 {{model.actives_time.end_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣参与人数 </div> <div class="normal-cell"> {{model.actives_info.number.value - model.actives_info.order_number.value}}/{{model.actives_info.number.value}}人 </div> </div> <div class="normal-group" ng-if="userInfo.is_organizer == 1 && userInfo.organizer.status != 0"> <div class="normal-cell"> 服务费（交通、导服及其他） </div> <div class="normal-cell"> {{model.actives_info.tour_price.value}}元/人 </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣公开性 </div> <div class="normal-cell"> {{model.actives_is_open.value == \'1\' ? \'公开\':\'私密\'}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 创建日期 </div> <div class="normal-cell"> {{model.actives_time.add_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣简介 </div> <div class="editer-con" ng-bind-html="model.actives_info.remark"> </div> </div> </div> </div> </div> </ion-content> <div class="tmm-act-btn" ng-if="(model.audit_status.value ==\'-1\' && model.actives_status.value ==\'0\' && model.shops_status.value ==\'0\') || (model.audit_status.value ==\'-1\' && model.actives_status.value ==\'\' && model.shops_status.value ==\'0\')"> <span ui-sref="tab.mysponsoract_2({type:\'replaceStroke\', \'actId\':model.actives_id, \'actDetailLink\': detailLink})">更换行程</span> <span ng-click="reviewAct()">提交审核</span> </div> </ion-view> '),a.put("app/mycreateact/templates/my-createact-item.html","<div class=\"order-item\" ng-repeat=\"item in model.list_data\"> <div class=\"con-inner\" ui-sref=\"tab.mycreateactdetail({link:item.link})\"> <div class=\"pic\"> <img ng-src=\"{{item.image}}\" ng-if=\"item.image != ''\"> <img src=\"images/default.e358cff1.jpg\" ng-if=\"item.image == ''\"> </div> <div class=\"describe\"> <p class=\"tit\">{{item.name}}</p> <p class=\"price\"> ￥{{item.price}}起/人 <span ng-if=\"item.audit_status.value =='1'\">&nbsp;参与人数：{{item.actives_info.number.value - item.actives_info.order_number.value}}/{{item.actives_info.number.value}}</span> </p> <p class=\"price\">出游日期： <span ng-if=\"item.go_time_value =='0'\">待定</span> <span ng-if=\"item.go_time_value =='1'\">{{item.go_time}}</span> </p> <p class=\"res\" ng-if=\"(item.audit_status.value =='-2' && item.actives_status.value =='0' && item.shops_status.value =='0') || (item.audit_status.value =='-1' && item.actives_status.value =='0' && item.shops_status.value =='0') || (item.audit_status.value =='-1' && item.actives_status.value =='' && item.shops_status.value =='0')\">审核未通过</p> <p class=\"res\" ng-if=\"(item.audit_status.value =='1' && item.actives_status.value =='0' && item.shops_status.value =='0') || (item.audit_status.value =='1' && item.actives_status.value =='1' && item.shops_status.value =='0') || (item.audit_status.value =='1' && item.actives_status.value =='2' && item.shops_status.value =='0')\">待上线</p> <p class=\"res\" ng-if=\"(item.audit_status.value =='1' && item.actives_status.value =='0' && item.shops_status.value =='1') || (item.audit_status.value =='1' && item.actives_status.value =='0' && item.shops_status.value =='1')\">未开始</p> <p class=\"res\" ng-if=\"item.audit_status.value =='1' && item.actives_status.value =='-1' && item.shops_status.value =='1'\">已取消</p> <p class=\"check\" ng-if=\"item.audit_status.value =='0' && item.actives_status.value =='0' && item.shops_status.value =='0'\">待审核</p> <p class=\"registration-in\" ng-if=\"item.audit_status.value =='1' && item.actives_status.value =='1' && item.shops_status.value =='1'\">报名中</p> <p class=\"registration-end\" ng-if=\"item.audit_status.value =='1' && item.actives_status.value =='2' && item.shops_status.value =='1'\">报名结束</p> </div> </div> <div class=\"act-fail\" ng-if=\"item.audit_status.value =='-1' || item.audit_status.value == '-4'\"> <div class=\"act-fail-title\">审核未通过原因</div> <div class=\"act-fail-res\">{{item.audit_status.info}}</div> </div> <div class=\"footer-pos\"> <div class=\"con-footer\"> <span class=\"outline-button\" ng-click=\"reviewAct('{{item.link}}')\" ng-if=\"(item.audit_status.value =='-2' && item.actives_status.value =='0' && item.shops_status.value =='0') || (item.audit_status.value =='-1' && item.actives_status.value =='0' && item.shops_status.value =='0')\">提交审核</span> <span ng-if=\"(item.audit_status.value =='1' && item.actives_status.value =='0' && item.shops_status.value =='1') || (item.audit_status.value =='1' && item.actives_status.value =='1' && item.shops_status.value =='1')\"> <span class=\"outline-button\" ng-click=\"cancelAct()\">取消觅趣</span> <span class=\"outline-button\" ng-if=\"item.set_go_time.link !== ''\" ng-click=\"setGoTime('{{item.set_go_time.link}}')\">确认出游时间</span> </span> <span class=\"outline-button\" ng-if=\"item.audit_status.value =='1' && item.actives_status.value =='2' && item.shops_status.value =='1' && item.set_go_time.link !=''\" ng-click=\"setGoTime('{{item.set_go_time.link}}')\">确认出游时间</span> <span class=\"outline-button\" ui-sref=\"tab.createactpay({link:item.link, orderlink:item.order.link, orderid:item.order.value, ordertype:item.order.type, gotime:item.go_time_value})\" ng-if=\"item.shops_status.value == 1&& item.audit_status.value == 1 && item.attend.number > 0 && (item.actives_status.value == 1 || item.actives_status.value == 2) && item.actives_info.order_count.value == 0 && item.pay_type.value == 1 && item.order.link\">支付费用</span> </div> </div> </div> "),a.put("app/mycreateact/templates/my-createact-pay.html",'<ion-view hide-tabs="true"> <navbar title="提交订单" back></navbar> <ion-content class="tmm-my-order-detail" overflow-scroll="false"> <div class="main-title">出游日期</div> <div class="main-con" ng-click="selectDate()" ng-if="gotime_value == 0">{{gotime}}</div> <div class="main-con" ng-if="gotime_value == 1">{{gotime}}</div> <div class="main-title">项目列表</div> <div class="order-wrap" ng-class="$first?\'topBottom\':\'\'"> <div class="day" ng-repeat-start="(key,value) in model.items_fare" ng-if="key%2">{{key | formatDay}}</div> <div ng-repeat-end ng-repeat="list in value"> <div class="det-list" ng-repeat="(key2, attr) in list"> <div class="title"> <i class="titicon" ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i>{{attr.name}} </div> <div ng-repeat="attr1 in attr.fare"> <div class="detail line"> <span>{{attr1.name}}</span> <span>{{attr.classliy.value==2?(attr1.room_number | room):attr1.info}}</span> <span>{{attr1.number}}</span> <span>￥{{attr1.price}}</span> </div> </div> </div> </div> </div> <div class="main-title">主要联系人</div> <div class="main-retiune" ng-click="setMainName()"> {{model.actives_info.attend.main.name}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> <div class="main-title">出行人员信息</div> <div class="main-retiune" ui-sref="tab.participant({link:model.actives_info.attend_list})"> 成人{{model.actives_info.attend.people}}，儿童{{model.actives_info.attend.children}} <span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> <div ng-if="userInfo.is_organizer == 1 && model.userInfo.organizer_status != 0"> <div class="main-title">服务费（交通、导服及其他）</div> <div class="main-con">{{model.actives_info.tour_price.value}}元/人</div> </div> <div class="main-title"></div> <div class="main-title"></div> </ion-content> <div class="order-btn"> <span class="price">￥{{total_price}}</span> <span class="btn red" ng-click="actOrderPay()">确认支付</span> </div> </ion-view> '),a.put("app/mycreateact/templates/my-participant-item.html",'<div class="participant-item" ng-repeat="item in model.list_data"> <div class="time">{{item.add_time}}</div> <div class="con"> <div class="title">姓名：{{item.name}}</div> <div class="title">联系电话：{{item.phone}}</div> <div class="title">参与人数：{{item.people}}成人，{{item.children}}儿童</div> </div> </div> '),a.put("app/mycreateact/templates/my-participant.html",'<ion-view hide-tabs="true"> <navbar title="觅趣参与人列表" back></navbar> <ion-content> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-participant-list"> <participant-item></participant-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/mysponsoract_1.html",'<ion-view title="选择出游日期" hide-tabs="true"> <navbar title="选择出游日期" back> <div class="right"> <i class="icon-back-reverse" ng-click="nextStep(1)"></i> </div> </navbar> <div class="act-indicator"><span class="active"></span><span></span><span></span><span></span></div> <ion-content class="mysponsoract"> <div class="calendar"></div> <div class="skip-day"> <div class="tit">还没决定出游日期 <div ng-click="skipStep()" class="btn">跳过</div> </div> <div class="txt">还没决定出游日期？无需担心，您可以先规划行程，后续可添加出游日期。 </div> </div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/mysponsoract_2.html",'<ion-view hide-tabs="true"> <navbar title="{{isReplaceStroke?\'更换行程\':\'选择行程\'}}" back> <div class="right"> <i class="icon-back-reverse" ng-click="nextStep(1)" ng-if="!isReplaceStroke"></i> </div> </navbar> <div class="act-indicator"><span class="active"></span><span class="active"></span><span></span><span></span></div> <div class="subnav"> <div class="tit" ui-sref="tab.destination" ng-click="selectLeft = true" ng-class="{\'active\': selectLeft}"><span>{{model.orientation.value ? model.orientation.value.address_info.name : (model.location.value ? model.location.value.address_info.name : \'选择\')}}</span></div> <div class="tit" ng-class="{\'active\': !selectLeft}" ng-click="selectPopular($event)"><span>{{selectType}}</span></div> </div> <ion-content class="mysponsoract select-tour" delegate-handle="journey-content" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div ng-if="noData" class="noDataMsg">没有数据哦！</div> <div class="cellcard" ng-repeat="item in model.list_data" ng-init="item.isSelected = false"> <div class="innerbody"> <div class="img" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value, hasSub: 1})"><img ng-src="{{item.share_image ? item.share_image : item.image}}"></div> <div class="intro" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value, hasSub: 1})"> <div class="tit">{{item.name}}</div> <div class="txt">￥{{item.price}}起/人 {{item.day_num}}天行程</div> <div class="txt">{{isDistance ? \'距离：\' + item.distance : \'人气：\' + item.brow}}</div> </div> <label class="checkbox"><input type="radio" ng-click="selectItem(item.value)" name="select"></label> </div> </div> <div>{{checkedItem}}</div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> <div class="tmm-act-btn" ng-if=\'isReplaceStroke == "replaceStroke"\'> <span ng-click="changeLine()">确认更换行程</span> </div> </ion-view> '),a.put("app/mycreateact/templates/mysponsoract_3.html",'<ion-view hide-tabs="true" cache-view="false"> <navbar title="选择付款方式" back></navbar> <div class="act-indicator"><span class="active"></span><span class="active"></span><span class="active"></span><span></span></div> <ion-content class="mysponsoract"> <div ng-click="selectPayType(1)" class="pay-type"> <div class="pay-cir">代付</div> <div class="pay-info">发起人统一支付费用</div> </div> <div ng-click="selectPayType(0)" class="pay-type aa-type"> <div class="pay-cir">自费</div> <div class="pay-info">参与人自己支付费用</div> </div> </ion-content> </ion-view> '),a.put("app/mycreateact/templates/mysponsoract_4.html",'<ion-view hide-tabs="true" cache-view="false"> <navbar title="填写觅趣信息" back></navbar> <div class="act-indicator"><span class="active"></span><span class="active"></span><span class="active"></span><span class="active"></span></div> <ion-content class="mysponsoract"> <div class="input-cell"> <div class="tit">觅趣名称：</div> <input class="input-txt" ng-model="model.name" type="text"> </div> <div class="input-cell"> <div class="tit">报名开始与结束：</div> <input class="input-txt" ng-click="selectedDate()" ng-model="model.time" readonly placeholder="年/月/日 >" type="text"> </div> <div class="input-cell"> <div class="tit">觅趣参与人数：</div> <input class="input-txt" ng-model="model.number" type="tel">人</div> <div ng-if="model.userInfo.is_organizer === \'1\' && model.userInfo.organizer.status !== \'0\'" class="input-cell"> <div class="tit">服务费</div> <input class="input-txt" ng-model="model.tour_price" type="tel">元/人</div> <div class="input-cell"> <div class="tit">觅趣公开性：</div> <label class="input-txt"> <input class="checkbox" ng-model="model.is_close" type="checkbox"><span>私密</span> </label> </div> <div class="mark"><span>注：</span>私密觅趣需要发起人邀请参与人加入</div> <div class="act-edit"> <p class="intro">觅趣简介：</p> <textarea ng-model="model.remark" class="act-edit-content" rows="5"></textarea> </div> <div class="f_button"> <div class="submit" ng-click="submit()">完成</div> </div> </ion-content> </ion-view> '),
a.put("app/myjoinact/templates/my-join-act.html",'<ion-view hide-tabs="true"> <navbar back> <div class="title act-title"> <span class="title-type"> <span ng-click="showTab(1)" ng-class="{\'active\':isPayType == 1}">自费</span> <span ng-click="showTab(2)" ng-class="{\'active\':isPayType == 2}">代付</span> </span> </div> </navbar> <ion-content overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-order-list"> <joinact-item></joinact-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/myjoinact/templates/my-joinact-actType.html",'<ion-popover-view class="act-popover"> <ion-content> <ul> <li ng-click="showTab(1)">自费</li> <li ng-click="showTab(2)">代付</li> </ul> </ion-content> </ion-popover-view> '),a.put("app/myjoinact/templates/my-joinact-detail.html",'<ion-view hide-tabs="true"> <navbar title="觅趣详情" back></navbar> <ion-content class="tmm-createact-detail" overflow-scroll="false"> <div class="page-content"> <div class="seekfun-banner"> <img ng-src="{{model.image}}" ng-if="model.image != \'\'" class="commond_bg"> <img src="images/defaultbig.6161dd37.jpg" ng-if="model.image == \'\'" class="commond_bg"> <div class="seekfun-tabs"> <span class="tab-item journery" ng-class="{\'active\':selType == 1}" ng-click="showTabs(1)">行程</span> <span class="tab-item join" ng-class="{\'active\':selType == 2}" ng-click="showTabs(2)">参与人</span> <span class="tab-item intro" ng-class="{\'active\':selType == 3}" ng-click="showTabs(3)">概要</span> </div> </div> <div ng-if="selType == 1"> <div class="journery-block"> <div class="seekfun-item"> <div class="day-tit" ng-repeat-start="(key,value) in model.items_fare" ng-if="key%2"> <div class="tit">{{key | formatDay}}</div> </div> <div class="day-list" ng-repeat-end ng-repeat="list in value"> <div class="day-con" ng-repeat="(key2, attr) in list"> <div class="day-item" ng-repeat="attr1 in attr.fare"> <span class="img"> <i class="icon-order-eat" ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i> </span> <div class="describe"> <div class="tit">{{attr.name}}</div> <div class="txt">{{attr1.name}} 　{{attr.classliy.value==2?(attr1.room_number | room):attr1.info}}　￥{{attr1.price}}</div> </div> </div> </div> </div> </div> </div> <div class="join-block"> <p style="text-align: center;margin-top: 20px">您还没有参与人哦！</p> </div> </div> <div ng-if="selType == 2"> <div ng-if="model.is_me == \'1\'"> <div class="join-first-item"> <p class="txt" ng-if="model.actives_pay_type.value == \'1\'">已参与人数：<span>{{orderModel.people}}成人 {{orderModel.children}}儿童</span></p> </div> <div class="join-list"> <div ng-repeat="participant in orderListModel track by $index"> <div ng-if="participant.is_main == 1"> <div class="join-item" style="margin:0px"> <div class="item-top item-pepole"> <span class="time">主要联系人</span> </div> <div class="item-inner"> <p class="tit"><span class="name">{{participant.name}}</span></p> <p class="describe"><span class="join-num">手机：{{participant.phone}}</span></p> </div> </div> </div> <div ng-if="participant.is_main == 0"> <div class="join-item" style="margin:0px"> <div class="item-top item-pepole"> <span class="time">{{participant.add_time}}</span> </div> <div class="item-inner"> <p class="tit"> <span class="name">{{participant.name}}</span> <span class="phone">{{participant.phone}}</span> </p> <p class="describe"> <span class="join-num">参与人数：{{participant.people}}成人</span> <span class="order-price" ng-if="participant.number - participant.people > 0">{{participant.number - participant.people}}儿童</span> </p> </div> </div> </div> </div> </div> </div> <div ng-if="model.is_me == \'0\'"> <div class="join-first-item join-act-first"> <p class="txt">已参与人数：<span>{{model.actives_info.attend_list.people}}成人 {{model.actives_info.attend_list.children}}儿童</span></p> <p class="txt">报名时间：<span>{{model.add_time}}</span></p> </div> <div class="join-list"> <div class="join-item"> <div class="item-pepole"> <span class="people-tit">主要联系人</span> </div> <div class="item-inner-pepole"> <p class="people-tit"> <span class="name">{{model.actives_info.attend_list.name}}</span><span class="phone">{{model.actives_info.attend_list.phone}}</span> </p> </div> <div ng-if="model.actives_info.attend_list.children > 0"> <div class="item-pepole"> <span class="people-tit">随行人</span> </div> <div class="item-inner-pepole"> <p class="people-tit b-border" ng-repeat="son in model.actives_info.attend_list.son"><span class="name">{{son.name}}</span><span class="phone">{{son.phone}}</span><span class="people-type">{{son.is_people.name}}</span></p> </div> </div> </div> </div> </div> <div class="loadmore" ng-show="loadmore" ng-click="loadMoreParticipant()">点击加载更多</div> </div> <div ng-if="selType == 3"> <div class="intro-block"> <div class="normal-group"> <div class="normal-cell"> 觅趣名称 </div> <div class="normal-cell"> {{model.name}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 出游日期 </div> <div class="normal-cell"> {{model.actives_time.go_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 付款方式 </div> <div class="normal-cell"> {{model.actives_pay_type.value == \'1\'?\'代付\':\'自费\'}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣报名日期 </div> <div class="normal-cell"> {{model.actives_time.start_time}} 至 {{model.actives_time.end_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣参与人数 </div> <div class="normal-cell"> {{model.actives_info.number.value - model.actives_info.order_number.value}}/{{model.actives_info.number.value}}人 </div> </div> <div class="normal-group" ng-if="userInfo.is_organizer == 1 && userInfo.organizer.status != 0"> <div class="normal-cell"> 服务费（交通、导服及其他） </div> <div class="normal-cell"> {{model.actives_info.tour_price.value}}元/人 </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣公开性 </div> <div class="normal-cell"> {{model.actives_is_open.value == \'1\' ? \'公开\':\'私密\'}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 创建日期 </div> <div class="normal-cell"> {{model.actives_time.add_time}} </div> </div> <div class="normal-group"> <div class="normal-cell"> 觅趣简介 </div> <div class="editer-con" ng-bind-html="model.actives_info.remark | trustHtml"></div> </div> </div> </div> </div> </ion-content> <div class="tmm-act-btn" ng-if="model.delete.value !=\'\'"> <span ng-click="orderEnterCancle({{model.delete.value}})">取消报名</span> </div> </ion-view> '),a.put("app/myjoinact/templates/my-joinact-item.html",' <div ng-if="isPayType == 1"> <div class="order-item" ng-repeat="item in model.list_data"> <div class="con-inner" ui-sref="tab.myorderdetail_{{item.status.order_type.value}}({link:item.link})"> <div class="pic"> <img ng-src="{{item.shops_img}}"> </div> <div class="describe"> <p class="tit">{{item.shops_name}}</p> <p class="price">出游日期：{{item.go_time}}</p> <p class="price">价格：{{item.order_price}}元</p> </div> <div class="order-status"> <span ng-class="{\'pending\':item.actives_status.value ==\'0\', \'payment\':item.actives_status.value ==\'1\', \'consumption\':item.actives_status.value ==\'2\', \'cancel\':item.actives_status.value ==\'-1\'}">{{item.actives_status.name}}</span> </div> </div> <div class="footer-pos"> <div class="con-footer" ng-if="item.status.centre_status.value ==\'0\'"> <span class="outline-button" ng-click="orderPay({{item.value}},3, {{item.order_price}})">去支付</span> </div> <div class="con-footer" ng-if="(item.status.centre_status.value ==\'-1\') && (item.status.status_go.value ==\'0\')"> <span class="outline-button" ng-click="orderCancle({{item.value}})">取消报名</span> </div> <div class="con-footer" ng-if="item.status.centre_status.value ==\'-1\' && item.status.status_go.value ==\'1\'"> <span class="outline-button" ng-click="orderCancle({{item.value}})">取消报名</span> <span class="outline-button" ng-if="item.go_time !== \'出游日期未定\'" ng-click="orderTourConfirm({{item.value}})">确认出游</span> </div> <div class="con-footer" ng-if="(item.status.centre_status.value ==\'-1\') && (item.status.order_status.value ==\'2\')"> <span class="outline-button" ng-click="refund()">申请退款</span> </div> </div> </div> </div> <div ng-if="isPayType == 2"> <div class="order-item" ng-repeat="item in model.list_data"> <div class="con-inner" ui-sref="tab.myjoinactdetail({link:item.link})"> <div class="pic"> <img ng-src="{{item.shops_img}}"> </div> <div class="describe"> <p class="tit">{{item.shops_name}}</p> <p class="price">出游日期：{{item.actives_time.go_time}}</p> <p class="price">成人：{{item.people}}人&nbsp;&nbsp;儿童{{item.children}}人</p> </div> <div class="order-status"> <span ng-class="{\'pending\':item.actives_status.value ==\'0\', \'payment\':item.actives_status.value ==\'1\', \'consumption\':item.actives_status.value ==\'2\', \'cancel\':item.actives_status.value ==\'-1\'}">{{item.actives_status.name}}</span> </div> </div> <div class="footer-pos"> <div class="con-footer" ng-if="item.is_me ==\'1\' && item.actives_time.go_time_value == \'0\' && item.actives_status.value !== \'-1\' && item.actives_status.value !== \'2\'"> <span class="outline-button" ng-click="setGoTime(\'{{item.actives_time.set_go_time.link}}\')">确认出游日期</span> </div> <div class="con-footer" ng-if="item.delete.value != \'\' && item.status.value == \'1\' && item.actives_status.value != \'-1\'"> <span class="outline-button" ng-click="orderEnterCancle({{item.value}})">取消报名</span> </div> </div> </div> </div> '),a.put("app/myorder/templates/my-dot-order-detail.html",'<ion-view hide-tabs="true"> <navbar title="订单详情" back></navbar> <ion-content class="tmm-my-order-detail"> <div class="main-title">出游日期</div> <div class="main-con">{{model.go_time}}</div> <div class="main-title">项目列表</div> <div class="order-wrap"> <div class="det-list" ng-repeat="attr in model.items_fare"> <div class="title"> <i class="titicon" ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i>{{attr.name}} <span class="free" ng-if="attr.free_status.value ==\'0\'">此项目免费</span> <i class="code" ng-click="showCode(attr.barcode.link,attr.barcode.is_barcode)" ng-if="attr.free_status.value !=\'0\'" ng-class="{\'icon-code\': attr.barcode.is_barcode != 1, \'icon-red-code\': attr.barcode.is_barcode == 1}"></i> </div> <div ng-if="attr.free_status.value !=\'0\'" ng-repeat="attr1 in attr.fare"> <div class="room" ng-if="attr1.room_number != \'0\'">{{attr1.start_date}}-{{attr1.end_date}} (住{{attr1.hotel_number}}晚)</div> <div class="detail" ng-class="{\'line\':attr1.room_number == \'0\'}"> <span>{{attr1.name}}</span> <span>{{attr.classliy.value==2?(attr1.room_number | room):attr1.info}}</span> <span>{{attr1.number}}</span> <span>￥{{attr1.count}}</span> </div> </div> </div> </div> <div class="main-title">主要联系人</div> <div class="main-con" ng-repeat="retinue in model.retinue" ng-if="retinue.is_main == 1">{{retinue.name}}</div> <div ng-if="hasRetinue == 1"> <div class="main-title">随行人员</div> <div class="main-con row"> <span class="entourage" ng-repeat="retinue in model.retinue" ng-if="retinue.is_main != 1">{{retinue.name}}</span> </div> </div> <div class="main-title">订单状态</div> <div class="main-con">订单编号：{{model.order_no}}</div> <div class="main-title"></div> <div class="mian-con-det">索取发票请拨打电话: 400-019-7090</div> <div class="main-title"></div> <div class="main-title"></div> </ion-content> <div class="order-btn" ng-if="model.status.centre_status.value ==\'0\'"> <span class="price">￥{{model.order_price.value}}</span> <span class="btn red" ng-click="orderPay({{model.value}}, {{model.order_price.value}})">确认支付</span> <span class="btn gray" ng-if="model.status.centre_status.value ==\'-1\' && model.status.order_status.value ==\'0\'">等待确认</span> </div> <div class="order-btn" ng-if="model.status.centre_status.value ==\'-1\' && model.status.order_status.value ==\'0\'"> <span class="price">￥{{model.order_price.value}}</span> <span class="btn gray">等待确认</span> </div> </ion-view> '),a.put("app/myorder/templates/my-line-order-detail.html",'<ion-view hide-tabs="true"> <navbar title="订单详情"> <div class="left"> <i class="icon-back" nav-back="back" ng-if="actback == 0"></i> <i class="icon-back" ui-sref="tab.mycreateact" ng-if="actback == 1"></i> </div> </navbar> <ion-content class="tmm-my-order-detail"> <div class="main-title">出游日期</div> <div class="main-con">{{model.go_time}}</div> <div class="main-title">项目列表</div> <div class="order-wrap" ng-class="$first?\'topBottom\':\'\'"> <div class="day" ng-repeat-start="(key,value) in model.items_fare" ng-if="key%2">{{key | formatDay}}</div> <div ng-repeat-end ng-repeat="list in value"> <div class="det-list" ng-repeat="attr in list"> <div class="title"> <i class="titicon" ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i>{{attr.name}} <span class="free" ng-if="attr.free_status.value ==\'0\'">此项目免费</span> <i class="code" ng-click="showCode(attr.barcode.link,attr.barcode.is_barcode)" ng-if="attr.free_status.value !=\'0\'" ng-class="{\'icon-code\': attr.barcode.is_barcode != 1, \'icon-red-code\': attr.barcode.is_barcode == 1}"></i> </div> <div ng-if="attr.free_status.value !=\'0\'" ng-repeat="attr1 in attr.fare"> <div class="detail line"> <span>{{attr1.name}}</span> <span>{{attr.classliy.value==2?(attr1.room_number | room):attr1.info}}</span> <span>{{attr1.number}}</span> <span>￥{{attr1.count}}</span> </div> </div> </div> </div> </div> <div class="main-title">主要联系人</div> <div class="main-con" ng-repeat="retinue in model.retinue" ng-if="retinue.is_main == 1">{{retinue.name}}</div> <div ng-if="hasRetinue == 1"> <div class="main-title">随行人员</div> <div class="main-con row"> <span class="entourage" ng-repeat="retinue in model.retinue" ng-if="retinue.is_main != 1">{{retinue.name}}</span> </div> </div> <div class="main-title">订单状态</div> <div class="main-con">订单编号：{{model.order_no}}</div> <div class="main-title"></div> <div class="mian-con-det">索取发票请拨打电话: 400-019-7090</div> <div class="main-title"></div> <div class="main-title"></div> </ion-content> <div class="order-btn" ng-if="model.status.centre_status.value ==\'0\'"> <span class="price">￥{{model.order_price.value}}</span> <span class="btn red" ng-click="orderPay({{model.value}}, {{model.order_price.value}})">确认支付</span> <span class="btn gray" ng-if="model.status.centre_status.value ==\'-1\' && model.status.order_status.value ==\'0\'">等待确认</span> </div> <div class="order-btn" ng-if="model.status.centre_status.value ==\'-1\' && model.status.order_status.value ==\'0\'"> <span class="price">￥{{model.order_price.value}}</span> <span class="btn gray">等待确认</span> </div> </ion-view> '),a.put("app/myorder/templates/my-order-item.html",'<div class="order-item"> <div class="con-inner" ui-sref="tab.myorderdetail_{{item.status.order_type.value}}({link:item.link})"> <div class="pic"> <img ng-src="{{item.shops_img}}"> </div> <div class="describe"> <p class="tit">{{item.shops_name}}</p> <p class="price">价格：{{item.order_price}}元</p> </div> <div class="order-status"> <span class="pending" ng-if="item.status.order_status.value ==\'0\' || item.status.order_status.value ==\'1\'">{{item.status.order_status.name}}</span> <span class="payment" ng-if="item.status.order_status.value ==\'2\'">{{item.status.order_status.name}}</span> <span class="consumption" ng-if="item.status.order_status.value ==\'3\' || item.status.order_status.value ==\'-1\'">{{item.status.order_status.name}}</span> <span class="cancel" ng-if="item.status.order_status.value ==\'-1\' || item.status.order_status.value ==\'-2\' || item.status.order_status.value ==\'-3\'">{{item.status.order_status.name}}</span> </div> </div> <div class="footer-pos"> <div class="con-footer" ng-if="item.status.centre_status.value ==\'0\'"> <span class="outline-button" ng-click="orderCancle(item.value)">取消</span> <span class="outline-button" ng-click="orderPay(item.value, item.status.order_type.value, item.order_price)">支付</span> </div> <div class="con-footer" ng-if="(item.status.centre_status.value ==\'-1\') && (item.status.order_status.value ==\'0\' || item.status.order_status.value ==\'1\')"> <span class="outline-button" ng-click="orderCancle(item.value)">取消</span> </div> <div class="con-footer" ng-if="item.status.centre_status.value ==\'-1\' && item.status.order_status.value ==\'2\'"> <span class="outline-button" ng-click="refund()">退款</span> </div> </div> </div> '),a.put("app/myorder/templates/my-order.html",'<ion-view hide-tabs="true"> <navbar back> <div class="title act-title"> <span class="title-type"> <span ng-click="showTab(1)" ng-class="{\'active\':isActive == 1}">觅境</span> <span ng-click="showTab(2)" ng-class="{\'active\':isActive == 2}">觅趣</span> </span> </div> </navbar> <ion-content class="tmm-my-order" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-order-list"> <order-item ng-repeat="item in model.list_data"></order-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/myorder/templates/qr-code.html",'<ion-modal-view> <navbar> <div class="left"><i ng-click="modal.hide()" class="icon-back"></i></div> <div class="title">扫描二维码</div> </navbar> <ion-content class="modal-qr-code has-header"> <div class="qr-code"></div> <div class="csu-code"></div> </ion-content> </ion-modal-view> '),a.put("app/mypraise/templates/my-praise-item.html",'<div class="tmm-recommend-item" ng-repeat="item in model.list_data"> <div class="pic" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value})"> <img ng-src="{{item.image}}"> </div> <div class="txt"> <div class="title">{{item.name}}</div> <div class="info">{{item.info}}</div> <span class="icon-parise-red praise-pos"></span> <span class="type" ng-class="{\'dot\': item.classliy.value==1, \'line\': item.classliy.value==2, \'act\': item.classliy.value==3}">{{item.type.name}}</span> </div> </div> '),a.put("app/mypraise/templates/my-praise.html",'<ion-view hide-tabs> <navbar back title="我的赞"></navbar> <ion-content overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-recommend-list"> <praise-item></praise-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/order/templates/order-act.html",'<ion-view hide-tabs="true"> <navbar back title="觅趣报名"></navbar> <ion-content class="order" overflow-scroll="false"> <div class="main-title">出游日期</div> <div class="cell go-time">出游日期：{{model.go_time.value}}</div> <div class="main-title">出游人数</div> <div class="group"> <div ng-repeat="(key, value) in model.OrderItemsFare" class="cell tournum"><div>{{value.info}}</div><div><span ng-click="subNum(value.info,key)" class="sub-num"></span><span class="num">{{value.number}}</span><span ng-click="addNum(value.info,key)" class="add-num"></span></div></div> </div> <div class="main-title">项目列表</div> <div class="item-wrap"> <div ng-repeat-start="(key1, value1) in model.dot_list" ng-if="key1%2" class="day-title">{{key1 | formatDay}}</div> <div ng-repeat-end ng-repeat="attr1 in value1" class="group line-item"> <div ng-repeat="(key2, value2) in attr1"> <div ng-repeat-start="attr2 in value2" class="cell title"><i class="titicon" ng-class="{\'icon-order-eat\': attr2.classliy.value==1, \'icon-order-live\':attr2.classliy.value==2, \'icon-order-play\':attr2.classliy.value==3}"></i>{{attr2.name}}</div> <div ng-repeat-end class="cell fare" ng-repeat="attr3 in attr2.fare"> <div class="farewrap"> <div class="name">{{attr3.name}}</div> <div>{{attr3.info | roomNumber:attr2.classliy.value:attr3.room_number}}</div> <div>￥{{attr3.price}}</div> <div>{{attr3.number}}</div> </div> </div> </div> </div> </div> <div ng-if="model.is_organizer.value ==\'1\'" class="main-title">服务费（交通、导服及其他）</div> <div ng-if="model.is_organizer.value ==\'1\'" class="cell service"><div>{{model.price.name}}</div><div>单价 {{model.price.value}}</div><div>{{num}} 份</div></div> <div class="main-title">主要联系人</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.main_retinueInfo.list">{{attr.name}}</span><span ui-sref="tab.updateLinkman({type: 0, link: userInfo.main_retinueInfo.create_link})" ng-if="!userInfo.main_retinueInfo.list.length" class="add-retinue">添加</span></div> <div class="main-title">随行人员</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.retinueInfo.list | filter: !!\'isSelected\'">{{attr.name}}</span><span ng-click="modal.show()" class="add-retinue">选择</span></div> <div class="empty"></div> </ion-content> <div class="order-submit"> <div class="order-price">￥{{totlePrice}}</div> <div class="order-button" ng-click="submit()">提交订单</div> </div> </ion-view>'),a.put("app/order/templates/order-actA.html",'<ion-view hide-tabs="true" cache-view="false"> <navbar back title="觅趣报名"></navbar> <ion-content class="order apply" overflow-scroll="false"> <div class="main-title">出游人数</div> <div class="group numpeople"> <div class="cell tournum"> <div>成人</div> <div><span ng-click="subNum(\'adult\')" class="sub-num"></span><span class="num">{{c_num}}</span><span ng-click="addNum(\'adult\')" class="add-num"></span></div> </div> <div class="cell tournum"> <div>儿童</div> <div><span ng-click="subNum(\'child\')" class="sub-num"></span><span class="num">{{e_num}}</span><span ng-click="addNum(\'child\')" class="add-num"></span></div> </div> </div> <div class="block-people"> <div class="main-title"> 出行人员 </div> <div class="group main-people"> <div class="cell"> <input type="text" data-type="name" ng-model="mainRetinueInfo.name" placeholder="姓名"> </div> <div class="cell code-cell"> <input type="tel" data-type="phone" ng-model="mainRetinueInfo.phone" placeholder="手机号码"> <span ng-click="getCode($event)" class="code" style="width: 100px">获取验证码</span> </div> <div class="cell"> <input type="text" data-type="code" ng-model="mainRetinueInfo.code" placeholder="短信验证码"> </div> </div> </div> <div ng-repeat="attr in adultRetinueInfo track by $index" class="block-people block-adult"> <div class="main-title"> 随行人员{{$index + 1}}（成人） </div> <div class="group main-people"> <div class="cell"> <input type="text" data-type="name" ng-model="attr.name" placeholder="姓名"> </div> <div class="cell"> <input type="text" data-type="phone" ng-model="attr.phone" placeholder="手机号码"> </div> </div> </div> <div ng-repeat="attr in childRetinueInfo track by $index" class="block-people block-child"> <div class="main-title"> 随行人员{{adultRetinueInfo.length + $index + 1}}（儿童） </div> <div class="group main-people"> <div class="cell"> <input type="text" data-type="name" ng-model="attr.name" placeholder="姓名"> </div> </div> </div> <div class="f_button" style="margin: 0;padding:14px"><div class="submit" ng-click="submit()">确认报名</div></div> </ion-content> </ion-view> '),a.put("app/order/templates/order-dot.html",'<ion-view hide-tabs="true"> <navbar back title="点订单预定"></navbar> <ion-content class="order" overflow-scroll="false"> <div class="main-title">出游日期</div> <div class="cell go-time" ng-click="selectDate()">{{date? date :\'请选择出游日期\' }}</div> <div class="main-title">项目列表</div> <div class="item-wrap"> <div class="group" ng-repeat="attr in model.items_fare"> <div class="cell title"><i class="titicon" ng-class="{\'icon-order-eat\': attr.classliy.value==1, \'icon-order-live\':attr.classliy.value==2, \'icon-order-play\':attr.classliy.value==3}"></i>{{attr.name}}</div> <div class="cell fare" ng-repeat="attr2 in attr.fare"> <div class="faredate" ng-click="selectHotelDate($event, attr2)" ng-if="attr.classliy.value==2">请选择入住和退房日期 ></div> <div class="farewrap"> <div class="name">{{attr2.name}}</div> <div>{{attr2.info | roomNumber:attr.classliy.value:attr2.room_number}}</div> <div>￥{{attr2.price}}</div> <div><span ng-click="subNum(attr2)" class="sub-num"></span><span class="num">{{attr2.number}}</span><span ng-click="addNum(attr2)" class="add-num"></span></div> </div> </div> </div> </div> <div class="main-title">主要联系人</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.main_retinueInfo.list">{{attr.name}}</span><span ui-sref="tab.updateLinkman({type: 0, link: userInfo.main_retinueInfo.create_link})" ng-if="!userInfo.main_retinueInfo.list.length" class="add-retinue">添加</span></div> <div class="main-title">随行人员</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.retinueInfo.list | filter: !!\'isSelected\'">{{attr.name}}</span><span ng-click="modal.show()" class="add-retinue">选择</span></div> <div class="empty"></div> </ion-content> <div class="order-submit"> <div class="order-price">￥{{totalPrice}}</div> <div ng-click="submit()" class="order-button">提交订单</div> </div> </ion-view> '),a.put("app/order/templates/order-line.html",'<ion-view hide-tabs="true"> <navbar back title="线路订单预定"></navbar> <ion-content class="order" overflow-scroll="false"> <div class="main-title">出游日期</div> <div class="cell go-time" ng-click="selectDate()">{{goTime ? goTime: \'请选择出游日期\'}}</div> <div class="main-title">出游人数</div> <div class="group numpeople"> <div ng-repeat="(key, value) in model.OrderItemsFare" class="cell tournum"><div>{{value.info}}</div><div><span ng-click="subNum(value.info,key)" class="sub-num"></span><span class="num">{{value.number}}</span><span ng-click="addNum(value.info,key)" class="add-num"></span></div></div> </div> <div class="main-title">项目列表</div> <div class="item-wrap"> <div ng-repeat-start="(key1, value1) in model.dot_list" ng-if="key1%2" class="day-title">{{key1 | formatDay}}</div> <div ng-repeat-end ng-repeat="attr1 in value1" class="group line-item"> <div ng-repeat="(key2, value2) in attr1"> <div ng-repeat-start="attr2 in value2" class="cell title"><i class="titicon" ng-class="{\'icon-order-eat\': attr2.classliy.value==1, \'icon-order-live\':attr2.classliy.value==2, \'icon-order-play\':attr2.classliy.value==3}"></i>{{attr2.name}}</div> <div ng-repeat-end class="cell fare" ng-repeat="attr3 in attr2.fare"> <div class="farewrap"> <div class="name">{{attr3.name}}</div> <div>{{attr3.info | roomNumber:attr2.classliy.value:attr3.room_number}}</div> <div>￥{{attr3.price}}</div> <div>{{attr3.number}}</div> </div> </div> </div> </div> </div> <div class="main-title">主要联系人</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.main_retinueInfo.list">{{attr.name}}</span><span ui-sref="tab.updateLinkman({type: 0, link: userInfo.main_retinueInfo.create_link})" ng-if="!userInfo.main_retinueInfo.list.length" class="add-retinue">添加</span></div> <div class="main-title">随行人员</div> <div class="cell linkman"><span ng-repeat="attr in userInfo.retinueInfo.list | filter: !!\'isSelected\'">{{attr.name}}</span><span ng-click="modal.show()" class="add-retinue">选择</span></div> <div class="empty"></div> </ion-content> <div class="order-submit"> <div class="order-price">￥{{totlePrice}}</div> <div class="order-button" ng-click="submit()">提交订单</div> </div> </ion-view>'),a.put("app/order/templates/selected-retinue.html",' <ion-modal-view> <navbar> <div class="left modal-left" ng-click="modal.hide()">确认</div> <div class="title">选择随行人员</div> <div class="right modal-right" ui-sref="tab.updateLinkman({type: 2, link: userInfo.retinueInfo.create_link})">添加</div> </navbar> <ion-content class="has-header"> <ion-list> <ion-checkbox class="retinue-item" ng-repeat="attr in userInfo.retinueInfo.list" ng-model="attr.isSelected">{{attr.name}}</ion-checkbox> </ion-list> </ion-content> </ion-modal-view>'),a.put("app/payment/templates/my-payment-message.html",'<ion-view hide-tabs> <navbar back title="短信验证"></navbar> <form name="message_form" novalidate ng-submit="messageForm()"> <ion-content class="tmm-withdraw-message"> <div class="message-info"> 验证码将发送至手机: {{loginPhone}},请按提示操作。 </div> <div class="message-content"> <div class="message-code"> <input type="txt" name="sms" ng-change="messageFormButton()" ng-model="regText.sms" required placeholder="请输入短信验证码"> <a id="get_code" class="get-code-pos" ng-class="{true: \'get-code\', false: \'get-code-active\'}[flag]" href="javascript:;" ng-click="getCode()">{{text}}</a> </div> </div> <div class="wall-message-button" ng-show="chkBtnShow"> <button class="message-sub message-sub-act" type="submit">确认</button> </div> <div class="wall-message-button" ng-show="chkBtnHide"> <button class="message-sub" type="button">确认</button> </div> </ion-content> </form> </ion-view> '),a.put("app/payment/templates/my-payment.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="支付管理"></navbar> <ion-content class="tmm-payment-ent" scroll="false"> <div class="set-pay-pwd" ng-click="showVerifyPhone()">{{info.type.value}}<span class="right-arrow"><i class="icon-right-arrow"></i></span></div> </ion-content> </ion-view> '),a.put("app/payment/templates/my-set-password.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="设置支付密码"></navbar> <ion-content class="tmm-payment-setpwd" scroll="false" id="tmm-payment-setpwd"> <div class="payment-content"> <div class="passwd-msg" id="passwd-msg">请输入支付密码</div> <div class="passwd-wrap"> <div class="passwd-item"></div> <div class="passwd-item"></div> <div class="passwd-item"></div> <div class="passwd-item"></div> <div class="passwd-item"></div> <div class="passwd-item"></div> </div> <span class="passwd-button btnColor" style="display:none" id="passwd-button-show" ng-click="confirmPasswd()">确认</span> <span class="passwd-button" style="display:none" id="passwd-button-hide">确认</span> </div> </ion-content> </ion-view> '),a.put("app/recommend/templates/recommend-item.html",'<div class="tmm-recommend-item"> <div class="pic" ui-sref="tab.shop{{item.classliy.value}}({link:item.link, type:item.classliy.value})"> <img ng-src="{{item.image}}"> </div> <div class="txt"> <div class="title">{{item.name}}</div> <div class="info">{{item.info}}</div> <span class="praise"><span ng-if="item.distance" class="praise-distance">距离</span>{{item.distance}}</span> <span class="type" ng-class="{\'dot\': item.classliy.value==1, \'line\': item.classliy.value==2, \'act\': item.classliy.value==3}">{{item.type.name}}</span> </div> </div> '),a.put("app/recommend/templates/recommend.html",'<ion-view view-title="精品推荐" animation="no-animation"> <ion-nav-buttons side="right"> <i class="icon-search" ui-sref="tab.search"></i> </ion-nav-buttons> <ion-content delegate-handle="recommend-content" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div class="tmm-recommend-list"> <recommend-item ng-repeat="item in model.list_data"></recommend-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/recommend/templates/seek.html",'<ion-view view-title="觅境"> <navbar> <div class="title"> <div class="seekTitle" ui-sref="tab.destination"> <div class="tit">{{address}}</div> <div class="txt">目的地</div> </div> </div> <div class="right"> <i class="icon-search" ui-sref="tab.search"></i> </div> </navbar> <div class="sub-nav"> <div ng-repeat="attr in model.search" ng-click="selectTit(attr, $index)" ng-class="{\'active\': $index === selectTitle}" class="subtit">{{attr.name}}</div> </div> <ion-content delegate-handle="seek-content" class="seek-content" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div ng-if="noData" class="noDataMsg">没有数据哦！</div> <recommend-item ng-repeat="item in model.list_data"></recommend-item> <ion-infinite-scroll on-infinite="loadMore()" ng-if="model.nextPage" distance="1%" spinner="ios"> </ion-infinite-scroll> <div class="tabbar-empty"></div> </ion-content> <div class="seekmask" ng-if="isShowTag" id="seekmask" ng-class="{\'seekTop\':seekIos}"> <div class="tagPos"> <div class="tagWrap"> <div ng-repeat="attr in model.tags" class="tag"><span ng-class="{\'active\': attr.value == selectValue}" ng-click="selectTag(attr.link, attr.value)">{{attr.name}}</span></div> </div> </div> <div class="closetag" ng-click="closeTag()"></div> </div> </ion-view> '),
a.put("app/search/templates/destination.html",'<ion-view hide-tabs> <navbar back title="切换目的地"></navbar> <div class="destination-bar"> <form ng-submit="searchContent()" class="destination-input-wrapper"> <i class="search-text"></i> <input ng-model="searchText" ng-change="changeText()" ng-focus="isSearch=true" type="search" class="bar-search" placeholder="请输入城市名、拼音、首字母"> <i ng-click="clearText()" class="search-clear"></i> </form> </div> <ion-content class="destination"> <div class="select-city" ng-if="!isSearch"> <div class="my-place"> <h3>我的位置</h3> <span ng-click="getLocation()" class="mylocation">{{model.location.value ? model.location.value.address_info.name : \'定位失败\'}}</span> </div> <div class="hot-city"> <h3>热门城市</h3> <span ng-repeat="item in model.hot_city" ng-click="selectCity(item.link)">{{item.name}}</span> </div> </div> <div class="city-list"> <div class="noDataMsg" ng-if="!hasData">没有相关城市</div> <div class="tit" ng-repeat-start="(key , value) in model.list_data">{{key}}</div> <div class="group" ng-repeat-end> <div class="cell" ng-repeat="item in value" ng-click="selectCity(item.link)">{{item.name}}</div> </div> </div> </ion-content> </ion-view> '),a.put("app/search/templates/search.html",'<ion-view hide-tabs> <navbar back> <form ng-submit="searchContent()" class="item-input-wrapper"> <i ng-click="searchContent()" class="search-text"></i> <input type="search" class="bar-search" placeholder="搜索"> <i ng-click="clearContent()" class="search-clear"></i> </form> </navbar> <ion-content class="search"> <div class="historyWrap" ng-if="isHistory"> <div class="cell title">搜索历史</div> <div class="group" ng-click="searchHistory($event)"> <div ng-repeat="attr in storage" class="cell">{{attr}}</div> </div> <div class="cancelHistory" ng-class="{\'cancelHistory-border\' : storage.length > 0 }" ng-click="clearHistory()">清空历史记录</div> </div> <div class="listWrap" ng-if="!isHistory"> <div ng-if="!model.list_data.length" class="noDataMsg">没有相关数据！</div> <recommend-item ng-repeat="item in model.list_data"></recommend-item> </div> <ion-infinite-scroll on-infinite="loadMore()" ng-if="nextPage" distance="1%"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/shops/templates/farm-list.html",'<ion-view view-title="田觅觅" hide-tabs="true"> <navbar back title="农产品特产"></navbar> <ion-content> <div class="cellcard" ng-repeat="item in model" ng-click="goFresh(item.item_name, item.item_info, item.item_img, item.item_link)"> <div class="innerbody"> <div class="img"><img ng-src="{{item.item_img}}"></div> <div class="intro"> <div class="tit">{{item.item_name}}</div> <div class="txt txt-clamp">{{item.item_info}}</div> </div> </div> </div> </ion-content> </ion-view> '),a.put("app/shops/templates/shop-act-detail.html",'<ion-view hide-tabs="true"> <navbar back title="{{model.name}}"></navbar> <ion-content on-scroll="getScrollPosition()"> <shop-banner></shop-banner> <div class="shop-act-info"> <div class="box col-6"> <div class="box-tit">参与人数</div> <div class="box-txt">{{model.actives_info.order_number.sign}} / {{model.actives_info.number.value}}</div> </div> <div class="box col-6"> <div class="box-tit">觅趣状态</div> <div class="box-txt">{{model.actives_status.name}}</div> </div> <div class="box col-6"> <div class="box-tit">报名时间</div> <div class="box-txt">{{model.actives_time.start_time}} / {{model.actives_time.end_time}}</div> </div> <div class="box col-6"> <div class="box-tit">出游日期</div> <div class="box-txt">{{model.actives_time.go_time}}</div> </div> <div class="box col-12"> <div class="box-tit">觅趣简介</div> <div class="active-intro" ng-bind-html="active_intro"></div> </div> </div> <ng-include src="\'app/shops/templates/shop-items.tpl.html\'"></ng-include> </ion-content> <shop-indicator type="act"></shop-indicator> </ion-view> '),a.put("app/shops/templates/shop-banner.tpl.html",'<div> <img ng-src="{{model.page_img}}"> <div class="tool-mask"> <div ng-click="doPraise()"> <em ng-class="model.collent_status == 0 ? \'icon-parise\' : \'icon-parise-red\'"></em> <span class="praise-tit">{{ model.praise }}</span> </div> <div ng-click="doCall()"> <em class="icon-phone-big"></em> <span class="praise-tit">联系</span> </div> <div ng-if="!isWeixin"> <em ng-click="doShare()" class="icon-share-big"></em> <span class="praise-tit">分享</span> </div> </div> </div>'),a.put("app/shops/templates/shop-book-info.html",'<ion-view hide-tabs cache-view="false"> <navbar back title="预订须知"></navbar> <ion-nav-buttons> <i class="icon-back" nav-back="back"></i> </ion-nav-buttons> <ion-content> <div class="bookinfo"> <div class="booking-title cell">预订须知</div> <div class="booking-con" data-ng-bind-html="bookInfo"> </div> </div> <div class="costinfo"> <div class="booking-title cell">费用包含</div> <div class="booking-con" data-ng-bind-html="costInfo"> </div> </div> </ion-content> </ion-view> '),a.put("app/shops/templates/shop-dot-detail.html",'<ion-view hide-tabs> <navbar back title="景点详情"></navbar> <ion-content> <shop-banner></shop-banner> <div class="shop-info"> <div class="shop-title"> {{model.name}} <span class="shop-sold" ng-if="model.is_sale.value == \'1\'">已售出{{model.down}}份</span> </div> <div class="shop-price"> ￥{{model.price}}/人起 </div> <div class="shop-intro"> {{model.page_info}} </div> <div class="shop-more"> <span class="shop-notice" ui-sref="tab.book-info({type:2, id:model.dot_id})"> <i class="icon-more"></i> 预订须知 </span> </div> <div ng-if="model.exterior_link_num" class="farmList" ui-sref="tab.farm-list({link:link})"> <div class="tit">{{model.exterior_link_num}}种相关特产<i class="icon-right-arrow"></i></div> <div class="txt"><span ng-repeat="item in model.exterior_link_arr">{{item.item_name}}</span></div> </div> </div> <div class="shop-detail-title">该景区项目</div> <div class="shop-wrap"> <div class="img-pos" ng-class="{\'icon-eat\': attr.item_type.value==1, \'icon-live\':attr.item_type.value==2, \'icon-play\':attr.item_type.value==3}" ng-repeat-start="attr in model.list"></div> <div class="item-title">{{attr.item_name}}</div> <div class="item-address"> {{attr.address}} </div> <div class="item-more" ui-sref="tab.more-detail{{attr.item_type.value}}({link:attr.item_link})"><span>●</span><span>●</span><span>●</span></div> <div ng-repeat-end class="img"> <img ng-src="{{attr.item_img}}" ui-sref="tab.more-detail{{attr.item_type.value}}({link:attr.item_link})"> </div> </div> </ion-content> <shop-indicator type="dot"></shop-indicator> </ion-view> '),a.put("app/shops/templates/shop-items.tpl.html",'<div ng-repeat="attr in model.list" class="shop-wrap"> <div class="schedule"> <i class="bracket">&lceil;</i> {{attr.day_content}} <i class="bracket">&rfloor;</i> </div> <div class="schedule-day" ng-class="{\'line\': model.c_id == 2, \'act\': model.c_id == 3}"> <div class="circle"></div> <div class="day">{{attr.descript_day}}</div> <div class="arrow"></div> </div> <div class="items" ng-repeat="attr2 in attr.dot_list"> <div class="img-pos" ng-class="{\'icon-eat\': attr3.item_type.value==1, \'icon-live\':attr3.item_type.value==2, \'icon-play\':attr3.item_type.value==3}" ng-repeat-start="attr3 in attr2.day_item"></div> <div class="item-title">{{attr3.item_name}}</div> <div class="item-address"> {{attr3.address}} </div> <div class="item-more" ui-sref="tab.more-detail{{attr3.item_type.value}}({link:attr3.item_link})"><span>●</span><span>●</span><span>●</span></div> <div ng-repeat-end class="img"> <img ng-src="{{attr3.item_img}}" ui-sref="tab.more-detail{{attr3.item_type.value}}({link:attr3.item_link})"> </div> </div> </div> '),a.put("app/shops/templates/shop-line-detail.html",'<ion-view hide-tabs="true"> <navbar back title="线路详情"></navbar> <ion-content> <shop-banner></shop-banner> <div class="shop-info"> <div class="shop-title"> {{model.name}} <span class="shop-sold" ng-if="model.is_sale.value == \'1\'">已售出{{model.down}}份</span> </div> <div class="shop-price"> ￥{{model.price}}/人起 </div> <div class="shop-intro"> {{model.page_info}} </div> <div class="shop-more"> <span class="shop-notice" ui-sref="tab.book-info({type:2, id:model.thrand_id})"> <i class="icon-more"></i> 预订须知 </span> </div> </div> <div class="shop-detail-title">该线路项目</div> <ng-include src="\'app/shops/templates/shop-items.tpl.html\'"></ng-include> </ion-content> <shop-indicator type="line"></shop-indicator> </ion-view> '),a.put("app/wallet/templates/my-bankcard-change.html",'<ion-view hide-tabs> <navbar back title="更换银行卡"></navbar> <form name="signup_form" novalidate ng-submit="signupForm()"> <ion-content class="tmm-wallet-change" scroll="false"> <div class="withdraw-list"> <div class="withdraw-item"> <div class="withdraw-title">开户行</div> <div> <select ng-model="bankInfo.bankname" ng-options="bankList.value as bankList.name for bankList in bankList" required ng-change="signupFormButton()" autocomplete="off"> <option value="" name="isDefault">请选择</option> </select> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">支行</div> <div> <input type="text" name="subbranch" ng-change="signupFormButton()" required ng-model="regText.subbranch" placeholder="开户支行" autocomplete="off"> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">开户名</div> <div> <input type="text" name="username" ng-change="signupFormButton()" required ng-model="regText.username" placeholder="开户姓名" autocomplete="off"> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">卡号</div> <div> <input type="text" class="tmm-codeWidth" name="bank_code" id="bank_code" ng-change="signupFormButton()" required ng-model="regText.bank_code" placeholder="卡号" pattern="[0-9]*" autocomplete="off"> </div> </div> </div> <div class="bankcard-protocol"> <input type="checkbox" class="checkbox chkleft" name="bank_protocol" ng-model="regText.chk" ng-change="signupFormButton()">我同意 <a ui-sref="tab.mybankcardprotocal" href="javascript:void(0)" class="protocol-link">《银行卡管理协议》</a> </div> <div class="tmm-message-button" ng-show="chkBtnShow"> <button class="tmm-message-sub tmm-message-sub-act" type="submit">下一步</button> </div> <div class="tmm-message-button" ng-show="chkBtnHide"> <button class="tmm-message-sub" type="button">下一步</button> </div> </ion-content> </form> </ion-view> '),a.put("app/wallet/templates/my-bankcard-management.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="银行卡管理"></navbar> <ion-content class="tmm-bankcard-manage"> <div class="card-top"> <img src="images/card1.bde86a1a.png"> </div> <div class="bankcard-list"> <div class="bankcard-item"> <div class="bankcard-title">真实姓名</div> <div>{{json.bank_name}}</div> </div> <div class="bankcard-item"> <div class="bankcard-title">开户银行</div> <div>{{json.bank_value}}{{json.bank_branch}}</div> </div> <div class="bankcard-item"> <div class="bankcard-title">银行卡号</div> <div>{{json.bank_code_format}}</div> </div> </div> <div class="wall-message-button"> <button class="message-sub bankcard-btnbg" type="submit" ui-sref="tab.mybankcardchange">更换银行卡</button> </div> </ion-content> </ion-view> '),a.put("app/wallet/templates/my-bankcard-message.html",'<ion-view view-title="短信验证" hide-tabs="true"> <navbar back title="短信验证"></navbar> <form name="tmm_message_form" novalidate ng-submit="messageForm()"> <ion-content class="tmm-withdraw-message"> <div class="message-info"> 验证码将发送至手机: {{loginPhone}},请按提示操作。 </div> <div class="message-content"> <div class="message-code"> <input type="txt" name="sms" ng-change="messageFormButton()" ng-model="regText.sms" required placeholder="请输入短信验证码"> <a id="get_code" class="get-code-pos" ng-class="{true: \'get-code\', false: \'get-code-active\'}[flag]" href="javascript:;" ng-click="getCode()">{{text}}</a> </div> </div> <div class="wall-message-button" ng-show="messageBtnShow"> <button class="message-sub message-sub-act" type="submit">确认</button> </div> <div class="wall-message-button" ng-show="messageBtnHide"> <button class="message-sub" type="button">确认</button> </div> </ion-content> </form> </ion-view> '),a.put("app/wallet/templates/my-bankcard-new.html",'<ion-view hide-tabs> <navbar back title="添加银行卡"></navbar> <form name="signup_form" novalidate ng-submit="signupForm()"> <ion-content class="tmm-wallet-change" scroll="false"> <div class="withdraw-list"> <div class="withdraw-item"> <div class="withdraw-title">开户行</div> <div> <select ng-model="bankInfo.bankname" ng-options="bankList.value as bankList.name for bankList in bankList" required ng-change="signupFormButton()" autocomplete="off"> <option value="" name="isDefault">请选择</option> </select> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">支行</div> <div> <input type="text" name="subbranch" ng-change="signupFormButton()" required ng-model="regText.subbranch" placeholder="开户支行" autocomplete="off"> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">开户名</div> <div> <input type="text" name="username" ng-change="signupFormButton()" required ng-model="regText.username" placeholder="开户姓名" autocomplete="off"> </div> </div> <div class="withdraw-item"> <div class="withdraw-title">卡号</div> <div> <input type="text" class="tmm-codeWidth" name="bank_code" id="bank_code" ng-change="signupFormButton()" required ng-model="regText.bank_code" placeholder="卡号" pattern="[0-9]*" autocomplete="off"> </div> </div> </div> <div class="bankcard-protocol"> <input type="checkbox" class="checkbox chkleft" name="bank_protocol" ng-model="regText.chk" ng-change="signupFormButton()">我同意 <a ui-sref="tab.mybankcardprotocal" href="javascript:void(0)" class="protocol-link">《银行卡管理协议》</a> </div> <div class="tmm-message-button" ng-show="chkBtnShow"> <button class="tmm-message-sub tmm-message-sub-act" type="submit">下一步</button> </div> <div class="tmm-message-button" ng-show="chkBtnHide"> <button class="tmm-message-sub" type="button">下一步</button> </div> </ion-content> </form> </ion-view> '),a.put("app/wallet/templates/my-bankcard-protocal.html",'<ion-view cache-view="false" hide-tabs="true"> <navbar back title="银行卡管理协议"></navbar> <ion-content> <div class="page-content tmm-my-bankprotocal"> <div>田觅觅-银行卡管理协议（以下简称“本协议”）是田觅觅信息科技有限公司（以下简称“田觅觅”）与田觅觅用户(以下简称“您”)就“银行卡管理服务”（以下简称“本服务”）的使用等相关事项所订立的有效合约。</div> <div>您通过网络页面点击确认或以其他方式选择接受本协议，即表示您与田觅觅已达成协议并同意接受本协议的全部约定内容。在接受本协议之前，请您仔细阅读本协议的全部内容<span class="bold">（特别是以粗体下划线标注的内容）。</span>如果您不同意本协议的任意内容，请不要进行后续操作。</div> <div><span class="bold">“银行卡管理服务”</span>指通过本服务，您同意将银行卡与您登录的田觅觅账户进行绑定，以便您此次及今后可以通过田觅觅及第三方传输您的支付指令从您的银行卡账户中扣除有关款项给收款方；以便您此次及今后可以通过田觅觅将钱包余额提现至您的银行卡账户中。</div> <div style="font-weight: bold;text-decoration: underline">您应确保您在开通和使用本服务时绑定的银行卡为您本人所有，并确保您将您的田觅觅账户与该银行卡绑定且用其支付的行为合法、有效，未侵犯任何第三方合法权益；否则因此造成田觅觅及其关联公司、持卡人损失的，您应负责赔偿并承担全部法律责任，田觅觅有权采取合理措施减轻该损失，包括但不限于冻结您的田觅觅账户及资金、从您的田觅觅账户扣除相应的款项等。</div> <div>您同意田觅觅收集您在使用本服务过程中所填写的包括但不限于姓名、银行卡卡号、手机号码、证件号码、证件类型、有效期等信息并有权自己或者委托第三方将上述信息发送至您的发卡银行进行验证，验证通过后，田觅觅就可以为您开通本服务。同时，发卡行与田觅觅保留随时变更上述确认要素作为校验标准的权利。</div> <div>您应妥善保管银行卡和田觅觅账号信息，包括但不限于银行卡卡号、密码、有效期，田觅觅账号、密码、密保信息、手机校验码等信息。如您遗失银行卡、泄露田觅觅账户密码或相关信息的，您应及时通知发卡行及田觅觅，以减少可能发生的损失。<span class="bold">因泄露上述银行卡信息、田觅觅账号信息、丢失银行卡等所致损失需由您自行承担。</span></div> <div>您同意，本协议适用中华人民共和国大陆地区法律。因田觅觅与您就本协议的签订、履行或解释发生争议，双方应努力友好协商解决。<span class="bold">如协商不成，田觅觅和您同意由人民法院管辖审理双方的纠纷或争议。</span></div> <div><span class="bold">本协议内容包括协议正文及所有田觅觅已经发布的或将来可能发布的田觅觅服务的使用规则。所有规则为本协议不可分割的一部分，与协议正文具有相同法律效力。</span>若您在本协议内容发生修订后，继续使用本服务的，则视为您同意最新修订的协议内容；否则您须立即停止使用本服务。</div> </div>  </ion-content> </ion-view>'),a.put("app/wallet/templates/my-trade-record.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="交易记录"></navbar> <ion-content class="tmm-withdraw-record" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()"> </ion-refresher> <div ng-repeat="record in list_data" class="tmm-record-list"> <div class="record-item"> <div> <b>{{record.name}}</b> <p class="record-time">{{record.add_time}}</p> </div> <div class="record-money"> {{record.use_money}} <p class="record-time">余额：{{record.money}}元</p> </div> </div> </div> <div class="record-conNo" ng-if="listNum == 0">你暂时还没有交易记录哦！</div> <ion-infinite-scroll distance="0.1%" ng-if="hasMoreData()" on-infinite="loadMore()"> </ion-infinite-scroll> </ion-content> </ion-view> '),a.put("app/wallet/templates/my-wallet-withdraw.html",'<ion-view view-title="提现申请" hide-tabs> <navbar back title="提现申请"> <div class="right tmm-withdraw-right"> <i ui-sref="tab.withdrawRecord">提现记录</i> </div> </navbar> <form novalidate ng-submit="withdrawForm()" name="withdraw_form"> <ion-content class="tmm-wallet-withdraw" scroll="false"> <div class="withdraw-list"> <div class="withdraw-item"> <div class="withdraw-title">开户行</div> <div>{{json.bank_value}}</div> </div> <div class="withdraw-item"> <div class="withdraw-title">开户名</div> <div>{{json.bank_name}}</div> </div> <div class="withdraw-item"> <div class="withdraw-title">卡号</div> <div>{{json.bank_code_format}}</div> </div> <div class="withdraw-item"> <div class="withdraw-title">金额(元)</div> <div> <input type="text" name="drawMoney" placeholder="当前余额{{withdraw_format}}元" class="withdraw-input" ng-model="regText.drawMoney" required autocomplete="off" maxlength="12"> </div> </div> </div> <div class="tmm-message-button"> <button class="tmm-message-sub tmm-message-sub-act" type="submit">确认提现</button> </div> <div class="withdraw-tip">提现申请成功，预计1-3个工作日内到帐。</div> </ion-content> </form> </ion-view> '),a.put("app/wallet/templates/my-wallet.html",'<ion-view hide-tabs> <navbar title="钱包" class="wallet-nav"> <div class="left"> <i class="icon-back-arrow" ui-sref="tab.my"></i> </div> </navbar> <ion-content class="tmm-my-wallet" scroll="false"> <div class="wallet-content"> <div class="content-balance">{{json.money_format}}</div> <div class="balance-up">余额(元)</div> </div> <div class="wallet-list arrow-cell" ng-click="BankCardHasOrNot()"> <img src="images/tx.e7c068b3.png" class="wallet-img">提现<span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> <div class="wallet-list wallet-top" ng-click="BankCardManageLink()"> <img src="images/yhkgl.874c6e38.png" class="wallet-img">银行卡管理<span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> <div class="wallet-list" ui-sref="tab.traderecord"> <img src="images/jyjl.9f2e5bbe.png" class="wallet-img">交易记录<span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> <div class="wallet-list" ui-sref="tab.payment"> <img src="images/zfgl.d92c33ec.png" class="wallet-img">支付管理<span class="right-arrow"><i class="icon-right-arrow"></i></span> </div> </ion-content> </ion-view> '),a.put("app/wallet/templates/my-withdraw-info.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="提示"></navbar> <ion-content class="tmm-withdraw-info" scroll="false"> <div class="card-top"><img src="images/card2.5ca076a4.png"></div> <div class="withdraw-info-list"> <div class="info-item"> <div class="item-title">提现金额</div> <div class="item-con">{{withdrawMoney}}</div> </div> <div class="info-item"> <div class="item-title">到账日</div> <div class="item-con">预计1-3个工作日内</div> </div> </div> <div class="withdraw-info-label">实际到帐时间依据帐户托管方及提现银行而有所差异</div>  <div class="withdraw-info-button"> <button class="message-sub" type="submit" ui-sref="tab.mywallet">返回我的钱包</button> </div> </ion-content> </ion-view> '),a.put("app/wallet/templates/my-withdraw-message.html",'<ion-view hide-tabs> <navbar back title="短信验证"></navbar> <form name="message_form" novalidate ng-submit="messageForm()"> <ion-content class="tmm-withdraw-message"> <div class="message-info"> 验证码将发送至手机: {{loginPhone}},请按提示操作。 </div> <div class="message-content"> <div class="message-code"> <input type="txt" name="sms" ng-change="messageFormButton()" ng-model="regText.sms" required placeholder="请输入短信验证码"> <a id="get_code" class="get-code-pos" ng-class="{true: \'get-code\', false: \'get-code-active\'}[flag]" href="javascript:;" ng-click="getCode()">{{text}}</a> </div> </div> <div class="wall-message-button" ng-show="chkBtnShow"> <button class="message-sub message-sub-act" type="submit">确认</button> </div> <div class="wall-message-button" ng-show="chkBtnHide"> <button class="message-sub" type="button">确认</button> </div> </ion-content> </form> </ion-view> '),a.put("app/wallet/templates/my-withdraw-record.html",' <ion-view cache-view="false" hide-tabs="true"> <navbar back title="提现申请记录"></navbar> <ion-content class="tmm-withdraw-record" overflow-scroll="false"> <ion-refresher pulling-text="下拉刷新..." on-refresh="doRefresh()" spinner="ios"> </ion-refresher> <div ng-repeat="drawRecord in list_data" class="tmm-record-list"> <div class="record-item"> <div> <b>提现</b> <p class="record-time">{{drawRecord.add_time}}</p> </div> <div class="record-money"> {{drawRecord.price}} <p class="suc" ng-if="drawRecord.audit_status.value == 3">提现成功</p> <p class="fail" ng-if="drawRecord.audit_status.value == 2">打款中...</p> <p class="fail" ng-if="drawRecord.audit_status.value == 0 || drawRecord.audit_status.value == 1">审核中...</p> <p class="fail" ng-if="drawRecord.audit_status.value == -1 ||drawRecord.audit_status.value == -2 || drawRecord.audit_status.value == -3">提现失败</p> </div> </div> <div class="record-reason" ng-if="drawRecord.cash_status.value == -1"> 原因：{{drawRecord.remark_first}} </div> <div class="record-reason" ng-if="drawRecord.cash_status.value == -2"> 原因：{{drawRecord.remark_double}} </div> <div class="record-reason" ng-if="drawRecord.cash_status.value == -3"> 原因：{{drawRecord.remark_submit}} </div> </div> <div class="record-conNo" ng-if="listNum == 0">你暂时还没有提现申请记录哦！</div> <ion-infinite-scroll distance="0.1%" ng-if="hasMoreData()" on-infinite="loadMore()"> </ion-infinite-scroll> </ion-content> </ion-view> ')}]);